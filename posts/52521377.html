<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><title>IDAä¸­åŠ å¯†ç®—æ³•ç‰¹å¾ä¸è§£å¯† | å å…¥æ˜Ÿé‡çš„æœˆğŸŒ™</title><meta name="author" content="uf4te"><meta name="copyright" content="uf4te"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="æ ¹æ®å‡½æ•°çš„ç‰¹ç‚¹ï¼Œå¿«é€Ÿè¯†åˆ« IDA ä¼ªä»£ç é‡Œçš„åŠ å¯†æ–¹æ³•"><meta property="og:type" content="article"><meta property="og:title" content="IDAä¸­åŠ å¯†ç®—æ³•ç‰¹å¾ä¸è§£å¯†"><meta property="og:url" content="https://www.uf4te.cn/posts/52521377.html"><meta property="og:site_name" content="å å…¥æ˜Ÿé‡çš„æœˆğŸŒ™"><meta property="og:description" content="æ ¹æ®å‡½æ•°çš„ç‰¹ç‚¹ï¼Œå¿«é€Ÿè¯†åˆ« IDA ä¼ªä»£ç é‡Œçš„åŠ å¯†æ–¹æ³•"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://www.uf4te.cn/img/cover/cover-45.jpg"><meta property="article:published_time" content="2023-03-16T16:00:00.000Z"><meta property="article:modified_time" content="2024-10-25T02:22:11.000Z"><meta property="article:author" content="uf4te"><meta property="article:tag" content="Reverse"><meta property="article:tag" content="IDA"><meta property="article:tag" content="CTF"><meta property="article:tag" content="Crypto"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://www.uf4te.cn/img/cover/cover-45.jpg"><link rel="shortcut icon" href="/img/blog/avatar.jpg"><link rel="canonical" href="https://www.uf4te.cn/posts/52521377.html"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//sdk.51.la"><meta name="baidu-site-verification" content="codeva-b3iLZWQECM"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload='this.media="all"'><script>!function(t){"use strict";!function(e){var r=window,s=document,n=t,c="".concat("https:"===s.location.protocol?"https://":"http://","sdk.51.la/js-sdk-pro.min.js"),i=s.createElement("script"),o=s.getElementsByTagName("script")[0];i.type="text/javascript",i.setAttribute("charset","UTF-8"),i.async=!0,i.src=c,i.id="LA_COLLECT",n.d=i;var a=function(){r.LA.ids.push(n)};r.LA?r.LA.ids&&a():(r.LA=t,r.LA.ids=[],a()),o.parentNode.insertBefore(i,o)}()}({id:"3GoBenqrrrBby5er",ck:"3GoBenqrrrBby5er",hashMode:!0})</script><script>!function(e,t,n,r){var i=t.createElement("script"),o=t.getElementsByTagName("script")[0];i.type="text/javascript",i.crossorigin=!0,i.onload=function(){(new e.LingQue.Monitor).init({id:"3GoBenqrrrBby5er"})},o.parentNode.insertBefore(i,o),i.src="https://sdk.51.la/perf/js-sdk-perf.min.js"}(window,document)</script><script>const GLOBAL_CONFIG={root:"/",algolia:{appId:"XY1UOYTY6S",apiKey:"4f03dfbbbff745c98fa4728e2ca61a96",indexName:"uf4te",hits:{per_page:10},languages:{input_placeholder:"æœç´¢æ–‡ç« ",hits_empty:"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}",hits_stats:"æ‰¾åˆ° ${hits} æ¡ç»“æœï¼Œç”¨æ—¶ ${time} æ¯«ç§’"}},localSearch:void 0,translate:{defaultEncoding:2,translateDelay:0,msgToTraditionalChinese:"ç¹",msgToSimplifiedChinese:"ç®€"},noticeOutdate:void 0,highlight:{plugin:"prismjs",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:!1},copy:{success:"å¤åˆ¶æˆåŠŸ",error:"å¤åˆ¶é”™è¯¯",noSupport:"æµè§ˆå™¨ä¸æ”¯æŒ"},relativeDate:{homepage:!1,post:!1},runtime:"",date_suffix:{just:"åˆšåˆš",min:"åˆ†é’Ÿå‰",hour:"å°æ—¶å‰",day:"å¤©å‰",month:"ä¸ªæœˆå‰"},copyright:void 0,lightbox:"fancybox",Snackbar:{chs_to_cht:"ä½ å·²åˆ‡æ¢ä¸ºç¹ä½“",cht_to_chs:"ä½ å·²åˆ‡æ¢ä¸ºç®€ä½“",day_to_night:"ä½ å·²åˆ‡æ¢ä¸ºæ·±è‰²æ¨¡å¼",night_to_day:"ä½ å·²åˆ‡æ¢ä¸ºæµ…è‰²æ¨¡å¼",bgLight:"#323232",bgDark:"#696969",position:"bottom-center"},source:{justifiedGallery:{js:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js",css:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css"}},isPhotoFigcaption:!1,islazyload:!0,isAnchor:!1,percent:{toc:!1,rightside:!0}}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"IDAä¸­åŠ å¯†ç®—æ³•ç‰¹å¾ä¸è§£å¯†",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2024-10-25 10:22:11"}</script><noscript><style>#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:function(e,t,o){if(0===o)return;const n=864e5*o,a={value:t,expiry:(new Date).getTime()+n};localStorage.setItem(e,JSON.stringify(a))},get:function(e){const t=localStorage.getItem(e);if(!t)return;const o=JSON.parse(t);if(!((new Date).getTime()>o.expiry))return o.value;localStorage.removeItem(e)}},e.getScript=e=>new Promise(((t,o)=>{const n=document.createElement("script");n.src=e,n.async=!0,n.onerror=o,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,t())},document.head.appendChild(n)})),e.getCSS=(e,t=!1)=>new Promise(((o,n)=>{const a=document.createElement("link");a.rel="stylesheet",a.href=e,t&&(a.id=t),a.onerror=n,a.onload=a.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(a.onload=a.onreadystatechange=null,o())},document.head.appendChild(a)})),e.activateDarkMode=function(){document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=function(){document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};const t=saveToLocal.get("theme");"dark"===t?activateDarkMode():"light"===t&&activateLightMode();const o=saveToLocal.get("aside-status");void 0!==o&&("hide"===o?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><link rel="stylesheet" href="/css/custom.css"></head><body><span id="fps"></span><script src="/js/reward.js"></script><script src="https://cdn1.tianli0.top/npm/sweetalert2@11.6.16/dist/sweetalert2.all.min.js"></script><script>var fdataUser={apiurl:"https://friends.uf4te.cn/",defaultFish:500,hungryFish:500}</script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/animate.min.css" media="print" onload='this.media="screen"'><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="å å…¥æ˜Ÿé‡çš„æœˆğŸŒ™" type="application/atom+xml"><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/blog/avatar.jpg" onerror='onerror=null,src="/img/404/loading_404.gif"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">134</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">27</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">8</div></a></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>ä¸»é¡µ</span></a></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fa-sharp fa-solid fa-book-open"></i> <span>æ–‡åº“</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fa-solid fa-calendar-days"></i> <span>æ–‡ç« å½’æ¡£</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>æ–‡ç« æ ‡ç­¾</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>æ–‡ç« åˆ†ç±»</span></a></li><li><a class="site-page child" href="javascript:toRandomPost()"><i class="fa-fw fa-solid fa-car-side"></i> <span>éšä¾¿é€›é€›</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fa-solid fa-gift"></i> <span>ä¼‘é—²</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fa-solid fa-headphones"></i> <span>éŸ³ä¹</span></a></li><li><a class="site-page child" href="/video/"><i class="fa-fw fa-brands fa-youtube"></i> <span>è§†é¢‘</span></a></li><li><a class="site-page child" href="/photo/"><i class="fa-fw fa-regular fa-images"></i> <span>å›¾ç‰‡</span></a></li><li><a class="site-page child" href="/play/"><i class="fa-fw fa-solid fa-gamepad"></i> <span>æ¸¸æˆ</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fa-solid fa-circle-nodes"></i> <span>äº’åŠ¨</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/comments/"><i class="fa-fw fa-sharp fa-solid fa-paper-plane"></i> <span>ç•™è¨€æ¿</span></a></li><li><a class="site-page child" href="/artitalk/"><i class="fa-fw fa-solid fa-pen-nib"></i> <span>æˆ‘çš„è¯´è¯´</span></a></li><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i> <span>å‹æƒ…é“¾æ¥</span></a></li><li><a class="site-page child" href="/friends/"><i class="fa-fw fa-solid fa-user-group"></i> <span>å‹é“¾æœ‹å‹åœˆ</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fa-solid fa-thumbs-up"></i> <span>æ¨è</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/tools/"><i class="fa-fw fa-solid fa-wrench"></i> <span>å®ç”¨å·¥å…·</span></a></li><li><a class="site-page child" href="/collect/"><i class="fa-fw fa-solid fa-mug-saucer"></i> <span>æ—¶ç©ºä¹‹æµ·</span></a></li><li><a class="site-page child" href="/equipment/"><i class="fa-fw fa-solid fa-user-astronaut"></i> <span>æˆ‘çš„è£…å¤‡</span></a></li><li><a class="site-page child" href="/commentwall/"><i class="fa-fw fa-brands fa-skyatlas"></i> <span>è¨€è¯­æ˜Ÿç©º</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa-regular fa-address-card"></i> <span>å…³äºæœ¬ç«™</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background-image:url('/img/blog/default_top_img.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="å å…¥æ˜Ÿé‡çš„æœˆğŸŒ™"><img class="site-icon" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/blog/avatar.jpg"></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i> <span>æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>ä¸»é¡µ</span></a></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fa-sharp fa-solid fa-book-open"></i> <span>æ–‡åº“</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fa-solid fa-calendar-days"></i> <span>æ–‡ç« å½’æ¡£</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>æ–‡ç« æ ‡ç­¾</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>æ–‡ç« åˆ†ç±»</span></a></li><li><a class="site-page child" href="javascript:toRandomPost()"><i class="fa-fw fa-solid fa-car-side"></i> <span>éšä¾¿é€›é€›</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fa-solid fa-gift"></i> <span>ä¼‘é—²</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fa-solid fa-headphones"></i> <span>éŸ³ä¹</span></a></li><li><a class="site-page child" href="/video/"><i class="fa-fw fa-brands fa-youtube"></i> <span>è§†é¢‘</span></a></li><li><a class="site-page child" href="/photo/"><i class="fa-fw fa-regular fa-images"></i> <span>å›¾ç‰‡</span></a></li><li><a class="site-page child" href="/play/"><i class="fa-fw fa-solid fa-gamepad"></i> <span>æ¸¸æˆ</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fa-solid fa-circle-nodes"></i> <span>äº’åŠ¨</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/comments/"><i class="fa-fw fa-sharp fa-solid fa-paper-plane"></i> <span>ç•™è¨€æ¿</span></a></li><li><a class="site-page child" href="/artitalk/"><i class="fa-fw fa-solid fa-pen-nib"></i> <span>æˆ‘çš„è¯´è¯´</span></a></li><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i> <span>å‹æƒ…é“¾æ¥</span></a></li><li><a class="site-page child" href="/friends/"><i class="fa-fw fa-solid fa-user-group"></i> <span>å‹é“¾æœ‹å‹åœˆ</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fa-solid fa-thumbs-up"></i> <span>æ¨è</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/tools/"><i class="fa-fw fa-solid fa-wrench"></i> <span>å®ç”¨å·¥å…·</span></a></li><li><a class="site-page child" href="/collect/"><i class="fa-fw fa-solid fa-mug-saucer"></i> <span>æ—¶ç©ºä¹‹æµ·</span></a></li><li><a class="site-page child" href="/equipment/"><i class="fa-fw fa-solid fa-user-astronaut"></i> <span>æˆ‘çš„è£…å¤‡</span></a></li><li><a class="site-page child" href="/commentwall/"><i class="fa-fw fa-brands fa-skyatlas"></i> <span>è¨€è¯­æ˜Ÿç©º</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa-regular fa-address-card"></i> <span>å…³äºæœ¬ç«™</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">IDAä¸­åŠ å¯†ç®—æ³•ç‰¹å¾ä¸è§£å¯†</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-sharp fa-regular fa-pen-to-square fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2023-03-16T16:00:00.000Z 2023-03-17 00:00:00">2023-03-17</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2024-10-25T02:22:11.000Z 2024-10-25 10:22:11">2024-10-25</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-folder-open fa-fw post-meta-icon"></i> <a class="post-meta-categories" href="/categories/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B/">é€†å‘å·¥ç¨‹</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">å­—æ•°æ€»è®¡:</span> <span class="word-count">13.6k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span> <span>68åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span data-flag-title="IDAä¸­åŠ å¯†ç®—æ³•ç‰¹å¾ä¸è§£å¯†"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span class="waline-pageview-count" data-path="/posts/52521377.html"><i class="fa-solid fa-spinner fa-spin"></i></span></span> <span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">è¯„è®ºæ•°:</span><a href="/posts/52521377.html#post-comment"><span class="waline-comment-count" data-path="/posts/52521377.html"><i class="fa-solid fa-spinner fa-spin"></i></span></a></span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s58 18 88 18 58-18 88-18 58 18 88 18v44h-352Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="Base64"><a href="#Base64" class="headerlink" title="Base64"></a>Base64</h1><blockquote><p><strong>è½¬æ¢æ­¥éª¤</strong>ï¼š</p><ol><li>å°†å¾…è½¬æ¢çš„å­—ç¬¦ä¸²ï¼Œæ¯ 3 ä¸ªå­—èŠ‚åˆ†ä¸ºä¸€ç»„ï¼Œæ¯ä¸ªå­—èŠ‚å  8 bitï¼Œå…± 24 ä¸ªäºŒè¿›åˆ¶ä½</li><li>å°†ä¸Šé¢çš„ 24 ä¸ªäºŒè¿›åˆ¶ä½ï¼Œæ¯ 6 ä¸ªå­—èŠ‚åšä¸ºä¸€ç»„ï¼Œå…±åˆ†ä¸º 4 ç»„ <em>ï¼ˆè‹¥æœ€åä¸€ç»„å­—ç¬¦æ•°ä¸è¶³ä¸‰ä¸ªï¼Œç”¨ â€˜=â€™ è¡¥å……ï¼‰</em></li><li>åœ¨æ¯ç»„å‰é¢æ·»åŠ ä¸¤ä¸ª 0ï¼Œæ¯ç»„ç”± 6 ä¸ªå˜ä¸º 8 ä¸ªäºŒè¿›åˆ¶ä½ï¼Œæ€»å…± 32 ä¸ªäºŒè¿›åˆ¶ä½ï¼Œå³ 4 ä¸ªå­—èŠ‚</li><li>æ ¹æ® Base64 ç¼–ç å¯¹ç…§è¡¨è·å¾—å¯¹åº”çš„å€¼</li></ol><p><strong>Base64 ç®—æ³•è§£ç è¿‡ç¨‹</strong><br>å»æ‰æ‰€æœ‰çš„ç­‰å·ï¼ŒæŸ¥è¡¨å°†å­—ç¬¦è½¬ä¸ºäºŒè¿›åˆ¶çš„ç´¢å¼•å€¼ï¼Œæœ€åæ¯ 8 ä½ä¸€ç»„è®¡ç®— ASCii ç è¿˜åŸå­—ç¬¦ï¼Œ<mark>ä¸è¶³ 8 ä½åˆ™ä¸¢å¼ƒ</mark></p><p><strong>åŸå§‹ Base64 ç è¡¨</strong>ï¼š<code>ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/</code></p></blockquote><blockquote><p><strong>Base64 &amp; Base32 &amp; Base16</strong><br><em><strong>Base64</strong></em> å°±æ˜¯ç”¨æ¯ <code>6 ä½äºŒè¿›åˆ¶ï¼ˆ2 çš„ 6 æ¬¡å¹‚å°±æ˜¯ 64ï¼‰</code> æ¥è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦<br><em><strong>Base32</strong></em> å°±æ˜¯ç”¨æ¯ <code>5 ä½äºŒè¿›åˆ¶ï¼ˆ2 çš„ 5 æ¬¡å¹‚å°±æ˜¯ 32ï¼‰</code> æ¥è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦<br><em><strong>Base16</strong></em> å°±æ˜¯ç”¨æ¯ <code>4 ä½äºŒè¿›åˆ¶ï¼ˆ2 çš„ 4 æ¬¡å¹‚å°±æ˜¯ 16ï¼‰</code> æ¥è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦</p><p><em>é—®ï¼šBase64 ä¸ºä»€ä¹ˆä½¿ç”¨ 3 ä¸ªå­—èŠ‚ä½œä¸ºä¸€ç»„å‘¢ï¼Ÿ</em><br>å› ä¸º 6 å’Œ 8 çš„æœ€å°å…¬å€æ•°ä¸º 24ï¼Œä¸‰ä¸ªå­—èŠ‚æ­£å¥½ 24 ä¸ªäºŒè¿›åˆ¶ä½ï¼Œæ¯ 6 bit ä¸ºä¸€ç»„ï¼Œæ°å¥½èƒ½å¤Ÿåˆ†ä¸º 4 ç»„</p></blockquote><h2 id="ç‰¹ç‚¹"><a href="#ç‰¹ç‚¹" class="headerlink" title="ç‰¹ç‚¹"></a>ç‰¹ç‚¹</h2><ol><li><p>Base64 è¦ç”¨åˆ° Base64 ç è¡¨ï¼Œå¯ä»¥åœ¨ç¨‹åºä¸­æ‰¾åˆ°è¿ç»­çš„å­—ç¬¦ä¸²ï¼š<code>ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/</code></p></li><li><p>æ ¹æ® Base64 åŠ å¯†åŸç†ï¼Œä»£ç ä¸­å¿…ç„¶å­˜åœ¨<mark>æ ¹æ®ä½™æ•°ä¸ªæ•°åˆ¤æ–­æ˜¯å¦æ·»åŠ ç­‰å·</mark>çš„ä»£ç <br>å­—ç¬¦ <code>'='</code> çš„ ASCii ç ï¼š61ï¼ˆ0x3Dï¼‰ï¼Œä¹Ÿæœ‰å¯èƒ½ç›´æ¥ç´¢å¼•ç è¡¨é‡Œé¢çš„ <code>'='</code></p></li><li><p>è¯†åˆ«ä»£ç ä¸­å¯¹æ•°æ®çš„å·¦ç§»å³ç§»æ“ä½œ<br><code>((a[0] &amp; 3) &lt;&lt; 4) | (a[1] &gt;&gt; 4 )</code> å’Œ <code>(16 * (a[0] &amp; 3)) | (a[1] / 16)</code> æ˜¯ç­‰ä»·æ“ä½œï¼Œéƒ½è¡¨ç¤ºå– <code>a[0]</code> å 2 ä½ä¸ <code>a[1]</code> å‰ 4 ä½æ‹¼æ¥ï¼Œæ˜¯ Base64 ä¸­çš„å¸¸è§æ“ä½œ</p></li><li><p>æœ€ä¸»è¦çš„æ˜¯ç†è§£ç¼–ç è§£ç åŸç†ï¼Œæ¯”å¦‚ç¼–ç æ—¶é€šå¸¸éƒ½ä¼šç”¨ 3 ä¸ªå­—èŠ‚ä¸€ç»„æ¥å¤„ç†æ¯”ç‰¹ä½æ•°æ®</p></li></ol><hr><h2 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h2><p>ä»¥ä¸‹å›¾çš„è¡¨æ ¼ä¸ºç¤ºä¾‹</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blog-markdown-1317553172.cos.ap-nanjing.myqcloud.com/%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95%E7%9A%84%E5%87%BD%E6%95%B0%E7%89%B9%E5%BE%811.jpeg" alt="åŠ å¯†ç®—æ³•çš„å‡½æ•°ç‰¹å¾1.jpeg"></p><p>å…·ä½“åˆ†æä¸€ä¸‹æ•´ä¸ªè¿‡ç¨‹ï¼š</p><ol><li>ç¬¬ 1 æ­¥ï¼Œæ ¹æ® <code>'M'</code>ã€<code>'a'</code>ã€<code>'n'</code> å¯¹åº”çš„ ASCii ç å€¼åˆ†åˆ«ä¸º 77ï¼Œ97ï¼Œ110ï¼Œå¯¹åº”çš„äºŒè¿›åˆ¶å€¼æ˜¯ï¼š01001101ã€01100001ã€01101110ï¼Œç”±æ­¤ç»„æˆä¸€ä¸ª 24 ä½çš„äºŒè¿›åˆ¶å­—ç¬¦ä¸²</li><li>ç¬¬ 2 æ­¥ï¼Œå¦‚å›¾çº¢è‰²æ¡†ï¼Œå°† 24 ä½æ¯ 6 ä½äºŒè¿›åˆ¶ä½ä¸€ç»„åˆ†æˆ 4 ç»„</li><li>ç¬¬ 3 æ­¥ï¼Œåœ¨ä¸Šé¢æ¯ä¸€ç»„å‰é¢è¡¥ä¸¤ä¸ª 0ï¼Œæ‰©å±•æˆ 32 ä¸ªäºŒè¿›åˆ¶ä½ï¼š<mark>00</mark>010011ã€<mark>00</mark>010110ã€<mark>00</mark>000101ã€<mark>00</mark>101110</li><li>ç¬¬ 4 æ­¥ï¼Œå››ç»„ 8bit åˆ†åˆ«å¯¹åº”çš„å€¼ <strong>ï¼ˆBase64 ç¼–ç ç´¢å¼•ï¼‰</strong> ä¸ºï¼š19ã€22ã€5ã€46ï¼Œåœ¨ Base64 ç¼–ç è¡¨ä¸­è¿›è¡ŒæŸ¥æ‰¾ï¼Œåˆ†åˆ«å¯¹åº”ï¼š<code>'T'</code>ã€<code>'W'</code>ã€<code>'F'</code>ã€<code>'u'</code>ï¼Œå› æ­¤ â€œManâ€ ç»è¿‡ Base64 ç¼–ç ä¹‹åå°±å˜ä¸ºï¼š<code>"TWFu"</code></li></ol><p><strong>å¦‚æœé‡åˆ°ä½æ•°ä¸è¶³çš„æƒ…å†µ</strong>ï¼Œä½æ•°ä¸è¶³ç”¨ â€˜=â€™ è¡¥å……ï¼Œæ€»å…±æœ‰ä¸¤ç§æƒ…å†µï¼š</p><ol><li>æœ€åä¸€ç»„åªæœ‰ä¸€ä¸ªå­—ç¬¦</li><li>æœ€åä¸€ç»„æœ‰ä¸¤ä¸ªå­—ç¬¦</li></ol><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blog-markdown-1317553172.cos.ap-nanjing.myqcloud.com/%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95%E7%9A%84%E5%87%BD%E6%95%B0%E7%89%B9%E5%BE%812.png" alt="åŠ å¯†ç®—æ³•çš„å‡½æ•°ç‰¹å¾2.png"></p><h2 id="åŠ è§£å¯†ä»£ç "><a href="#åŠ è§£å¯†ä»£ç " class="headerlink" title="åŠ è§£å¯†ä»£ç "></a>åŠ è§£å¯†ä»£ç </h2><h3 id="Python-ç‰ˆï¼ˆç®€æ´è„šæœ¬ï¼‰"><a href="#Python-ç‰ˆï¼ˆç®€æ´è„šæœ¬ï¼‰" class="headerlink" title="Python ç‰ˆï¼ˆç®€æ´è„šæœ¬ï¼‰"></a>Python ç‰ˆï¼ˆç®€æ´è„šæœ¬ï¼‰</h3><ul><li><p><strong>ç‰¹ç‚¹</strong></p><ol><li>å¯ä»¥æ›´æ¢åŠ å¯†çš„ç è¡¨</li><li>å¿«æ·ï¼Œç›´æ¥ä½¿ç”¨å³å¯</li></ol></li><li><p><strong>ä»£ç </strong></p></li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> base64

<span class="token comment"># encè¡¨ç¤ºæ›´æ¢ç è¡¨åçš„å¾…è§£å¯†å­—ç¬¦ä¸²</span>
enc <span class="token operator">=</span> <span class="token string">"x2dtJEOmyjacxDemx2eczT5cVS9fVUGvWTuZWjuexjRqy24rV29q"</span>

<span class="token comment"># new_tableè¡¨ç¤ºæ›´æ¢åçš„ç è¡¨</span>
new_table <span class="token operator">=</span> <span class="token string">"ZYXABCDEFGHIJKLMNOPQRSTUVWzyxabcdefghijklmnopqrstuvw0123456789+/"</span>

<span class="token comment"># old_tableè¡¨ç¤ºåŸå§‹ç è¡¨</span>
old_table <span class="token operator">=</span> <span class="token string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"</span>

<span class="token comment"># å°†encè¿˜åŸæˆåŸå§‹ç è¡¨åŠ å¯†åçš„å†…å®¹ï¼Œå­˜æ”¾åœ¨decä¸­</span>
dec <span class="token operator">=</span> enc<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">.</span>maketrans<span class="token punctuation">(</span>new_table<span class="token punctuation">,</span> old_table<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Base64è§£å¯†ï¼Œbase64.b64decode()çš„ç»“æœä¸º bytes ç±»å‹</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>dec<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h3 id="Python-ç‰ˆï¼ˆå®Œæ•´ç³»ç»Ÿï¼‰"><a href="#Python-ç‰ˆï¼ˆå®Œæ•´ç³»ç»Ÿï¼‰" class="headerlink" title="Python ç‰ˆï¼ˆå®Œæ•´ç³»ç»Ÿï¼‰"></a>Python ç‰ˆï¼ˆå®Œæ•´ç³»ç»Ÿï¼‰</h3><ul><li><p><strong>ç‰¹ç‚¹</strong></p><ol><li>å¯ä»¥æ›´æ¢åŠ å¯†çš„ç è¡¨</li><li>æ”¯æŒåŠ å¯†å’Œè§£å¯†</li></ol></li><li><p><strong>ä»£ç </strong></p></li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># coding:utf-8  </span>
s <span class="token operator">=</span> <span class="token string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"</span>  <span class="token comment"># åŸå§‹ç è¡¨  </span>
  
  
<span class="token keyword">def</span> <span class="token function">my_base64_encode</span><span class="token punctuation">(</span>inputs<span class="token punctuation">)</span><span class="token punctuation">:</span>  
    <span class="token keyword">try</span><span class="token punctuation">:</span>  
        <span class="token comment"># å°†å­—ç¬¦ä¸²è½¬åŒ–ä¸º2è¿›åˆ¶  </span>
        bin_str <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>  
        <span class="token keyword">for</span> i <span class="token keyword">in</span> inputs<span class="token punctuation">:</span>  
            x <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">bin</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'0b'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>  
            bin_str<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">'{:0&gt;8}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>  
        <span class="token comment"># print(bin_str)  </span>
        <span class="token comment"># è¾“å‡ºçš„å­—ç¬¦ä¸²  </span>
        outputs <span class="token operator">=</span> <span class="token string">""</span>  
        <span class="token comment"># ä¸å¤Ÿä¸‰å€æ•°ï¼Œéœ€è¡¥é½çš„æ¬¡æ•°  </span>
        nums <span class="token operator">=</span> <span class="token number">0</span>  
        <span class="token keyword">while</span> bin_str<span class="token punctuation">:</span>  
            <span class="token comment"># æ¯æ¬¡å–ä¸‰ä¸ªå­—ç¬¦çš„äºŒè¿›åˆ¶  </span>
            temp_list <span class="token operator">=</span> bin_str<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span>  
            <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>temp_list<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">3</span><span class="token punctuation">:</span>  
                nums <span class="token operator">=</span> <span class="token number">3</span> <span class="token operator">-</span> <span class="token builtin">len</span><span class="token punctuation">(</span>temp_list<span class="token punctuation">)</span>  
                <span class="token keyword">while</span> <span class="token builtin">len</span><span class="token punctuation">(</span>temp_list<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">:</span>  
                    temp_list <span class="token operator">+=</span> <span class="token punctuation">[</span><span class="token string">'0'</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">]</span>  
            temp_str <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>temp_list<span class="token punctuation">)</span>  
            <span class="token comment"># print(temp_str)  </span>
            <span class="token comment"># å°†ä¸‰ä¸ª8å­—èŠ‚çš„äºŒè¿›åˆ¶è½¬æ¢ä¸º4ä¸ªåè¿›åˆ¶  </span>
            temp_str_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>  
            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  
                temp_str_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>temp_str<span class="token punctuation">[</span>i <span class="token operator">*</span> <span class="token number">6</span><span class="token punctuation">:</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  
            <span class="token comment"># print(temp_str_list)  </span>
            <span class="token keyword">if</span> nums<span class="token punctuation">:</span>  
                temp_str_list <span class="token operator">=</span> temp_str_list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">4</span> <span class="token operator">-</span> nums<span class="token punctuation">]</span>  
  
            <span class="token keyword">for</span> i <span class="token keyword">in</span> temp_str_list<span class="token punctuation">:</span>  
                outputs <span class="token operator">+=</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span>  
            bin_str <span class="token operator">=</span> bin_str<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token punctuation">]</span>  
        outputs <span class="token operator">+=</span> nums <span class="token operator">*</span> <span class="token string">'='</span>  
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"åŠ å¯†å®Œæˆ:\n%s "</span> <span class="token operator">%</span> outputs<span class="token punctuation">)</span>  
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>  
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"åŠ å¯†é”™è¯¯: \n</span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>  
  
  
<span class="token keyword">def</span> <span class="token function">my_base64_decode</span><span class="token punctuation">(</span>inputs<span class="token punctuation">)</span><span class="token punctuation">:</span>  
    <span class="token keyword">try</span><span class="token punctuation">:</span>  
        <span class="token comment"># å°†å­—ç¬¦ä¸²è½¬åŒ–ä¸º2è¿›åˆ¶  </span>
        bin_str <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>  
        <span class="token keyword">for</span> i <span class="token keyword">in</span> inputs<span class="token punctuation">:</span>  
            <span class="token keyword">if</span> i <span class="token operator">!=</span> <span class="token string">'='</span><span class="token punctuation">:</span>  
                x <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">bin</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>index<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'0b'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>  
                bin_str<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">'{:0&gt;6}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>  
        <span class="token comment"># print(bin_str)  </span>
        <span class="token comment"># è¾“å‡ºçš„å­—ç¬¦ä¸²  </span>
        outputs <span class="token operator">=</span> <span class="token string">""</span>  
        nums <span class="token operator">=</span> inputs<span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token string">'='</span><span class="token punctuation">)</span>  
        <span class="token keyword">while</span> bin_str<span class="token punctuation">:</span>  
            temp_list <span class="token operator">=</span> bin_str<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span>  
            temp_str <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>temp_list<span class="token punctuation">)</span>  
            <span class="token comment"># print(temp_str)  </span>
            <span class="token comment"># è¡¥è¶³8ä½å­—èŠ‚  </span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>temp_str<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">8</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  
                temp_str <span class="token operator">=</span> temp_str<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span> <span class="token operator">*</span> nums <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">]</span>  
            <span class="token comment"># å°†å››ä¸ª6å­—èŠ‚çš„äºŒè¿›åˆ¶è½¬æ¢ä¸ºä¸‰ä¸ªå­—ç¬¦  </span>
            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>temp_str<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  
                outputs <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>temp_str<span class="token punctuation">[</span>i <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">:</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  
            bin_str <span class="token operator">=</span> bin_str<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span>  
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"è§£å¯†å®Œæˆ:\n%s "</span> <span class="token operator">%</span> outputs<span class="token punctuation">)</span>  
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>  
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"è§£å¯†é”™è¯¯: \n</span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>  
  
  
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"     å¯æ›´æ¢ç è¡¨çš„ Base64 åŠ è§£å¯†ç³»ç»Ÿ       "</span><span class="token punctuation">)</span>  
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"*************************************"</span><span class="token punctuation">)</span>  
select <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"æ˜¯å¦æ›´æ¢åŠ å¯†çš„ç è¡¨? (y or n) ä½ çš„é€‰æ‹©: "</span><span class="token punctuation">)</span>  
<span class="token keyword">if</span> select <span class="token operator">==</span> <span class="token string">"y"</span> <span class="token keyword">or</span> select <span class="token operator">==</span> <span class="token string">"yes"</span><span class="token punctuation">:</span>  
    s <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"åœ¨è¿™é‡Œè¾“å…¥ç è¡¨: "</span><span class="token punctuation">)</span>  
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">".....done, å·²æ›´æ”¹!"</span><span class="token punctuation">)</span>  
<span class="token keyword">else</span><span class="token punctuation">:</span>  
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ç è¡¨æœªåšæ›´æ”¹!"</span><span class="token punctuation">)</span>  
  
input_str <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"è¾“å…¥æ•°æ®: "</span><span class="token punctuation">)</span>  
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"*************************************"</span><span class="token punctuation">)</span>  
my_base64_encode<span class="token punctuation">(</span>input_str<span class="token punctuation">)</span>  
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"*************************************"</span><span class="token punctuation">)</span>  
my_base64_decode<span class="token punctuation">(</span>input_str<span class="token punctuation">)</span>  
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"*************************************"</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h3 id="C-ç‰ˆï¼ˆå®Œæ•´ç³»ç»Ÿï¼‰"><a href="#C-ç‰ˆï¼ˆå®Œæ•´ç³»ç»Ÿï¼‰" class="headerlink" title="C++ ç‰ˆï¼ˆå®Œæ•´ç³»ç»Ÿï¼‰"></a>C++ ç‰ˆï¼ˆå®Œæ•´ç³»ç»Ÿï¼‰</h3><ul><li><p><strong>ç‰¹ç‚¹</strong></p><ol><li>å¯ä»¥æ›´æ¢åŠ å¯†çš„ç è¡¨</li><li>æ”¯æŒåŠ å¯†å’Œè§£å¯†</li></ol></li><li><p><strong>ä»£ç </strong></p></li></ul><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span>  </span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h&gt;</span>  </span>
  
<span class="token comment">// Base64 å­—ç¬¦è¡¨  </span>
<span class="token keyword">char</span> base64chars<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"</span><span class="token punctuation">;</span>  
  
<span class="token comment">// ç¼–ç ä¸€ä¸ªå­—èŠ‚  </span>
<span class="token keyword">char</span> <span class="token function">encode_byte</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
    <span class="token keyword">return</span> base64chars<span class="token punctuation">[</span>b<span class="token punctuation">]</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span>  
  
<span class="token comment">// Base64 ç¼–ç   </span>
<span class="token keyword">void</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>input<span class="token punctuation">,</span> size_t length<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
    <span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> length<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token comment">// å–ä¸‰ä¸ªå­—èŠ‚  </span>
        <span class="token keyword">unsigned</span> <span class="token keyword">int</span> triplet <span class="token operator">=</span> <span class="token punctuation">(</span>input<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">&lt;</span> length <span class="token operator">?</span> input<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">&lt;</span> length <span class="token operator">?</span> input<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
        <span class="token comment">// åˆ†å‰²æˆå››ä¸ªå…­ä½å­—èŠ‚å¹¶ç¼–ç   </span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%c%c%c%c"</span><span class="token punctuation">,</span>  
               <span class="token function">encode_byte</span><span class="token punctuation">(</span><span class="token punctuation">(</span>triplet <span class="token operator">&gt;&gt;</span> <span class="token number">18</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x3F</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  
               <span class="token function">encode_byte</span><span class="token punctuation">(</span><span class="token punctuation">(</span>triplet <span class="token operator">&gt;&gt;</span> <span class="token number">12</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x3F</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  
               i <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">&lt;</span> length <span class="token operator">?</span> <span class="token function">encode_byte</span><span class="token punctuation">(</span><span class="token punctuation">(</span>triplet <span class="token operator">&gt;&gt;</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x3F</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token char">'='</span><span class="token punctuation">,</span>  
               i <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">&lt;</span> length <span class="token operator">?</span> <span class="token function">encode_byte</span><span class="token punctuation">(</span>triplet <span class="token operator">&amp;</span> <span class="token number">0x3F</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token char">'='</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span>  
  
<span class="token comment">// æ˜ å°„å…³ç³»  </span>
<span class="token keyword">int</span> <span class="token function">decode_char</span><span class="token punctuation">(</span><span class="token keyword">char</span> ch<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">64</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">if</span> <span class="token punctuation">(</span>base64chars<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> ch<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
            <span class="token keyword">return</span> i<span class="token punctuation">;</span>  
        <span class="token punctuation">}</span>  
    <span class="token punctuation">}</span>  
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span>  
  
<span class="token comment">// Base64 è§£ç   </span>
<span class="token keyword">void</span> <span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>input<span class="token punctuation">,</span> size_t length<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
    <span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> length<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token comment">// å–å››ä¸ª Base64 å­—ç¬¦  </span>
        <span class="token keyword">unsigned</span> <span class="token keyword">int</span> quad <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">decode_char</span><span class="token punctuation">(</span>input<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">18</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token function">decode_char</span><span class="token punctuation">(</span>input<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">12</span><span class="token punctuation">)</span> <span class="token operator">|</span>  
                            <span class="token punctuation">(</span><span class="token function">decode_char</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">&lt;</span> length <span class="token operator">?</span> input<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token char">'='</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">|</span>  
                            <span class="token punctuation">(</span><span class="token function">decode_char</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">3</span> <span class="token operator">&lt;</span> length <span class="token operator">?</span> input<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token char">'='</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
        <span class="token comment">// åˆ†å‰²æˆä¸‰ä¸ªå­—èŠ‚å¹¶è¾“å‡º  </span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%c%c%c"</span><span class="token punctuation">,</span>  
               <span class="token punctuation">(</span>quad <span class="token operator">&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">,</span>  
               i <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">&lt;</span> length <span class="token operator">?</span> <span class="token punctuation">(</span>quad <span class="token operator">&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>  
               i <span class="token operator">+</span> <span class="token number">3</span> <span class="token operator">&lt;</span> length <span class="token operator">?</span> quad <span class="token operator">&amp;</span> <span class="token number">0xFF</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span>  
  
<span class="token keyword">void</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"     å¯æ›´æ¢ç è¡¨çš„ Base64 åŠ è§£å¯†ç³»ç»Ÿ       \n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"*************************************\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
    <span class="token keyword">char</span> option<span class="token punctuation">;</span>  
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"æ˜¯å¦æ›´æ¢åŠ å¯†çš„ç è¡¨? (y or n) ä½ çš„é€‰æ‹©: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token function">fflush</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%c"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>option<span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
    <span class="token keyword">if</span><span class="token punctuation">(</span>option <span class="token operator">==</span> <span class="token char">'y'</span> <span class="token operator">||</span> option <span class="token operator">==</span> <span class="token char">'Y'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"åœ¨è¿™é‡Œè¾“å…¥æ–°çš„ç è¡¨: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token function">fflush</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> base64chars<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">".....done, å·²æ›´æ”¹!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span> <span class="token keyword">else</span>  
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"ç è¡¨æœªåšæ›´æ”¹!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span>  
  
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
    <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
    <span class="token keyword">char</span> data<span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  
  
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"è¾“å…¥æ•°æ®: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token function">fflush</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    size_t input_length <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"*************************************\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"åŠ å¯†ç»“æœ: \n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token function">base64_encode</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> input_length<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"*************************************\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"è§£å¯†ç»“æœ: \n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token function">base64_decode</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> input_length<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"*************************************"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="IDA-ç¤ºä¾‹"><a href="#IDA-ç¤ºä¾‹" class="headerlink" title="IDA ç¤ºä¾‹"></a>IDA ç¤ºä¾‹</h2><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">char</span> <span class="token operator">*</span>__fastcall <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>a1<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> v1<span class="token punctuation">;</span> <span class="token comment">// eax  </span>
    <span class="token keyword">int</span> v2<span class="token punctuation">;</span> <span class="token comment">// eax  </span>
    <span class="token keyword">int</span> v3<span class="token punctuation">;</span> <span class="token comment">// eax  </span>
    <span class="token keyword">int</span> v4<span class="token punctuation">;</span> <span class="token comment">// eax  </span>
    <span class="token keyword">int</span> v5<span class="token punctuation">;</span> <span class="token comment">// eax  </span>
    <span class="token keyword">int</span> v6<span class="token punctuation">;</span> <span class="token comment">// eax  </span>
    <span class="token keyword">int</span> v8<span class="token punctuation">;</span> <span class="token comment">// [rsp+1Ch] [rbp-54h]  </span>
    <span class="token keyword">int</span> v9<span class="token punctuation">;</span> <span class="token comment">// [rsp+20h] [rbp-50h]  </span>
    <span class="token keyword">int</span> v10<span class="token punctuation">;</span> <span class="token comment">// [rsp+24h] [rbp-4Ch]  </span>
    <span class="token keyword">int</span> v11<span class="token punctuation">;</span> <span class="token comment">// [rsp+24h] [rbp-4Ch]  </span>
    <span class="token keyword">int</span> v12<span class="token punctuation">;</span> <span class="token comment">// [rsp+24h] [rbp-4Ch]  </span>
    <span class="token keyword">int</span> v13<span class="token punctuation">;</span> <span class="token comment">// [rsp+28h] [rbp-48h]  </span>
    <span class="token keyword">int</span> v14<span class="token punctuation">;</span> <span class="token comment">// [rsp+2Ch] [rbp-44h]  </span>
    <span class="token keyword">char</span> src<span class="token punctuation">[</span><span class="token number">56</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [rsp+30h] [rbp-40h]  </span>
    <span class="token keyword">unsigned</span> __int64 v16<span class="token punctuation">;</span> <span class="token comment">// [rsp+68h] [rbp-8h]  </span>
    
    v16 <span class="token operator">=</span> <span class="token function">__readfsqword</span><span class="token punctuation">(</span><span class="token number">0x28u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    v1 <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>a1<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// a1ä¸ºè¾“å…¥çš„å­—ç¬¦ä¸²  </span>
    v14 <span class="token operator">=</span> v1 <span class="token operator">%</span> <span class="token number">3</span><span class="token punctuation">;</span>   <span class="token comment">// v14ä¸ºè¾“å…¥å­—ç¬¦ä¸²é•¿åº¦é™¤3ä»¥åçš„ä½™æ•°  </span>
    v13 <span class="token operator">=</span> v1 <span class="token operator">/</span> <span class="token number">3</span><span class="token punctuation">;</span>   <span class="token comment">// v13ä¸º3ä¸ªä¸€ç»„çš„å­—ç¬¦ç»„åˆæ•°é‡  </span>
    <span class="token function">memset</span><span class="token punctuation">(</span>src<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0x30uLL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    v10 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    v8 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    v9 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span> v8 <span class="token operator">&lt;</span> v13 <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        v2 <span class="token operator">=</span> v10<span class="token punctuation">;</span>
        v11 <span class="token operator">=</span> v10 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token comment">// ç¬¬ä¸€ä¸ªï¼šç¬¬ä¸€ä¸ªå­—ç¬¦å³ç§»2ä½ï¼Œå–å‰6ä½ä½œä¸ºç´¢å¼•å€¼ï¼ŒæŸ¥æ‰¾å¯¹åº”å­—ç¬¦</span>
        src<span class="token punctuation">[</span>v2<span class="token punctuation">]</span> <span class="token operator">=</span> base64_table<span class="token punctuation">[</span>a1<span class="token punctuation">[</span>v9<span class="token punctuation">]</span> <span class="token operator">&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    
        v3 <span class="token operator">=</span> v11<span class="token operator">++</span><span class="token punctuation">;</span>    
        <span class="token comment">// ç¬¬äºŒä¸ªï¼šç¬¬ä¸€ä¸ªå­—ç¬¦å–å2ä½ä¸ç¬¬äºŒä¸ªå­—ç¬¦çš„å‰4ä½æ‹¼æ¥    </span>
        src<span class="token punctuation">[</span>v3<span class="token punctuation">]</span> <span class="token operator">=</span> base64_table<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">16</span> <span class="token operator">*</span> <span class="token punctuation">(</span>a1<span class="token punctuation">[</span>v9<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>a1<span class="token punctuation">[</span>v9 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    
        <span class="token comment">// ç¬¬ä¸‰ä¸ªï¼šç¬¬äºŒä¸ªå­—ç¬¦å–å4ä½ä¸ç¬¬ä¸‰ä¸ªå­—ç¬¦çš„å‰2ä½æ‹¼æ¥ï¼ŒæŸ¥æ‰¾å¯¹åº”å­—ç¬¦    </span>
        src<span class="token punctuation">[</span>v11<span class="token punctuation">]</span> <span class="token operator">=</span> base64_table<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">4</span> <span class="token operator">*</span> <span class="token punctuation">(</span>a1<span class="token punctuation">[</span>v9 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xF</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>a1<span class="token punctuation">[</span>v9 <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  
        v4 <span class="token operator">=</span> v11 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>    
        v10 <span class="token operator">=</span> v11 <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span>    
        <span class="token comment">// ç¬¬å››ä¸ªï¼šç¬¬ä¸‰ä¸ªå­—ç¬¦å–å6ä½ä½œä¸ºç´¢å¼•ï¼ŒæŸ¥æ‰¾å¯¹åº”å­—ç¬¦  </span>
        src<span class="token punctuation">[</span>v4<span class="token punctuation">]</span> <span class="token operator">=</span> base64_table<span class="token punctuation">[</span>a1<span class="token punctuation">[</span>v9 <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0x3F</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    
        v9 <span class="token operator">+=</span> <span class="token number">3</span><span class="token punctuation">;</span>    
        <span class="token operator">++</span>v8<span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
    <span class="token keyword">if</span> <span class="token punctuation">(</span> v14 <span class="token operator">==</span> <span class="token number">1</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>    <span class="token comment">// ä½™æ•°ä¸º1ï¼Œåˆ™éœ€è¦æ·»åŠ ä¸¤ä¸ªç­‰å·    </span>
        src<span class="token punctuation">[</span>v10<span class="token punctuation">]</span> <span class="token operator">=</span> base64_table<span class="token punctuation">[</span>a1<span class="token punctuation">[</span>v9<span class="token punctuation">]</span> <span class="token operator">&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    
        src<span class="token punctuation">[</span>v10 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> base64_table<span class="token punctuation">[</span><span class="token number">16</span> <span class="token operator">*</span> <span class="token punctuation">(</span>a1<span class="token punctuation">[</span>v9<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    
        <span class="token function">strcat</span><span class="token punctuation">(</span>src<span class="token punctuation">,</span> <span class="token string">"=="</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span> v14 <span class="token operator">==</span> <span class="token number">2</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>   <span class="token comment">// ä½™æ•°ä¸º2ï¼Œåˆ™éœ€è¦æ·»åŠ 1ä¸ªç­‰å·      </span>
        v5 <span class="token operator">=</span> v10<span class="token punctuation">;</span>    
        v12 <span class="token operator">=</span> v10 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>    
        src<span class="token punctuation">[</span>v5<span class="token punctuation">]</span> <span class="token operator">=</span> base64_table<span class="token punctuation">[</span>a1<span class="token punctuation">[</span>v9<span class="token punctuation">]</span> <span class="token operator">&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    
        v6 <span class="token operator">=</span> v12<span class="token operator">++</span><span class="token punctuation">;</span>    
        src<span class="token punctuation">[</span>v6<span class="token punctuation">]</span> <span class="token operator">=</span> base64_table<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">16</span> <span class="token operator">*</span> <span class="token punctuation">(</span>a1<span class="token punctuation">[</span>v9<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>a1<span class="token punctuation">[</span>v9 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    
        src<span class="token punctuation">[</span>v12<span class="token punctuation">]</span> <span class="token operator">=</span> base64_table<span class="token punctuation">[</span><span class="token number">4</span> <span class="token operator">*</span> <span class="token punctuation">(</span>a1<span class="token punctuation">[</span>v9 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xF</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    
        src<span class="token punctuation">[</span>v12 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'='</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
    <span class="token function">strcpy</span><span class="token punctuation">(</span>a1<span class="token punctuation">,</span> src<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> a1<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h1 id="RC4"><a href="#RC4" class="headerlink" title="RC4"></a>RC4</h1><blockquote><p>RC4 æ˜¯å¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œé€šè¿‡å¯†é’¥ key å’Œ S ç›’ç”Ÿæˆå¯†é’¥æµï¼Œæ˜æ–‡é€å­—èŠ‚å¼‚æˆ– S ç›’ï¼ŒåŒæ—¶ S ç›’ä¹Ÿä¼šå‘ç”Ÿæ”¹å˜<br>åŠ å¯†ä¸è§£å¯†ä½¿ç”¨äº†ç›¸åŒçš„å‡½æ•°å’Œå¯†é’¥ Kï¼ŒåŠ å¯†çš„å¼ºåº¦ä¸»è¦æ¥æºäºå¯†é’¥çš„å®‰å…¨æ€§ï¼Œå¯†é’¥æ³„éœ²èƒ½ç›´æ¥è§£å¯†å‡ºæ˜æ–‡</p><p><em>ç›¸å…³ Writeup è§ ã€Š<a href="5bfdd0f4.html">ã€æ”»é˜²ä¸–ç•Œã€‘crypt</a>ã€‹ã€ã€Š<a href="d5707ca8.html">ã€æ”»é˜²ä¸–ç•Œã€‘ereere</a>ã€‹</em></p></blockquote><h2 id="ç‰¹ç‚¹-1"><a href="#ç‰¹ç‚¹-1" class="headerlink" title="ç‰¹ç‚¹"></a>ç‰¹ç‚¹</h2><ol><li><p>RC4 åŠ å¯†ç®—æ³•å±äºæµåŠ å¯†ç®—æ³•ï¼ŒåŒ…æ‹¬<strong>åˆå§‹åŒ–å‡½æ•°</strong>å’Œ<strong>åŠ è§£å¯†å‡½æ•°</strong></p></li><li><p><strong>åˆå§‹åŒ–å‡½æ•°</strong>ä¸­æœ‰ä¸¤ä¸ª 256 å¾ªç¯ï¼Œç¬¬ä¸€ä¸ªå¾ªç¯ç»™ s ç›’åˆå§‹åŒ–ä¸º 0 - 255ï¼Œç¬¬äºŒä¸ªå¾ªç¯æ ¹æ®å¯†é’¥ key å¯¹ s ç›’ swap</p></li><li><p><strong>åŠ è§£å¯†å‡½æ•°</strong>ä¸­æœ‰ä¸€ä¸ª 256 å¾ªç¯ï¼Œä½¿æ˜æ–‡å’Œ s ç›’å¼‚æˆ–ç”Ÿæˆå¯†æ–‡</p></li></ol><hr><h2 id="åŸç†-1"><a href="#åŸç†-1" class="headerlink" title="åŸç†"></a>åŸç†</h2><h3 id="åˆå§‹åŒ–éƒ¨åˆ†"><a href="#åˆå§‹åŒ–éƒ¨åˆ†" class="headerlink" title="åˆå§‹åŒ–éƒ¨åˆ†"></a>åˆå§‹åŒ–éƒ¨åˆ†</h3><p>åˆå§‹åŒ–é•¿åº¦ä¸º 256 çš„ S ç›’ã€‚ç¬¬ä¸€ä¸ª for å¾ªç¯å°† 0 åˆ° 255 çš„äº’ä¸é‡å¤çš„å…ƒç´ è£…å…¥ S ç›’ï¼›ç¬¬äºŒä¸ª for å¾ªç¯æ ¹æ®å¯†é’¥ key æ‰“ä¹± S ç›’ï¼Œi ç¡®ä¿ S-box çš„æ¯ä¸ªå…ƒç´ éƒ½å¾—åˆ°å¤„ç†ï¼Œj ä¿è¯ S-box çš„æ…ä¹±æ˜¯éšæœºçš„</p><p>ä¸åŒçš„ S-box åœ¨ç»è¿‡ä¼ªéšæœºå­å¯†ç ç”Ÿæˆç®—æ³•çš„å¤„ç†åå¯ä»¥å¾—åˆ°ä¸åŒçš„å­å¯†é’¥åºåˆ—ï¼Œå°† S-box å’Œæ˜æ–‡è¿›è¡Œ xor è¿ç®—ï¼Œå¾—åˆ°å¯†æ–‡ï¼Œè§£å¯†è¿‡ç¨‹ä¹Ÿå®Œå…¨ç›¸åŒ</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">void</span> <span class="token function">rc4_init</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>s<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>key<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> key_Len<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> k<span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token comment">//ä¸´æ—¶å‘é‡ k</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> tmp <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">256</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>
        k<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token punctuation">)</span> key<span class="token punctuation">[</span>i <span class="token operator">%</span> key_Len<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token comment">//Len = strlen(key)ï¼Œå¯†é’¥çš„é•¿åº¦</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">256</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment">//æ‰“ä¹±sè¡¨</span>
        j <span class="token operator">=</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> k<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span><span class="token punctuation">;</span>
        tmp <span class="token operator">=</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> s<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token comment">//äº¤æ¢s[i]å’Œs[j]</span>
        s<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> tmp<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h3 id="åŠ è§£å¯†éƒ¨åˆ†"><a href="#åŠ è§£å¯†éƒ¨åˆ†" class="headerlink" title="åŠ è§£å¯†éƒ¨åˆ†"></a>åŠ è§£å¯†éƒ¨åˆ†</h3><p>æ¯æ”¶åˆ°ä¸€ä¸ªå­—èŠ‚ï¼Œå°±è¿›è¡Œå¾ªç¯ã€‚é€šè¿‡ä¸€å®šçš„ç®—æ³•å®šä½ S ç›’ä¸­çš„ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶ä¸è¾“å…¥å­—èŠ‚å¼‚æˆ–ï¼Œå¾—åˆ° kï¼›åŒæ—¶ï¼Œå¾ªç¯ä¸­è¿˜æ”¹å˜äº† S ç›’</p><p>å¦‚æœè¾“å…¥çš„æ˜¯æ˜æ–‡ï¼Œè¾“å‡ºçš„å°±æ˜¯å¯†æ–‡ï¼›å¦‚æœè¾“å…¥çš„æ˜¯å¯†æ–‡ï¼Œè¾“å‡ºçš„å°±æ˜¯æ˜æ–‡</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">void</span> <span class="token function">rc4_crypt</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>s<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>Data<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> Data_Len<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> t <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> tmp<span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> Data_Len<span class="token punctuation">;</span> k<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        i <span class="token operator">=</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span><span class="token punctuation">;</span>
        j <span class="token operator">=</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span><span class="token punctuation">;</span>
        tmp <span class="token operator">=</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> s<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token comment">//äº¤æ¢s[i]å’Œs[j]</span>
        s<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> tmp<span class="token punctuation">;</span>
        t <span class="token operator">=</span> <span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> s<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span><span class="token punctuation">;</span>
        Data<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">^=</span> s<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="åŠ è§£å¯†ä»£ç -1"><a href="#åŠ è§£å¯†ä»£ç -1" class="headerlink" title="åŠ è§£å¯†ä»£ç "></a>åŠ è§£å¯†ä»£ç </h2><h3 id="Python-ç‰ˆï¼ˆç®€æ´è„šæœ¬ï¼‰-1"><a href="#Python-ç‰ˆï¼ˆç®€æ´è„šæœ¬ï¼‰-1" class="headerlink" title="Python ç‰ˆï¼ˆç®€æ´è„šæœ¬ï¼‰"></a>Python ç‰ˆï¼ˆç®€æ´è„šæœ¬ï¼‰</h3><ul><li><p><strong>ç‰¹ç‚¹</strong></p><ol><li>åˆ©ç”¨ Python åº“å¿«æ·å®ç° RC4 ç®—æ³•</li><li><code>Key</code> è¡¨ç¤º RC4 çš„å¯†é’¥ï¼Œ<code>Str</code> è¡¨ç¤ºå¾…åŠ è§£å¯†çš„å†…å®¹ <strong>ï¼ˆbytes å‹ï¼‰</strong></li></ol></li><li><p><strong>ä»£ç </strong></p></li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> ARC4

Str <span class="token operator">=</span> <span class="token string">b''</span>
Key <span class="token operator">=</span> <span class="token string">""</span>

flag <span class="token operator">=</span> ARC4<span class="token punctuation">.</span>new<span class="token punctuation">(</span><span class="token builtin">bytes</span><span class="token punctuation">(</span>Key<span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>Str<span class="token punctuation">)</span>  
<span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><strong>ç¤ºä¾‹</strong></li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">Str <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">217</span><span class="token punctuation">,</span> <span class="token number">79</span><span class="token punctuation">,</span> <span class="token number">52</span><span class="token punctuation">,</span> <span class="token number">168</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">108</span><span class="token punctuation">,</span> <span class="token number">198</span><span class="token punctuation">,</span> <span class="token number">213</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">114</span><span class="token punctuation">,</span> <span class="token number">152</span><span class="token punctuation">,</span> <span class="token number">198</span><span class="token punctuation">,</span> <span class="token number">117</span><span class="token punctuation">,</span> <span class="token number">185</span><span class="token punctuation">,</span> <span class="token number">143</span><span class="token punctuation">]</span>  <span class="token comment"># å¾…åŠ è§£å¯†çš„å†…å®¹  </span>
Key <span class="token operator">=</span> <span class="token string">"SecretKey"</span>  <span class="token comment"># å¯†é’¥key  </span>
  
Str <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span>Str<span class="token punctuation">)</span>

<span class="token triple-quoted-string string">''' è¾“å‡ºï¼š
b'password123456789'
'''</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h3 id="Python-ç‰ˆï¼ˆå…·ä½“å®ç°ï¼‰"><a href="#Python-ç‰ˆï¼ˆå…·ä½“å®ç°ï¼‰" class="headerlink" title="Python ç‰ˆï¼ˆå…·ä½“å®ç°ï¼‰"></a>Python ç‰ˆï¼ˆå…·ä½“å®ç°ï¼‰</h3><ul><li><p><strong>ç‰¹ç‚¹</strong></p><ol><li>åŒ…å«å…·ä½“å®ç°æµç¨‹</li></ol></li><li><p><strong>ä»£ç </strong></p></li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">Str <span class="token operator">=</span> <span class="token string">""</span>    <span class="token comment"># å¾…åŠ è§£å¯†çš„å†…å®¹</span>
Key <span class="token operator">=</span> <span class="token string">""</span>    <span class="token comment"># å¯†é’¥key</span>
flag <span class="token operator">=</span> <span class="token string">""</span>   <span class="token comment"># å­˜æ”¾åŠ è§£å¯†åçš„ç»“æœ</span>

<span class="token comment"># ---------- rc4_init ----------</span>
s_box <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>  <span class="token comment"># å®šä¹‰ s ç›’</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># ç”Ÿæˆåˆå§‹ s ç›’</span>
    s_box<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
    <span class="token comment">#   T[i] = K[i mod len(Key)]    # è¿™ä¸ªç®—æ³•é‡Œæ²¡æœ‰ T[i]ï¼Œä¸‹é¢ä¼šè§£é‡Š</span>
t <span class="token operator">=</span> <span class="token number">0</span>
j <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># æ‰“ä¹± s ç›’é¡ºåº</span>
    tmp <span class="token operator">=</span> s_box<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
    j <span class="token operator">=</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> s_box<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>Key<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span>     <span class="token comment"># j = (j + S[i] + T[i]) mod 256</span>
    s_box<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> s_box<span class="token punctuation">[</span>j<span class="token punctuation">]</span>
    s_box<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> tmp
    t <span class="token operator">=</span> t <span class="token operator">+</span> <span class="token number">1</span>               <span class="token comment"># è¿™é‡Œå¼•å…¥çš„ t åŠ ä¸€ä¸ª if æ¡ä»¶å…¶å®å°±æ˜¯ä¸ºäº†åš t = i % len(Key)</span>
    <span class="token keyword">if</span> t <span class="token operator">&gt;=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>Key<span class="token punctuation">)</span><span class="token punctuation">:</span>       <span class="token comment"># Key[t] é…åˆ t = i % len(Key) å°±æ˜¯å®ç°äº† T[i] = K[i mod len(Key)]</span>
        t <span class="token operator">=</span> <span class="token number">0</span>               <span class="token comment"># å°ç»†èŠ‚å†™æ³•ä¸åŒè€Œå·²ï¼Œå¤§è‡´æ€è·¯æ˜¯ä¸€æ ·çš„</span>

<span class="token comment"># ---------- rc4_crypt ----------</span>
i <span class="token operator">=</span> <span class="token number">0</span>
j <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>Str<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    i <span class="token operator">=</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span>
    j <span class="token operator">=</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> s_box<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span>      <span class="token comment"># &amp; 0xff æ˜¯ä¸ºäº†åš % 256ï¼Œä¸¤è€…æ•ˆæœç›¸åŒ</span>
    tmp <span class="token operator">=</span> s_box<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
    s_box<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> s_box<span class="token punctuation">[</span>j<span class="token punctuation">]</span>
    s_box<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> tmp
    t <span class="token operator">=</span> <span class="token punctuation">(</span>s_box<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> s_box<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span>    <span class="token comment"># &amp; 0xff æ˜¯ä¸ºäº†åš % 256ï¼Œä¸¤è€…æ•ˆæœç›¸åŒ</span>
    flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>Str<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">^</span> s_box<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">)</span>      <span class="token comment"># æ˜æ–‡å¼‚æˆ–å¾—å¯†æ–‡ï¼Œå¯†æ–‡å¼‚æˆ–å¾—æ˜æ–‡</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"è§£å¯†ç»“æœ: "</span> <span class="token operator">+</span> flag<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><strong>ç¤ºä¾‹</strong></li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">Str <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">217</span><span class="token punctuation">,</span> <span class="token number">79</span><span class="token punctuation">,</span> <span class="token number">52</span><span class="token punctuation">,</span> <span class="token number">168</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">108</span><span class="token punctuation">,</span> <span class="token number">198</span><span class="token punctuation">,</span> <span class="token number">213</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">114</span><span class="token punctuation">,</span> <span class="token number">152</span><span class="token punctuation">,</span> <span class="token number">198</span><span class="token punctuation">,</span> <span class="token number">117</span><span class="token punctuation">,</span> <span class="token number">185</span><span class="token punctuation">,</span> <span class="token number">143</span><span class="token punctuation">]</span>  <span class="token comment"># å¾…åŠ è§£å¯†çš„å†…å®¹  </span>
Key <span class="token operator">=</span> <span class="token string">"SecretKey"</span>  <span class="token comment"># å¯†é’¥key  </span>
flag <span class="token operator">=</span> <span class="token string">""</span>  <span class="token comment"># å­˜æ”¾åŠ è§£å¯†åçš„ç»“æœ</span>

<span class="token triple-quoted-string string">''' è¾“å‡ºï¼š
è§£å¯†ç»“æœ: password123456789
'''</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h3 id="C-ç‰ˆï¼ˆå…·ä½“å®ç°ï¼‰"><a href="#C-ç‰ˆï¼ˆå…·ä½“å®ç°ï¼‰" class="headerlink" title="C++ ç‰ˆï¼ˆå…·ä½“å®ç°ï¼‰"></a>C++ ç‰ˆï¼ˆå…·ä½“å®ç°ï¼‰</h3><ul><li><p><strong>ç‰¹ç‚¹</strong></p><ol><li>åŒ…å«å…·ä½“å®ç°æµç¨‹</li></ol></li><li><p><strong>ä»£ç </strong></p></li></ul><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span> </span>


<span class="token keyword">void</span> <span class="token function">rc4_init</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>s<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>key<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> key_Len<span class="token punctuation">)</span>  
<span class="token punctuation">{</span>  
    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> k<span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token comment">//ä¸´æ—¶å‘é‡ k</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> tmp <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  
    <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">256</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>  
        k<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token punctuation">)</span> key<span class="token punctuation">[</span>i <span class="token operator">%</span> key_Len<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token comment">//Len = strlen(key)ï¼Œå¯†é’¥çš„é•¿åº¦  </span>
    <span class="token punctuation">}</span>  
    <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">256</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment">//æ‰“ä¹±sè¡¨  </span>
        j <span class="token operator">=</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> k<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span><span class="token punctuation">;</span>  
        tmp <span class="token operator">=</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>  
        s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> s<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token comment">//äº¤æ¢s[i]å’Œs[j]  </span>
        s<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> tmp<span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>  


<span class="token keyword">void</span> <span class="token function">rc4_crypt</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>s<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>Data<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> Data_Len<span class="token punctuation">)</span>  
<span class="token punctuation">{</span>  
    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> t <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  
    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> tmp<span class="token punctuation">;</span>  
    <span class="token keyword">for</span><span class="token punctuation">(</span>k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> Data_Len<span class="token punctuation">;</span> k<span class="token operator">++</span><span class="token punctuation">)</span>  
    <span class="token punctuation">{</span>  
        i <span class="token operator">=</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span><span class="token punctuation">;</span>  
        j <span class="token operator">=</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span><span class="token punctuation">;</span>  
        tmp <span class="token operator">=</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>  
        s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> s<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token comment">//äº¤æ¢s[i]å’Œs[j]  </span>
        s<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> tmp<span class="token punctuation">;</span>  
        t <span class="token operator">=</span> <span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> s<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span><span class="token punctuation">;</span>  
        Data<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">^=</span> s<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><strong>ç¤ºä¾‹ä¸€</strong></li></ul><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
<span class="token punctuation">{</span>  
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> data<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"password123456789"</span><span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> key<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"SecretKey"</span><span class="token punctuation">;</span>   <span class="token comment">// å¯†é’¥ key      </span>
  
    <span class="token comment">// è·å–å¯†é’¥é•¿åº¦  </span>
    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> key_len <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
    <span class="token comment">// åˆå§‹åŒ– RC4 çŠ¶æ€å‘é‡  </span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> state<span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  
    <span class="token function">rc4_init</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> key<span class="token punctuation">,</span> key_len<span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
    <span class="token comment">// åŠ å¯†æ•°æ®  </span>
    <span class="token function">rc4_crypt</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> data<span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"åŠ å¯†å: %s\n"</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
    <span class="token comment">// é‡æ–°åˆå§‹åŒ– RC4 çŠ¶æ€å‘é‡  </span>
    <span class="token function">rc4_init</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> key<span class="token punctuation">,</span> key_len<span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
    <span class="token comment">// è§£å¯†æ•°æ®  </span>
    <span class="token function">rc4_crypt</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> data<span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"è§£å¯†å: %s\n"</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span>

<span class="token comment">/* è¾“å‡ºï¼š
åŠ å¯†å: dè²½4ï¿½læ™®!ræ¨’uç®¯
è§£å¯†å: password123456789
*/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>ç¤ºä¾‹äºŒ</li></ul><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
<span class="token punctuation">{</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> data<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0x70</span><span class="token punctuation">,</span> <span class="token number">0x61</span><span class="token punctuation">,</span> <span class="token number">0x73</span><span class="token punctuation">,</span> <span class="token number">0x73</span><span class="token punctuation">,</span> <span class="token number">0x77</span><span class="token punctuation">,</span> <span class="token number">0x6f</span><span class="token punctuation">,</span> <span class="token number">0x72</span><span class="token punctuation">,</span> <span class="token number">0x64</span><span class="token punctuation">,</span> <span class="token number">0x31</span><span class="token punctuation">,</span> <span class="token number">0x32</span><span class="token punctuation">,</span> <span class="token number">0x33</span><span class="token punctuation">,</span> <span class="token number">0x34</span><span class="token punctuation">,</span> <span class="token number">0x35</span><span class="token punctuation">,</span> <span class="token number">0x36</span><span class="token punctuation">,</span> <span class="token number">0x37</span><span class="token punctuation">,</span> <span class="token number">0x38</span><span class="token punctuation">,</span> <span class="token number">0x39</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> key<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"SecretKey"</span><span class="token punctuation">;</span>   <span class="token comment">// å¯†é’¥ key</span>

    <span class="token comment">// è·å–æ•°æ®é•¿åº¦</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> data_len <span class="token operator">=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// è·å–å¯†é’¥é•¿åº¦</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> key_len <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// åˆå§‹åŒ– RC4 çŠ¶æ€å‘é‡</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> state<span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">rc4_init</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> key<span class="token punctuation">,</span> key_len<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// åŠ å¯†æ•°æ®</span>
    <span class="token function">rc4_crypt</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> data<span class="token punctuation">,</span> data_len<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"åŠ å¯†å: %s\n"</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// é‡æ–°åˆå§‹åŒ– RC4 çŠ¶æ€å‘é‡</span>
    <span class="token function">rc4_init</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> key<span class="token punctuation">,</span> key_len<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// è§£å¯†æ•°æ®</span>
    <span class="token function">rc4_crypt</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> data<span class="token punctuation">,</span> data_len<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"è§£å¯†å: %s\n"</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* è¾“å‡ºï¼š
åŠ å¯†å: dè²½4ï¿½læ™®!ræ¨’uç®¯D{ï¿½
è§£å¯†å: password123456789D{ï¿½
*/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="IDA-ç¤ºä¾‹-1"><a href="#IDA-ç¤ºä¾‹-1" class="headerlink" title="IDA ç¤ºä¾‹"></a>IDA ç¤ºä¾‹</h2><pre class="line-numbers language-c" data-language="c"><code class="language-c">__int64 __fastcall <span class="token function">rc4_init</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span>a1<span class="token punctuation">,</span> __int64 a2<span class="token punctuation">,</span> <span class="token keyword">int</span> a3<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  __int64 result<span class="token punctuation">;</span> <span class="token comment">// rax</span>
  <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment">// [rsp+0h] [rbp-28h]</span>
  <span class="token keyword">int</span> j<span class="token punctuation">;</span> <span class="token comment">// [rsp+0h] [rbp-28h]</span>
  <span class="token keyword">int</span> v6<span class="token punctuation">;</span> <span class="token comment">// [rsp+4h] [rbp-24h]</span>
  <span class="token keyword">int</span> v7<span class="token punctuation">;</span> <span class="token comment">// [rsp+8h] [rbp-20h]</span>
  <span class="token keyword">int</span> v8<span class="token punctuation">;</span> <span class="token comment">// [rsp+Ch] [rbp-1Ch]</span>
  _DWORD <span class="token operator">*</span>v9<span class="token punctuation">;</span> <span class="token comment">// [rsp+10h] [rbp-18h]</span>

  <span class="token operator">*</span>a1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  a1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  v9 <span class="token operator">=</span> a1 <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">256</span><span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span>
    v9<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>    <span class="token comment">//å¾ªç¯ç»™ s ç›’èµ‹å€¼</span>
  v6 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  result <span class="token operator">=</span> <span class="token number">0</span>i64<span class="token punctuation">;</span>
  <span class="token function">LOBYTE</span><span class="token punctuation">(</span>v7<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">256</span><span class="token punctuation">;</span> <span class="token operator">++</span>j <span class="token punctuation">)</span>    <span class="token comment">//å¾ªç¯æ ¹æ®å¯†é’¥ key å¯¹ s ç›’è¿›è¡Œ swap</span>
  <span class="token punctuation">{</span>    <span class="token comment">//â… ã€â…¡ã€â…¢ äº¤æ¢v9[j]å’Œv9[v7]çš„å€¼</span>
    v8 <span class="token operator">=</span> v9<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token comment">//â… </span>
    v7 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>a2 <span class="token operator">+</span> v6<span class="token punctuation">)</span> <span class="token operator">+</span> v8 <span class="token operator">+</span> v7<span class="token punctuation">)</span><span class="token punctuation">;</span>
    v9<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> v9<span class="token punctuation">[</span>v7<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token comment">//â…¡</span>
    v9<span class="token punctuation">[</span>v7<span class="token punctuation">]</span> <span class="token operator">=</span> v8<span class="token punctuation">;</span>    <span class="token comment">//â…¢</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">++</span>v6 <span class="token operator">&gt;=</span> a3 <span class="token punctuation">)</span>
      v6 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    result <span class="token operator">=</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>


_DWORD <span class="token operator">*</span>__fastcall <span class="token function">rc4_crypt</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span>a1<span class="token punctuation">,</span> __int64 a2<span class="token punctuation">,</span> <span class="token keyword">int</span> a3<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  _DWORD <span class="token operator">*</span>result<span class="token punctuation">;</span> <span class="token comment">// rax</span>
  <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment">// [rsp+0h] [rbp-28h]</span>
  <span class="token keyword">int</span> v5<span class="token punctuation">;</span> <span class="token comment">// [rsp+4h] [rbp-24h]</span>
  <span class="token keyword">int</span> v6<span class="token punctuation">;</span> <span class="token comment">// [rsp+8h] [rbp-20h]</span>
  <span class="token keyword">int</span> v7<span class="token punctuation">;</span> <span class="token comment">// [rsp+Ch] [rbp-1Ch]</span>
  <span class="token keyword">int</span> v8<span class="token punctuation">;</span> <span class="token comment">// [rsp+10h] [rbp-18h]</span>
  _DWORD <span class="token operator">*</span>v9<span class="token punctuation">;</span> <span class="token comment">// [rsp+18h] [rbp-10h]</span>

  v5 <span class="token operator">=</span> <span class="token operator">*</span>a1<span class="token punctuation">;</span>
  v6 <span class="token operator">=</span> a1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  v9 <span class="token operator">=</span> a1 <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> a3<span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span>
  <span class="token punctuation">{</span>    <span class="token comment">//â… ã€â…¡ã€â…¢ã€â…£ äº¤æ¢v9[v5]å’Œv9[v6]çš„å€¼</span>
    v5 <span class="token operator">=</span> <span class="token punctuation">(</span>v5 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//â… </span>
    v7 <span class="token operator">=</span> v9<span class="token punctuation">[</span>v5<span class="token punctuation">]</span><span class="token punctuation">;</span>
    v6 <span class="token operator">=</span> <span class="token punctuation">(</span>v7 <span class="token operator">+</span> v6<span class="token punctuation">)</span><span class="token punctuation">;</span>
    v8 <span class="token operator">=</span> v9<span class="token punctuation">[</span>v6<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token comment">//â…¡</span>
    v9<span class="token punctuation">[</span>v5<span class="token punctuation">]</span> <span class="token operator">=</span> v8<span class="token punctuation">;</span>    <span class="token comment">//â…¢</span>
    v9<span class="token punctuation">[</span>v6<span class="token punctuation">]</span> <span class="token operator">=</span> v7<span class="token punctuation">;</span>    <span class="token comment">//â…£</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>a2 <span class="token operator">+</span> i<span class="token punctuation">)</span> <span class="token operator">^=</span> <span class="token function">LOBYTE</span><span class="token punctuation">(</span>v9<span class="token punctuation">[</span><span class="token punctuation">(</span>v8 <span class="token operator">+</span> v7<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token operator">*</span>a1 <span class="token operator">=</span> v5<span class="token punctuation">;</span>
  result <span class="token operator">=</span> a1<span class="token punctuation">;</span>
  a1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> v6<span class="token punctuation">;</span>
  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h1 id="TEA"><a href="#TEA" class="headerlink" title="TEA"></a>TEA</h1><blockquote><p>TEA ç®—æ³•å…¨ç§°å¾®å‹åŠ å¯†ç®—æ³•ï¼Œæœ€åˆæ˜¯ç”±å‰‘æ¡¥è®¡ç®—æœºå®éªŒå®¤çš„ David Wheeler å’Œ Roger Needham åœ¨ 1994 å¹´è®¾è®¡çš„ã€‚ TEA ç®—æ³•ä½¿ç”¨ 64 ä½çš„æ˜æ–‡åˆ†ç»„å’Œ 128 ä½çš„å¯†é’¥ï¼Œå®ƒä½¿ç”¨ Feistel åˆ†ç»„åŠ å¯†æ¡†æ¶ï¼Œéœ€è¦è¿›è¡Œ 64 è½®è¿­ä»£ï¼Œå°½ç®¡ä½œè€…è®¤ä¸º 32 è½®å·²ç»è¶³å¤Ÿäº†ï¼Œ<strong>32 è½®è¿­ä»£åŠ å¯†åå¾—åˆ°çš„å¯†æ–‡å°±æ˜¯ 64 ä½</strong></p><p>è¯¥ç®—æ³•ä½¿ç”¨äº†ä¸€ä¸ªç¥ç§˜å¸¸æ•°&nbsp;<code>Î´ï¼ˆDeltaï¼‰</code>&nbsp;ä½œä¸ºå€æ•°ï¼Œå®ƒæ¥æºäºé»„é‡‘æ¯”ç‡ï¼Œä»¥ä¿è¯æ¯ä¸€è½®åŠ å¯†éƒ½ä¸ç›¸åŒã€‚ä½†&nbsp;<code>Î´ï¼ˆDeltaï¼‰</code>&nbsp;çš„ç²¾ç¡®å€¼ä¼¼ä¹å¹¶ä¸é‡è¦ï¼Œè¿™é‡Œ TEA æŠŠå®ƒå®šä¹‰ä¸º&nbsp;<code>Î´ =ã€Œ(âˆš5 - 1)231ã€</code>ï¼ˆä¹Ÿå°±æ˜¯ç¨‹åºä¸­çš„&nbsp;<code>0x9e3779b9</code>ï¼‰</p><p><em>ç›¸å…³ Writeup è§ ã€Š<a href="3d789eff.html">ã€GDOUCTF 2023ã€‘Tea</a>ã€‹</em></p></blockquote><h2 id="ç‰¹ç‚¹-2"><a href="#ç‰¹ç‚¹-2" class="headerlink" title="ç‰¹ç‚¹"></a>ç‰¹ç‚¹</h2><ol><li><p><strong>å¯†é’¥ä¸º 128 ä½</strong> <em>ï¼ˆä¸€èˆ¬åˆ†ä¸º 4 ä¸ª 32 ä½å­å¯†é’¥ï¼‰</em>ï¼Œ<strong>æ˜æ–‡ä¸º 64 ä½</strong> <em>ï¼ˆä¸€èˆ¬åˆ†ä¸º 2 ä¸ª 32 ä½æ˜æ–‡ï¼‰</em>ï¼Œä¸»è¦åšäº† <strong>32 è½®å˜æ¢</strong>ï¼Œæ¯è½®å˜æ¢ä¸­éƒ½æ¶‰åŠç§»ä½å’Œå˜æ¢æ“ä½œ</p></li><li><p>TEA ç®—æ³•ä¸­æœ‰ä¸€ä¸ªå›ºå®šçš„å¸¸æ•°&nbsp;<code>Î´ï¼ˆDeltaï¼‰</code>ï¼Œé€šå¸¸ä¸º <code>0x9e3779b9</code> æˆ–è€… <code>0x61c88647</code>ï¼Œå½“ç„¶ä¹Ÿå¯èƒ½é­”æ”¹</p></li><li><p>æœ‰å¯¹å¸¸æ•°&nbsp;<code>Î´ï¼ˆDeltaï¼‰</code> è¿›è¡Œçš„æ“ä½œï¼Œåœ¨ TEA ç®—æ³•åŠ å¯†è¿‡ç¨‹ä¸­ï¼Œ<code>Î´ = 0x9e3779b9</code> æ—¶ä»£ç ä¸­ä¼šå‡ºç°ç´¯åŠ ï¼Œ<code>Î´ = 0x61c88647</code> æ—¶ä»£ç ä¸­ä¼šå‡ºç°ç´¯å‡ <mark>ï¼ˆä¹Ÿå°±æ˜¯è¯´ï¼ŒåŠ å¯†è¿‡ç¨‹ä¸­ï¼š<code>sum -= 0x61c88647</code> å’Œ <code>sum += 0x9e3779b9</code>ï¼Œè¿™ä¸¤ä¸ªå€¼æ˜¯ç­‰ä»·çš„ï¼‰</mark></p></li><li><p>å½“ <code>Î´ = 0x9e3779b9</code> æ—¶ï¼Œè§£å¯†çš„åˆå§‹å€¼ <code>sun = num_rounds * DELTA</code>ï¼›å½“ <code>Î´ = 0x61c88647</code> æ—¶ï¼Œè§£å¯†çš„åˆå§‹å€¼ <code>sun = - num_rounds * DELTA</code></p></li><li><p>æ¶‰åŠåˆ°çš„ç§»ä½æ“ä½œé€šå¸¸æ˜¯å·¦ç§» 4 ä½ã€å³ç§» 5 ä½</p></li><li><p><mark>åœ¨ TEA ç®—æ³•ä¸­å–å¯†é’¥ key çš„æ—¶å€™æ˜¯å›ºå®šä¸‹æ ‡å–çš„</mark></p></li></ol><hr><h2 id="åŸç†-2"><a href="#åŸç†-2" class="headerlink" title="åŸç†"></a>åŸç†</h2><ol><li>å°†æ˜æ–‡æŒ‰ 64 ä½ï¼ˆ8 å­—èŠ‚ï¼‰åˆ†ç»„ï¼Œæ¯ç»„è§†ä¸ºä¸€ä¸ª 64 ä½çš„äºŒè¿›åˆ¶æ•°ï¼ŒåŒæ—¶å°†è¿™ 64 ä½çš„äºŒè¿›åˆ¶æ•°åˆ†æˆä¸¤ä¸ªç›¸ç­‰é•¿åº¦çš„éƒ¨åˆ† <code>v0</code> å’Œ <code>v1</code>ï¼ˆä¸¤ä¸ª 32 ä½æ˜æ–‡æ•°æ®ï¼‰</li><li>å°† 128 ä½çš„å¯†é’¥åˆ†æˆ 4 ä¸ª 32 ä½çš„å­å¯†é’¥ï¼Œåˆ†åˆ«è®°ä¸º <code>k0ã€k1ã€k2ã€k3</code>ï¼ˆå››ä¸ª 32 ä½å¯†é’¥ï¼‰</li><li>è®¾å®šä¸€ä¸ª 32 ä½çš„å¸¸æ•° deltaï¼Œå…¶å€¼ä¸º <code>0x9E3779B9</code>ï¼Œï¼ˆä¹Ÿå¯ä»¥ä¸º <code>0x61c88647</code>ï¼‰</li><li>å®šä¹‰ 32 è½®åŠ å¯†è¿­ä»£ï¼Œæ¯è½®ä¸­å³åŠéƒ¨åˆ†ä¼šç»è¿‡ä¸€ä¸ªè¿ç®—ï¼ŒåŒ…æ‹¬å·¦ç§»ã€å¼‚æˆ–ã€åŠ ç­‰æ“ä½œï¼Œå¹¶ä¸”æ¯è½®çš„å¯†é’¥æ˜¯ä¸åŒçš„</li><li>æœ€åå¾—åˆ°ç»è¿‡åŠ å¯†ç®—æ³•åŠ å¯†çš„å¯†æ–‡ <code>v0'</code> å’Œ <code>v1'</code></li></ol><p>åŠ å¯†æµç¨‹å¦‚å›¾ï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blog-markdown-1317553172.cos.ap-nanjing.myqcloud.com/%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95%E7%9A%84%E5%87%BD%E6%95%B0%E7%89%B9%E5%BE%813.png" alt="åŠ å¯†ç®—æ³•çš„å‡½æ•°ç‰¹å¾3.png"></p><hr><h2 id="åŠ è§£å¯†ä»£ç -2"><a href="#åŠ è§£å¯†ä»£ç -2" class="headerlink" title="åŠ è§£å¯†ä»£ç "></a>åŠ è§£å¯†ä»£ç </h2><h3 id="C-ç‰ˆ"><a href="#C-ç‰ˆ" class="headerlink" title="C++ ç‰ˆ"></a>C++ ç‰ˆ</h3><ul><li><p><strong>ç‰¹ç‚¹</strong></p><ol><li>åŒ…å«å…·ä½“å®ç°æµç¨‹</li><li>æ”¯æŒå¿«é€Ÿä¿®æ”¹åŠ å¯†è½®æ•° <code>num_rounds</code> å’Œ <code>delta</code> çš„å€¼</li></ol></li><li><p><strong>ä»£ç </strong></p></li></ul><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span> </span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdint.h&gt;</span>  </span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">DELTA</span> <span class="token expression"><span class="token number">0x9e3779b9</span>   </span><span class="token comment">// deltaå€¼</span></span>


<span class="token comment">//åŠ å¯†å‡½æ•°  </span>
<span class="token keyword">void</span> <span class="token function">tea_encrypt</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> num_rounds<span class="token punctuation">,</span> <span class="token keyword">uint32_t</span><span class="token operator">*</span> v<span class="token punctuation">,</span> <span class="token keyword">uint32_t</span><span class="token operator">*</span> key<span class="token punctuation">)</span> 
<span class="token punctuation">{</span> 
    <span class="token keyword">uint32_t</span> v0 <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> v1 <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>   <span class="token comment">// åˆå§‹åŒ–å‚æ•°   </span>
    <span class="token keyword">uint32_t</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>   <span class="token comment">// åˆå§‹sumä¸º0  </span>
    <span class="token keyword">uint32_t</span> k0 <span class="token operator">=</span> key<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> k1 <span class="token operator">=</span> key<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> k2 <span class="token operator">=</span> key<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> k3 <span class="token operator">=</span> key<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>   <span class="token comment">// keyå€¼  </span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> num_rounds<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token comment">// ä¸€èˆ¬ä¸º32è½®åŠ å¯†  </span>
        sum <span class="token operator">+=</span> DELTA<span class="token punctuation">;</span>  
        v0 <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v1 <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> k0<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>v1 <span class="token operator">+</span> sum<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v1 <span class="token operator">&gt;&gt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">+</span> k1<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        v1 <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v0 <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> k2<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>v0 <span class="token operator">+</span> sum<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v0 <span class="token operator">&gt;&gt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">+</span> k3<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
    v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> v0<span class="token punctuation">;</span> v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> v1<span class="token punctuation">;</span>   <span class="token comment">// å°†ç»“æœå­˜å›åŸå¯†é’¥æ•°ç»„  </span>
<span class="token punctuation">}</span>  


<span class="token comment">//è§£å¯†å‡½æ•°  </span>
<span class="token keyword">void</span> <span class="token function">tea_decrypt</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> num_rounds<span class="token punctuation">,</span> <span class="token keyword">uint32_t</span><span class="token operator">*</span> v<span class="token punctuation">,</span> <span class="token keyword">uint32_t</span><span class="token operator">*</span> key<span class="token punctuation">)</span> 
<span class="token punctuation">{</span>  
    <span class="token keyword">uint32_t</span> v0 <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> v1 <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>   <span class="token comment">// åˆå§‹åŒ–å‚æ•°   </span>
    <span class="token keyword">uint32_t</span> sum <span class="token operator">=</span> num_rounds <span class="token operator">*</span> DELTA<span class="token punctuation">;</span>   <span class="token comment">// åˆå§‹sumä¸ºdelta*åŠ å¯†è½®æ•°, å¦‚æœdaltaä¸º0x9e3779b9ï¼ŒåŠ å¯†32è½®ï¼Œåˆ™è¿™ä¸ªå€¼ä¸º0xC6EF3720  </span>
    <span class="token keyword">uint32_t</span> k0 <span class="token operator">=</span> key<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> k1 <span class="token operator">=</span> key<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> k2 <span class="token operator">=</span> key<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> k3 <span class="token operator">=</span> key<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>   <span class="token comment">// keyå€¼  </span>
  
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> num_rounds<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token comment">// ä¸€èˆ¬ä¸º32è½®è§£å¯†  </span>
        v1 <span class="token operator">-=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v0 <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> k2<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>v0 <span class="token operator">+</span> sum<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v0 <span class="token operator">&gt;&gt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">+</span> k3<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        v0 <span class="token operator">-=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v1 <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> k0<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>v1 <span class="token operator">+</span> sum<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v1 <span class="token operator">&gt;&gt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">+</span> k1<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        sum <span class="token operator">-=</span> DELTA<span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
    v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> v0<span class="token punctuation">;</span> v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> v1<span class="token punctuation">;</span>  
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><strong>ç¤ºä¾‹ä¸€</strong></li></ul><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">uint32_t</span> data<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0xDEADBEEF</span><span class="token punctuation">,</span> <span class="token number">0xFACEB00C</span><span class="token punctuation">,</span> <span class="token number">0xDAC0FFEE</span><span class="token punctuation">,</span> <span class="token number">0xABADBABE</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">uint32_t</span> key<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0x11111111</span><span class="token punctuation">,</span> <span class="token number">0x22222222</span><span class="token punctuation">,</span> <span class="token number">0x33333333</span><span class="token punctuation">,</span> <span class="token number">0x44444444</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> r <span class="token operator">=</span> <span class="token number">32</span><span class="token punctuation">;</span>   <span class="token comment">// è½®æ•°</span>
    <span class="token keyword">int</span> data_len <span class="token operator">=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// data çš„é•¿åº¦</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> data_len<span class="token punctuation">;</span> i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span>   <span class="token comment">// 2 ä¸ª 4 å­—èŠ‚ä¸ºä¸€ç»„</span>
        <span class="token function">tea_encrypt</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> <span class="token operator">&amp;</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"åŠ å¯†åï¼š0x%x 0x%x 0x%x 0x%x \n"</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> data_len<span class="token punctuation">;</span> i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span>   <span class="token comment">// 2 ä¸ª 4 å­—èŠ‚ä¸ºä¸€ç»„</span>
        <span class="token function">tea_decrypt</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> <span class="token operator">&amp;</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"è§£å¯†åï¼š0x%x 0x%x 0x%x 0x%x \n"</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* è¾“å‡ºï¼š
åŠ å¯†åï¼š0x99ad7ec2 0x938c4882 0x10ad3961 0xe971209e 
è§£å¯†åï¼š0xdeadbeef 0xfaceb00c 0xdac0ffee 0xabadbabe 
*/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><strong>ç¤ºä¾‹äºŒ</strong></li></ul><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;cstring&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">char</span> data<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"password123456789"</span><span class="token punctuation">;</span>
    <span class="token keyword">uint32_t</span> key<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0x11111111</span><span class="token punctuation">,</span> <span class="token number">0x22222222</span><span class="token punctuation">,</span> <span class="token number">0x33333333</span><span class="token punctuation">,</span> <span class="token number">0x44444444</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> r <span class="token operator">=</span> <span class="token number">32</span><span class="token punctuation">;</span>   <span class="token comment">// è½®æ•°</span>
    <span class="token keyword">int</span> data_len <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// data çš„é•¿åº¦</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> data_len<span class="token punctuation">;</span> i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">)</span>   <span class="token comment">// 8 å­—èŠ‚ä¸ºä¸€ç»„</span>
        <span class="token function">tea_encrypt</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">uint32_t</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"åŠ å¯†åï¼š%s\n"</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> data_len<span class="token punctuation">;</span> i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">)</span>   <span class="token comment">// 8 å­—èŠ‚ä¸ºä¸€ç»„</span>
        <span class="token function">tea_decrypt</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">uint32_t</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"è§£å¯†åï¼š%s\n"</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* è¾“å‡ºï¼š
åŠ å¯†åï¼š(ä¹±ç )
è§£å¯†åï¼špassword123456789
*/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>TEA ç®—æ³•å¯èƒ½çš„é­”æ”¹ï¼š</p><ol><li>ä¿®æ”¹ delta å€¼ï¼Œä¸å†ä¸º 0x9e3779b9 æˆ–è€… 0x61c88647</li><li>ä¿®æ”¹åŠ å¯†è¿‡ç¨‹ï¼Œåœ¨æ¯ä¸€è½®è¿­ä»£ä¸­å¢åŠ å¯é€†è¿ç®—ï¼Œä¾‹å¦‚åŠ ä¸Šä¸€ä¸ª <code>^ (sum + i)</code>ï¼š</li></ol><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> num_rounds<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// ä¸€èˆ¬ä¸º 32 è½®åŠ å¯†  </span>
sum <span class="token operator">+=</span> DELTA<span class="token punctuation">;</span>  
v0 <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v1 <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> k0<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>v1 <span class="token operator">+</span> sum<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v1 <span class="token operator">&gt;&gt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">+</span> k1<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>sum <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>  
v1 <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v0 <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> k2<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>v0 <span class="token operator">+</span> sum<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v0 <span class="token operator">&gt;&gt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">+</span> k3<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>sum <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é‚£ä¹ˆè§£å¯†æ—¶ï¼Œåˆ™ä¿®æ”¹ä¸ºï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> num_rounds<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token comment">// ä¸€èˆ¬ä¸º32è½®è§£å¯†</span>
v1 <span class="token operator">-=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v0 <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> k2<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>v0 <span class="token operator">+</span> sum<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v0 <span class="token operator">&gt;&gt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">+</span> k3<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>sum <span class="token operator">+</span> <span class="token punctuation">(</span>num_rounds <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">-</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
v0 <span class="token operator">-=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v1 <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> k0<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>v1 <span class="token operator">+</span> sum<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v1 <span class="token operator">&gt;&gt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">+</span> k1<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>sum <span class="token operator">+</span> <span class="token punctuation">(</span>num_rounds <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">-</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
sum <span class="token operator">-=</span> DELTA<span class="token punctuation">;</span>  
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="3"><li>åœ¨æœ€åèµ‹å€¼æ—¶ï¼Œæ·»åŠ å¯é€†è¿ç®—ï¼š</li></ol><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> v0 <span class="token operator">^</span> <span class="token number">0x12</span><span class="token punctuation">;</span> v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> v1 <span class="token operator">^</span> <span class="token number">0x34</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></blockquote><hr><h2 id="IDA-ç¤ºä¾‹-2"><a href="#IDA-ç¤ºä¾‹-2" class="headerlink" title="IDA ç¤ºä¾‹"></a>IDA ç¤ºä¾‹</h2><pre class="line-numbers language-c" data-language="c"><code class="language-c">__int64 __fastcall <span class="token function">tea_encrypt</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> a1<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token operator">*</span>a2<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token operator">*</span>a3<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  __int64 result<span class="token punctuation">;</span> <span class="token comment">// rax</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v4<span class="token punctuation">;</span> <span class="token comment">// [rsp+18h] [rbp-20h]</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v5<span class="token punctuation">;</span> <span class="token comment">// [rsp+1Ch] [rbp-1Ch]</span>
  <span class="token keyword">int</span> v6<span class="token punctuation">;</span> <span class="token comment">// [rsp+20h] [rbp-18h]</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment">// [rsp+24h] [rbp-14h]</span>

  v4 <span class="token operator">=</span> <span class="token operator">*</span>a2<span class="token punctuation">;</span>
  v5 <span class="token operator">=</span> a2<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  v6 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> a1 <span class="token operator">&gt;</span> i<span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    v6 <span class="token operator">-=</span> <span class="token number">1640531527</span><span class="token punctuation">;</span>   <span class="token comment">// å³ï¼š0x61C88647</span>
    v4 <span class="token operator">+=</span> <span class="token punctuation">(</span>v5 <span class="token operator">+</span> v6<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token number">16</span> <span class="token operator">*</span> v5 <span class="token operator">+</span> <span class="token operator">*</span>a3<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v5 <span class="token operator">&gt;&gt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">+</span> a3<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    v5 <span class="token operator">+=</span> <span class="token punctuation">(</span>v4 <span class="token operator">+</span> v6<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token number">16</span> <span class="token operator">*</span> v4 <span class="token operator">+</span> a3<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v4 <span class="token operator">&gt;&gt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">+</span> a3<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token operator">*</span>a2 <span class="token operator">=</span> v4<span class="token punctuation">;</span>
  result <span class="token operator">=</span> v5<span class="token punctuation">;</span>
  a2<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> v5<span class="token punctuation">;</span>
  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h1 id="XTEA"><a href="#XTEA" class="headerlink" title="XTEA"></a>XTEA</h1><blockquote><p>ç”±äº TEA ç®—æ³•è¢«å‘ç°å­˜åœ¨ç¼ºé™·ï¼Œä½œä¸ºå›åº”ï¼Œè®¾è®¡è€…æå‡ºäº†ä¸€ä¸ª TEA çš„å‡çº§ç‰ˆæœ¬â€”â€”XTEA</p><p>XTEA æ˜¯ TEA çš„æ‰©å±•ï¼Œä¹Ÿç§°åš TEANï¼Œå®ƒä½¿ç”¨ä¸ TEA ç›¸åŒçš„ç®€å•è¿ç®—ï¼ŒåŒæ ·æ˜¯ä¸€ä¸ª 64 ä½å—çš„ Feistel å¯†ç ï¼Œä½¿ç”¨ 128 ä½å¯†é’¥ï¼Œå»ºè®® 64 è½®ï¼Œä½†å››ä¸ªå­å¯†é’¥é‡‡å–ä¸æ­£è§„çš„æ–¹å¼è¿›è¡Œæ··åˆä»¥é˜»æ­¢å¯†é’¥è¡¨æ”»å‡»</p></blockquote><h2 id="ç‰¹ç‚¹-3"><a href="#ç‰¹ç‚¹-3" class="headerlink" title="ç‰¹ç‚¹"></a>ç‰¹ç‚¹</h2><ol><li><p>åŸºæœ¬ä¸Š TEA çš„åŠ å¯†ç‰¹ç‚¹ XTEA ä¹Ÿéƒ½æœ‰ï¼Œä¾‹å¦‚ï¼šå­˜åœ¨ DELTA å€¼</p></li><li><p>åŒæ ·ï¼Œæ¶‰åŠåˆ°çš„ç§»ä½æ“ä½œé€šå¸¸æ˜¯å·¦ç§» 4 ä½ã€å³ç§» 5 ä½ï¼›ä¸åŒçš„æ˜¯ï¼Œå¯¹äº <code>sum</code> çš„ç´¯åŠ æˆ–ç´¯å‡æ“ä½œä½äº <code>v0</code>ã€<code>v1</code> ä¸¤ä¸ªæ•°æ®å¤„ç†ä¹‹é—´</p></li><li><p><mark>ä¸ TEA ä¸åŒçš„æ˜¯ï¼Œåœ¨ XTEA ä¸­å¯†é’¥ key çš„ä¸‹æ ‡æ˜¯é€šè¿‡è®¡ç®—å¾—æ¥çš„</mark>ï¼Œåˆ†åˆ«æ˜¯ <code>key[sum &amp; 3]</code> å’Œ <code>key[(sum &gt;&gt; 11) &amp; 3]</code></p></li></ol><hr><h2 id="åŸç†-3"><a href="#åŸç†-3" class="headerlink" title="åŸç†"></a>åŸç†</h2><p>ä¸ TEA çš„æ€æƒ³åŸºæœ¬ç±»ä¼¼ï¼Œå¯¹äºå¯†é’¥ key çš„å–æ³•ä¸ TEA æœ‰æ‰€ä¸åŒ</p><p>åŠ å¯†æµç¨‹å¦‚å›¾ï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blog-markdown-1317553172.cos.ap-nanjing.myqcloud.com/%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95%E7%9A%84%E5%87%BD%E6%95%B0%E7%89%B9%E5%BE%814.png" alt="åŠ å¯†ç®—æ³•çš„å‡½æ•°ç‰¹å¾4.png"></p><hr><h2 id="åŠ è§£å¯†ä»£ç -3"><a href="#åŠ è§£å¯†ä»£ç -3" class="headerlink" title="åŠ è§£å¯†ä»£ç "></a>åŠ è§£å¯†ä»£ç </h2><h3 id="C-ç‰ˆ-1"><a href="#C-ç‰ˆ-1" class="headerlink" title="C++ ç‰ˆ"></a>C++ ç‰ˆ</h3><ul><li><p><strong>ç‰¹ç‚¹</strong></p><ol><li>åŒ…å«å…·ä½“å®ç°æµç¨‹</li><li>æ”¯æŒå¿«é€Ÿä¿®æ”¹åŠ å¯†è½®æ•° <code>num_rounds</code> å’Œ <code>delta</code> çš„å€¼</li></ol></li><li><p><strong>ä»£ç </strong></p></li></ul><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span>  </span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdint.h&gt;</span>  </span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">DELTA</span> <span class="token expression"><span class="token number">0x9e3779b9</span>   </span><span class="token comment">// DELTAå€¼  </span></span>


<span class="token comment">//åŠ å¯†å‡½æ•°</span>
<span class="token keyword">void</span> <span class="token function">xtea_encrypt</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> num_rounds<span class="token punctuation">,</span> <span class="token class-name">uint32_t</span><span class="token operator">*</span> v<span class="token punctuation">,</span> <span class="token class-name">uint32_t</span><span class="token operator">*</span> key<span class="token punctuation">)</span> 
<span class="token punctuation">{</span>  
    <span class="token class-name">uint32_t</span> v0 <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> v1 <span class="token operator">=</span>v <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  
    <span class="token class-name">uint32_t</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> num_rounds<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        v0 <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>v1 <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>v1 <span class="token operator">&gt;&gt;</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> v1<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>sum <span class="token operator">+</span> key<span class="token punctuation">[</span>sum <span class="token operator">&amp;</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        sum <span class="token operator">+=</span> DELTA<span class="token punctuation">;</span>  
        v1 <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>v0 <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>v0 <span class="token operator">&gt;&gt;</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> v0<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>sum <span class="token operator">+</span> key<span class="token punctuation">[</span><span class="token punctuation">(</span>sum <span class="token operator">&gt;&gt;</span> <span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
    v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> v0<span class="token punctuation">;</span> v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> v1<span class="token punctuation">;</span>  
<span class="token punctuation">}</span>  


<span class="token comment">//è§£å¯†å‡½æ•°</span>
<span class="token keyword">void</span> <span class="token function">xtea_decrypt</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> num_rounds<span class="token punctuation">,</span> <span class="token class-name">uint32_t</span><span class="token operator">*</span> v<span class="token punctuation">,</span> <span class="token class-name">uint32_t</span><span class="token operator">*</span> key<span class="token punctuation">)</span> 
<span class="token punctuation">{</span>  
    <span class="token class-name">uint32_t</span> v0 <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> v1 <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  
    <span class="token class-name">uint32_t</span> sum <span class="token operator">=</span> DELTA <span class="token operator">*</span> num_rounds<span class="token punctuation">;</span>  
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> num_rounds<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        v1 <span class="token operator">-=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>v0 <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>v0 <span class="token operator">&gt;&gt;</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> v0<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>sum <span class="token operator">+</span> key<span class="token punctuation">[</span><span class="token punctuation">(</span>sum <span class="token operator">&gt;&gt;</span> <span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        sum <span class="token operator">-=</span> DELTA<span class="token punctuation">;</span>  
        v0 <span class="token operator">-=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>v1 <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>v1 <span class="token operator">&gt;&gt;</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> v1<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>sum <span class="token operator">+</span> key<span class="token punctuation">[</span>sum <span class="token operator">&amp;</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
    v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> v0<span class="token punctuation">;</span> v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> v1<span class="token punctuation">;</span>  
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><strong>ç¤ºä¾‹ä¸€</strong></li></ul><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  
<span class="token punctuation">{</span>  
    <span class="token keyword">uint32_t</span> data<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span>  
            <span class="token number">0x168F8672</span><span class="token punctuation">,</span> <span class="token number">0x02DBD824</span><span class="token punctuation">,</span> <span class="token number">0xCF647FCA</span><span class="token punctuation">,</span> <span class="token number">0xE6EFA7EF</span><span class="token punctuation">,</span> <span class="token number">0x4AE016F0</span><span class="token punctuation">,</span> <span class="token number">0xC5832E1D</span><span class="token punctuation">,</span> <span class="token number">0x455C0A05</span><span class="token punctuation">,</span> <span class="token number">0xFFEB8140</span><span class="token punctuation">,</span>  
            <span class="token number">0xBE9561EF</span><span class="token punctuation">,</span> <span class="token number">0x7F819E23</span><span class="token punctuation">,</span> <span class="token number">0x3BC04269</span><span class="token punctuation">,</span> <span class="token number">0xC68B825B</span><span class="token punctuation">,</span> <span class="token number">0xE6A5B1F0</span><span class="token punctuation">,</span> <span class="token number">0xBD03CBBD</span><span class="token punctuation">,</span> <span class="token number">0xA9B3CE0E</span><span class="token punctuation">,</span> <span class="token number">0x6C85E6E7</span><span class="token punctuation">,</span>  
            <span class="token number">0x9F5C71EF</span><span class="token punctuation">,</span> <span class="token number">0x3BE4BD57</span>  
    <span class="token punctuation">}</span><span class="token punctuation">;</span>  
    <span class="token keyword">uint32_t</span> key<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0xDEADBEEF</span><span class="token punctuation">,</span> <span class="token number">0x87654321</span><span class="token punctuation">,</span> <span class="token number">0xFACEB00C</span><span class="token punctuation">,</span> <span class="token number">0xCAFEBABE</span><span class="token punctuation">}</span><span class="token punctuation">;</span>  
    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> r <span class="token operator">=</span> <span class="token number">32</span><span class="token punctuation">;</span>   <span class="token comment">// è½®æ•°  </span>
    <span class="token keyword">int</span> data_len <span class="token operator">=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// data çš„é•¿åº¦  </span>
  
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"è§£å¯†åï¼š"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> data_len<span class="token punctuation">;</span> i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token comment">// 2 ä¸ª 4 å­—èŠ‚ä¸ºä¸€ç»„  </span>
        <span class="token function">xtea_decrypt</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> <span class="token operator">&amp;</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// è¿™ç§æ–¹å¼è¾“å‡ºæ— éœ€è½¬æ¢å°ç«¯åº  </span>
    <span class="token punctuation">}</span>  
  
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"åŠ å¯†åï¼š"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> data_len<span class="token punctuation">;</span> i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token comment">// 2 ä¸ª 4 å­—èŠ‚ä¸ºä¸€ç»„  </span>
        <span class="token function">xtea_encrypt</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> <span class="token operator">&amp;</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
  
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span>

<span class="token comment">/* è¾“å‡ºï¼š
è§£å¯†åï¼šDASCTF{Don't_forget_to_drink_tea}
åŠ å¯†åï¼š(ä¹±ç )
*/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><strong>ç¤ºä¾‹äºŒ</strong></li></ul><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;cstring&gt;</span>  </span>
  
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">char</span> data<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"DASCTF{Don't_forget_to_drink_tea}"</span><span class="token punctuation">;</span>
    <span class="token keyword">uint32_t</span> key<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0x11111111</span><span class="token punctuation">,</span> <span class="token number">0x22222222</span><span class="token punctuation">,</span> <span class="token number">0x33333333</span><span class="token punctuation">,</span> <span class="token number">0x44444444</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> r <span class="token operator">=</span> <span class="token number">32</span><span class="token punctuation">;</span>  <span class="token comment">// è½®æ•°</span>
    <span class="token keyword">int</span> data_len <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// data çš„é•¿åº¦</span>

    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"åŠ å¯†åï¼š\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> data_len<span class="token punctuation">;</span> i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">)</span>   <span class="token comment">// 8 å­—èŠ‚ä¸ºä¸€ç»„</span>
        <span class="token function">xtea_encrypt</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">uint32_t</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s\n"</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"è§£å¯†åï¼š\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> data_len<span class="token punctuation">;</span> i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">)</span>   <span class="token comment">// 8 å­—èŠ‚ä¸ºä¸€ç»„</span>
        <span class="token function">xtea_decrypt</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">uint32_t</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s\n"</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* è¾“å‡ºï¼š
åŠ å¯†åï¼š(ä¹±ç )
è§£å¯†åï¼šDASCTF{Don't_forget_to_drink_tea}
*/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="IDA-ç¤ºä¾‹-3"><a href="#IDA-ç¤ºä¾‹-3" class="headerlink" title="IDA ç¤ºä¾‹"></a>IDA ç¤ºä¾‹</h2><pre class="line-numbers language-c" data-language="c"><code class="language-c">__int64 __fastcall <span class="token function">encode</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> a1<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token operator">*</span>a2<span class="token punctuation">,</span> __int64 a3<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  __int64 v3<span class="token punctuation">;</span> <span class="token comment">// r11</span>
  __int64 result<span class="token punctuation">;</span> <span class="token comment">// rax</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v5<span class="token punctuation">;</span> <span class="token comment">// [rsp+8h] [rbp-28h]</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v6<span class="token punctuation">;</span> <span class="token comment">// [rsp+Ch] [rbp-24h]</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v7<span class="token punctuation">;</span> <span class="token comment">// [rsp+10h] [rbp-20h]</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment">// [rsp+14h] [rbp-1Ch]</span>

  v7 <span class="token operator">=</span> <span class="token operator">*</span>a2<span class="token punctuation">;</span>
  v6 <span class="token operator">=</span> a2<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  v5 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>   <span class="token comment">// åˆå§‹ sum ä¸º 0</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> a1<span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span>   <span class="token comment">// a1 ä¸ºè¿­ä»£è½®æ•°</span>
  <span class="token punctuation">{</span>
    v7 <span class="token operator">+=</span> <span class="token operator">~</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>a3 <span class="token operator">+</span> <span class="token number">4LL</span> <span class="token operator">*</span> <span class="token operator">~</span><span class="token punctuation">(</span><span class="token operator">~</span>v5 <span class="token operator">|</span> <span class="token number">0xFFFFFFFC</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> v5<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>v6 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token operator">~</span><span class="token punctuation">(</span>v6 <span class="token operator">&gt;&gt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span><span class="token number">16</span> <span class="token operator">*</span> v6<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token operator">~</span><span class="token punctuation">(</span><span class="token number">16</span> <span class="token operator">*</span> v6<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>v6 <span class="token operator">&gt;&gt;</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token operator">~</span><span class="token punctuation">(</span>v6 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token operator">~</span><span class="token punctuation">(</span>v6 <span class="token operator">&gt;&gt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span><span class="token number">16</span> <span class="token operator">*</span> v6<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token operator">~</span><span class="token punctuation">(</span><span class="token number">16</span> <span class="token operator">*</span> v6<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>v6 <span class="token operator">&gt;&gt;</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>a3 <span class="token operator">+</span> <span class="token number">4LL</span> <span class="token operator">*</span> <span class="token operator">~</span><span class="token punctuation">(</span><span class="token operator">~</span>v5 <span class="token operator">|</span> <span class="token number">0xFFFFFFFC</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> v5<span class="token punctuation">)</span><span class="token punctuation">;</span>
    v5 <span class="token operator">-=</span> <span class="token number">1640531527</span><span class="token punctuation">;</span>   <span class="token comment">// å³ï¼š0x61C88647</span>
    v3 <span class="token operator">=</span> <span class="token punctuation">(</span>v5 <span class="token operator">&gt;&gt;</span> <span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v5 <span class="token operator">&gt;&gt;</span> <span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">0xFFFFFFFC</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    v6 <span class="token operator">+=</span> <span class="token operator">~</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>a3 <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">*</span> v3<span class="token punctuation">)</span> <span class="token operator">+</span> v5<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>v7 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token operator">~</span><span class="token punctuation">(</span>v7 <span class="token operator">&gt;&gt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span><span class="token number">16</span> <span class="token operator">*</span> v7<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token operator">~</span><span class="token punctuation">(</span><span class="token number">16</span> <span class="token operator">*</span> v7<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>v7 <span class="token operator">&gt;&gt;</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token operator">~</span><span class="token punctuation">(</span>v7 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token operator">~</span><span class="token punctuation">(</span>v7 <span class="token operator">&gt;&gt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span><span class="token number">16</span> <span class="token operator">*</span> v7<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token operator">~</span><span class="token punctuation">(</span><span class="token number">16</span> <span class="token operator">*</span> v7<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>v7 <span class="token operator">&gt;&gt;</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>a3 <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">*</span> v3<span class="token punctuation">)</span> <span class="token operator">+</span> v5<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token operator">*</span>a2 <span class="token operator">=</span> v7<span class="token punctuation">;</span>   <span class="token comment">// å°†åŠ å¯†åçš„ç»“æœå†™å›åŸæ•°ç»„</span>
  result <span class="token operator">=</span> v6<span class="token punctuation">;</span>
  a2<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> v6<span class="token punctuation">;</span>   <span class="token comment">// å°†åŠ å¯†åçš„ç»“æœå†™å›åŸæ•°ç»„</span>
  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h1 id="XXTEA"><a href="#XXTEA" class="headerlink" title="XXTEA"></a>XXTEA</h1><blockquote><p>XXTEAï¼Œåˆç§° Corrected Block TEAï¼Œæ˜¯ XTEA çš„å‡çº§ç‰ˆ ï¼Œæ”¯æŒå—åŠ å¯†ï¼Œè®¾è®¡è€…æ˜¯ Roger Needhamã€David Wheelerï¼Œç”±äºå…¶ä»£ç å®ç°éå¸¸ç®€å•ï¼Œè¿ç®—ä¹Ÿæ˜¯ç”±å¼‚æˆ–ç­‰åŸºæœ¬æ“ä½œç»„æˆçš„ï¼Œå› æ­¤éå¸¸é€‚åˆè®¡ç®—å’Œå­˜å‚¨èƒ½åŠ›åƒç´§çš„è®¾å¤‡ä¸­ä½¿ç”¨</p><p>XXTEA æ˜¯ä¸€ä¸ªéå¹³è¡¡ Feistel ç½‘ç»œåˆ†ç»„å¯†ç ï¼Œåœ¨å¯å˜é•¿åº¦å—ä¸Šè¿è¡Œï¼Œè¿™äº›å—æ˜¯ 32 ä½å¤§å°çš„ä»»æ„å€æ•°ï¼ˆæœ€å° 64 ä½ï¼‰ï¼Œä½¿ç”¨ 128 ä½å¯†é’¥ï¼Œæ˜¯ç›®å‰ TEA ç³»åˆ—ä¸­æœ€å®‰å…¨çš„ç®—æ³•ï¼Œä½†æ€§èƒ½è¾ƒä¸Šä¸¤ç§æœ‰æ‰€é™ä½</p></blockquote><h2 id="ç‰¹ç‚¹-4"><a href="#ç‰¹ç‚¹-4" class="headerlink" title="ç‰¹ç‚¹"></a>ç‰¹ç‚¹</h2><ol><li><p>åˆ†ç»„é•¿åº¦å¯å˜ï¼Œæ˜¯ä»»æ„ 32 bit ä¸ºæ­¥é•¿é€’å¢ï¼Œæœ€å°‘ 64 bit çš„äºŒè¿›åˆ¶å­—ç¬¦ä¸²</p></li><li><p>å¯†é’¥é•¿åº¦ä»ç„¶ä¸º 128 ä½</p></li><li><p><mark>åŠ å¯†è½®æ•°å¯å˜ï¼Œå–å†³äºåˆ†ç»„é•¿åº¦</mark>ï¼Œåˆ†ç»„è¶Šé•¿è½®æ•°è¶Šå°‘ï¼ˆæœ€ä½ 6 è½®ï¼‰ï¼Œåˆ†ç»„è¶ŠçŸ­è½®æ•°è¶Šå¤šï¼ˆæœ€å¤š 32 ä¸ªå®Œæ•´è½®æ•°ï¼‰ï¼Œ<code>åŠ å¯†è½®æ•° = æ˜æ–‡æ€»å­—èŠ‚æ•° / 8</code></p></li><li><p>å­˜åœ¨ DELTA å€¼</p></li></ol><hr><h2 id="åŸç†-4"><a href="#åŸç†-4" class="headerlink" title="åŸç†"></a>åŸç†</h2><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blog-markdown-1317553172.cos.ap-nanjing.myqcloud.com/%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95%E7%9A%84%E5%87%BD%E6%95%B0%E7%89%B9%E5%BE%815.png" alt="åŠ å¯†ç®—æ³•çš„å‡½æ•°ç‰¹å¾5.png"></p><hr><h2 id="åŠ è§£å¯†ä»£ç -4"><a href="#åŠ è§£å¯†ä»£ç -4" class="headerlink" title="åŠ è§£å¯†ä»£ç "></a>åŠ è§£å¯†ä»£ç </h2><h3 id="C-ç‰ˆ-2"><a href="#C-ç‰ˆ-2" class="headerlink" title="C++ ç‰ˆ"></a>C++ ç‰ˆ</h3><ul><li><p><strong>ç‰¹ç‚¹</strong></p><ol><li>åŒ…å«å…·ä½“å®ç°æµç¨‹</li><li>æ”¯æŒå¿«é€Ÿä¿®æ”¹ <code>delta</code> çš„å€¼</li></ol></li><li><p><strong>ä»£ç </strong></p></li></ul><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdint.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">DELTA</span> <span class="token expression"><span class="token number">0x9e3779b9</span>   </span><span class="token comment">// DELTAå€¼</span></span>


<span class="token comment">//åŠ å¯†å‡½æ•°</span>
<span class="token keyword">void</span> <span class="token function">xxtea_encrypt</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> num_rounds<span class="token punctuation">,</span> <span class="token keyword">uint32_t</span><span class="token operator">*</span> v<span class="token punctuation">,</span> <span class="token keyword">uint32_t</span><span class="token operator">*</span> key<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">uint32_t</span> y<span class="token punctuation">,</span> z<span class="token punctuation">,</span> sum<span class="token punctuation">;</span>
    <span class="token keyword">uint32_t</span> p<span class="token punctuation">,</span> rounds<span class="token punctuation">,</span> e<span class="token punctuation">;</span>

    rounds <span class="token operator">=</span> <span class="token number">6</span> <span class="token operator">+</span> <span class="token number">52</span> <span class="token operator">/</span> num_rounds<span class="token punctuation">;</span>
    sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    z <span class="token operator">=</span> v<span class="token punctuation">[</span>num_rounds <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">do</span>
    <span class="token punctuation">{</span>
        sum <span class="token operator">+=</span> DELTA<span class="token punctuation">;</span>
        e <span class="token operator">=</span> <span class="token punctuation">(</span>sum <span class="token operator">&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">3</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>p <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> p <span class="token operator">&lt;</span> num_rounds <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> p<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            y <span class="token operator">=</span> v<span class="token punctuation">[</span>p <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            z <span class="token operator">=</span> v<span class="token punctuation">[</span>p<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>z <span class="token operator">&gt;&gt;</span> <span class="token number">5</span> <span class="token operator">^</span> y <span class="token operator">&lt;&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>y <span class="token operator">&gt;&gt;</span> <span class="token number">3</span> <span class="token operator">^</span> z <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>sum <span class="token operator">^</span> y<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>key<span class="token punctuation">[</span><span class="token punctuation">(</span>p <span class="token operator">&amp;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">^</span> e<span class="token punctuation">]</span> <span class="token operator">^</span> z<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        y <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        z <span class="token operator">=</span> v<span class="token punctuation">[</span>num_rounds <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>z <span class="token operator">&gt;&gt;</span> <span class="token number">5</span> <span class="token operator">^</span> y <span class="token operator">&lt;&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>y <span class="token operator">&gt;&gt;</span> <span class="token number">3</span> <span class="token operator">^</span> z <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>sum <span class="token operator">^</span> y<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>key<span class="token punctuation">[</span><span class="token punctuation">(</span>p <span class="token operator">&amp;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">^</span> e<span class="token punctuation">]</span> <span class="token operator">^</span> z<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">--</span>rounds<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token comment">//è§£å¯†å‡½æ•°</span>
<span class="token keyword">void</span> <span class="token function">xxtea_decrypt</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> num_rounds<span class="token punctuation">,</span> <span class="token keyword">uint32_t</span><span class="token operator">*</span> v<span class="token punctuation">,</span> <span class="token keyword">uint32_t</span><span class="token operator">*</span> key<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">uint32_t</span> y<span class="token punctuation">,</span> z<span class="token punctuation">,</span> sum<span class="token punctuation">;</span>
    <span class="token keyword">uint32_t</span> p<span class="token punctuation">,</span> rounds<span class="token punctuation">,</span> e<span class="token punctuation">;</span>

    rounds <span class="token operator">=</span> <span class="token number">6</span> <span class="token operator">+</span> <span class="token number">52</span> <span class="token operator">/</span> num_rounds<span class="token punctuation">;</span>
    sum <span class="token operator">=</span> rounds <span class="token operator">*</span> DELTA<span class="token punctuation">;</span>
    y <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">do</span>
    <span class="token punctuation">{</span>
        e <span class="token operator">=</span> <span class="token punctuation">(</span>sum <span class="token operator">&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">3</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>p <span class="token operator">=</span> num_rounds <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> p <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">;</span> p<span class="token operator">--</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            z <span class="token operator">=</span> v<span class="token punctuation">[</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            y <span class="token operator">=</span> v<span class="token punctuation">[</span>p<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>z <span class="token operator">&gt;&gt;</span> <span class="token number">5</span> <span class="token operator">^</span> y <span class="token operator">&lt;&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>y <span class="token operator">&gt;&gt;</span> <span class="token number">3</span> <span class="token operator">^</span> z <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>sum <span class="token operator">^</span> y<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>key<span class="token punctuation">[</span><span class="token punctuation">(</span>p <span class="token operator">&amp;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">^</span> e<span class="token punctuation">]</span> <span class="token operator">^</span> z<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        z <span class="token operator">=</span> v<span class="token punctuation">[</span>num_rounds <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        y <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>z <span class="token operator">&gt;&gt;</span> <span class="token number">5</span> <span class="token operator">^</span> y <span class="token operator">&lt;&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>y <span class="token operator">&gt;&gt;</span> <span class="token number">3</span> <span class="token operator">^</span> z <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>sum <span class="token operator">^</span> y<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>key<span class="token punctuation">[</span><span class="token punctuation">(</span>p <span class="token operator">&amp;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">^</span> e<span class="token punctuation">]</span> <span class="token operator">^</span> z<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        sum <span class="token operator">-=</span> DELTA<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">--</span>rounds<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><strong>ç¤ºä¾‹ä¸€</strong></li></ul><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">uint32_t</span> data<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0xDEADBEEF</span><span class="token punctuation">,</span> <span class="token number">0xFACEB00C</span><span class="token punctuation">,</span> <span class="token number">0xDAC0FFEE</span><span class="token punctuation">,</span> <span class="token number">0xABADBABE</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">uint32_t</span> key<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0x11111111</span><span class="token punctuation">,</span> <span class="token number">0x22222222</span><span class="token punctuation">,</span> <span class="token number">0x33333333</span><span class="token punctuation">,</span> <span class="token number">0x44444444</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> data_len <span class="token operator">=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// data çš„é•¿åº¦</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> r <span class="token operator">=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">8</span><span class="token punctuation">;</span>   <span class="token comment">// è½®æ•°</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> data_len<span class="token punctuation">;</span> i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span>   <span class="token comment">// 2 ä¸ª 4 å­—èŠ‚ä¸ºä¸€ç»„</span>
        <span class="token function">xxtea_encrypt</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> <span class="token operator">&amp;</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"åŠ å¯†åï¼š0x%x 0x%x 0x%x 0x%x\n"</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> data_len<span class="token punctuation">;</span> i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span>   <span class="token comment">// 2 ä¸ª 4 å­—èŠ‚ä¸ºä¸€ç»„</span>
        <span class="token function">xxtea_decrypt</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> <span class="token operator">&amp;</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"è§£å¯†åï¼š0x%x 0x%x 0x%x 0x%x\n"</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* è¾“å‡ºï¼š
åŠ å¯†åï¼š0xf1560f7a 0x17cf17fa 0xf69c6e0c 0x3d09333e
è§£å¯†åï¼š0xdeadbeef 0xfaceb00c 0xdac0ffee 0xabadbabe
*/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  
<span class="token punctuation">{</span>  
    <span class="token keyword">uint32_t</span> data<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0xDEADBEEF</span><span class="token punctuation">,</span> <span class="token number">0xFACEB00C</span><span class="token punctuation">,</span> <span class="token number">0xDAC0FFEE</span><span class="token punctuation">,</span> <span class="token number">0xABADBABE</span><span class="token punctuation">}</span><span class="token punctuation">;</span>  
    <span class="token keyword">uint32_t</span> key<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0x11111111</span><span class="token punctuation">,</span> <span class="token number">0x22222222</span><span class="token punctuation">,</span> <span class="token number">0x33333333</span><span class="token punctuation">,</span> <span class="token number">0x44444444</span><span class="token punctuation">}</span><span class="token punctuation">;</span>  
    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> r <span class="token operator">=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">8</span><span class="token punctuation">;</span>   <span class="token comment">// è½®æ•°  </span>
  
	<span class="token comment">// åŠ å¯†  </span>
	<span class="token function">xxtea_encrypt</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> data<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>    
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"åŠ å¯†åï¼š0x%x 0x%x 0x%x 0x%x\n"</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"åŠ å¯†åï¼š%s\n"</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>    
	  
	<span class="token comment">// è§£å¯†  </span>
	<span class="token function">xxtea_decrypt</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> data<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>    
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"è§£å¯†åï¼š0x%x 0x%x 0x%x 0x%x\n"</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"è§£å¯†åï¼š%s\n"</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span>  
  
<span class="token comment">/* è¾“å‡ºï¼š  
åŠ å¯†åï¼š0xf1560f7a 0x17cf17fa 0xdac0ffee 0xabadbabe  
åŠ å¯†åï¼š(ä¹±ç )
è§£å¯†åï¼š0xdeadbeef 0xfaceb00c 0xdac0ffee 0xabadbabe  
è§£å¯†åï¼š(ä¹±ç )
*/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><strong>ç¤ºä¾‹äºŒ</strong></li></ul><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;cstring&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">char</span> data<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"password123456789"</span><span class="token punctuation">;</span>
    <span class="token keyword">uint32_t</span> key<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0x11111111</span><span class="token punctuation">,</span> <span class="token number">0x22222222</span><span class="token punctuation">,</span> <span class="token number">0x33333333</span><span class="token punctuation">,</span> <span class="token number">0x44444444</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> data_len <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// data çš„é•¿åº¦</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> r <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">8</span><span class="token punctuation">;</span>   <span class="token comment">// è½®æ•°</span>

    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"åŠ å¯†åï¼š"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> data_len<span class="token punctuation">;</span> i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">)</span>   <span class="token comment">// 8 å­—èŠ‚ä¸ºä¸€ç»„</span>
        <span class="token function">xxtea_encrypt</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">uint32_t</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s\n"</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"è§£å¯†åï¼š"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> data_len<span class="token punctuation">;</span> i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">)</span>   <span class="token comment">// 8 å­—èŠ‚ä¸ºä¸€ç»„</span>
        <span class="token function">xxtea_decrypt</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">uint32_t</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s\n"</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* è¾“å‡ºï¼š
åŠ å¯†åï¼š(ä¹±ç )
è§£å¯†åï¼špassword123456789
*/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;cstring&gt;</span>    </span>
    
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    
<span class="token punctuation">{</span>    
    <span class="token keyword">char</span> data<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"password123456789"</span><span class="token punctuation">;</span>    
    <span class="token keyword">uint32_t</span> key<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0x11111111</span><span class="token punctuation">,</span> <span class="token number">0x22222222</span><span class="token punctuation">,</span> <span class="token number">0x33333333</span><span class="token punctuation">,</span> <span class="token number">0x44444444</span><span class="token punctuation">}</span><span class="token punctuation">;</span>      
    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> r <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">8</span><span class="token punctuation">;</span>   <span class="token comment">// è½®æ•°    </span>
      
    <span class="token function">xxtea_encrypt</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">uint32_t</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>data<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>    
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"åŠ å¯†åï¼š%s\n"</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>     
    
    <span class="token function">xxtea_decrypt</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">uint32_t</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>data<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>    
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"è§£å¯†åï¼š%s\n"</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>   
    
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    
<span class="token punctuation">}</span>  
  
<span class="token comment">/* è¾“å‡ºï¼š  
åŠ å¯†åï¼š(ä¹±ç )123456789  
è§£å¯†åï¼špassword123456789  
*/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="IDA-ç¤ºä¾‹-4"><a href="#IDA-ç¤ºä¾‹-4" class="headerlink" title="IDA ç¤ºä¾‹"></a>IDA ç¤ºä¾‹</h2><pre class="line-numbers language-c" data-language="c"><code class="language-c">__int64 __fastcall <span class="token function">xxtea_encrypt</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> a1<span class="token punctuation">,</span> _DWORD <span class="token operator">*</span>a2<span class="token punctuation">,</span> __int64 a3<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token operator">*</span>v3<span class="token punctuation">;</span> <span class="token comment">// rax</span>
  _DWORD <span class="token operator">*</span>v4<span class="token punctuation">;</span> <span class="token comment">// rax</span>
  __int64 result<span class="token punctuation">;</span> <span class="token comment">// rax</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v6<span class="token punctuation">;</span> <span class="token comment">// [rsp+20h] [rbp-18h]</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v7<span class="token punctuation">;</span> <span class="token comment">// [rsp+24h] [rbp-14h]</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment">// [rsp+28h] [rbp-10h]</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v9<span class="token punctuation">;</span> <span class="token comment">// [rsp+2Ch] [rbp-Ch]</span>
  <span class="token keyword">int</span> v10<span class="token punctuation">;</span> <span class="token comment">// [rsp+30h] [rbp-8h]</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v11<span class="token punctuation">;</span> <span class="token comment">// [rsp+34h] [rbp-4h]</span>

  v9 <span class="token operator">=</span> <span class="token number">0x34</span> <span class="token operator">/</span> a1 <span class="token operator">+</span> <span class="token number">6</span><span class="token punctuation">;</span>
  v7 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  v6 <span class="token operator">=</span> a2<span class="token punctuation">[</span>a1 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">do</span>
  <span class="token punctuation">{</span>
    v7 <span class="token operator">-=</span> <span class="token number">1640531527</span><span class="token punctuation">;</span>
    v10 <span class="token operator">=</span> <span class="token punctuation">(</span>v7 <span class="token operator">&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">3</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> a1 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      v11 <span class="token operator">=</span> a2<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      v3 <span class="token operator">=</span> <span class="token operator">&amp;</span>a2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token operator">*</span>v3 <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v11 <span class="token operator">^</span> v7<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>v6 <span class="token operator">^</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">4LL</span> <span class="token operator">*</span> <span class="token punctuation">(</span>v10 <span class="token operator">^</span> i <span class="token operator">&amp;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> a3<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">4</span> <span class="token operator">*</span> v11<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>v6 <span class="token operator">&gt;&gt;</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                                                                          <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v11 <span class="token operator">&gt;&gt;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token number">16</span> <span class="token operator">*</span> v6<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      v6 <span class="token operator">=</span> <span class="token operator">*</span>v3<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    v4 <span class="token operator">=</span> <span class="token operator">&amp;</span>a2<span class="token punctuation">[</span>a1 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token operator">*</span>v4 <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">*</span>a2 <span class="token operator">^</span> v7<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>v6 <span class="token operator">^</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">4LL</span> <span class="token operator">*</span> <span class="token punctuation">(</span>v10 <span class="token operator">^</span> i <span class="token operator">&amp;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> a3<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">4</span> <span class="token operator">*</span> <span class="token operator">*</span>a2<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>v6 <span class="token operator">&gt;&gt;</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                                                                        <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">*</span>a2 <span class="token operator">&gt;&gt;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token number">16</span> <span class="token operator">*</span> v6<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    result <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">*</span>v4<span class="token punctuation">;</span>
    v6 <span class="token operator">=</span> result<span class="token punctuation">;</span>
    <span class="token operator">--</span>v9<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span> v9 <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h1 id="MD5"><a href="#MD5" class="headerlink" title="MD5"></a>MD5</h1><blockquote><p>MD5ï¼ˆMessage Digest Algorithmï¼‰åˆå«æ¶ˆæ¯æ‘˜è¦ç®—æ³•ï¼Œæ˜¯å•å‘æ•£åˆ—ç®—æ³•ï¼ˆå“ˆå¸Œç®—æ³•ï¼‰çš„ä¸€ç§ï¼Œå…¶å¯¹è¾“å…¥çš„ä»»æ„é•¿åº¦çš„æ¶ˆæ¯è¿›è¡Œè¿ç®—ï¼Œäº§ç”Ÿä¸€ä¸ª 128 ä½çš„æ¶ˆæ¯æ‘˜è¦ï¼ˆè¯¥è¿‡ç¨‹é€šå¸¸ä¸å¯é€†ï¼‰</p><p>å°†äº§ç”Ÿçš„ 128 ä½æ¶ˆæ¯æ‘˜è¦ç”¨åå…­è¿›åˆ¶è¡¨ç¤ºï¼Œä¾¿æ˜¯å¸¸è§çš„ 32 å­—ç¬¦çš„ MD5 ç </p><p>è€Œæ‰€è°“çš„ 16 å­—ç¬¦çš„ MD5 ç ï¼Œå…¶å®æ˜¯è¿™ 32 å­—ç¬¦ä¸­é—´çš„ 16 ä¸ªå­—ç¬¦</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blog-markdown-1317553172.cos.ap-nanjing.myqcloud.com/%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95%E7%9A%84%E5%87%BD%E6%95%B0%E7%89%B9%E5%BE%817.png" alt="åŠ å¯†ç®—æ³•çš„å‡½æ•°ç‰¹å¾7.png"></p></blockquote><h2 id="ç‰¹ç‚¹-5"><a href="#ç‰¹ç‚¹-5" class="headerlink" title="ç‰¹ç‚¹"></a>ç‰¹ç‚¹</h2><ol><li>MD5 é€šå¸¸ä¼šå‡ºç°å››ä¸ªåˆå§‹åŒ–å¸¸é‡ï¼š</li></ol><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token number">0x67452301</span>   <span class="token comment">// 1732584193</span>
<span class="token number">0xEFCDAB89</span>   <span class="token comment">// -271733879</span>
<span class="token number">0x98BADCFE</span>   <span class="token comment">// -1732584194</span>
<span class="token number">0x10325476</span>   <span class="token comment">// 271733878</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨å†…å­˜ä¸­å°ç«¯åºå­˜æ”¾ä¸ºï¼š<code>01 23 45 67 89 AB CD EF FE DC BA 98 76 54 32 10</code></p><ol start="2"><li>é€šè¿‡ IDA æ’ä»¶ <code>Findcrypt</code> å¯ä»¥è¯†åˆ«å‡º MD5</li></ol><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blog-markdown-1317553172.cos.ap-nanjing.myqcloud.com/%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95%E7%9A%84%E5%87%BD%E6%95%B0%E7%89%B9%E5%BE%816.png" alt="åŠ å¯†ç®—æ³•çš„å‡½æ•°ç‰¹å¾6.png"></p><ol start="3"><li>MD5 çš„å®ç°é€šå¸¸åŒ…å«ä¸‰ä¸ªé˜¶æ®µï¼š<code>MD5_Init</code>ã€<code>MD5_Update</code>ã€<code>MD5_Final</code></li></ol><blockquote><p>å¯èƒ½çš„é­”æ”¹æ–¹å¼æœ‰ï¼š</p><ul><li>æ”¹å˜åˆå§‹åŒ–æ‰€ç”¨åˆ°çš„ 4 ä¸ªå¸¸æ•°</li><li>æ”¹å˜å¡«å……çš„æ–¹æ³•</li><li>æ”¹å˜å“ˆå¸Œå˜æ¢çš„å¤„ç†è¿‡ç¨‹</li></ul></blockquote><hr><h2 id="åŸç†-5"><a href="#åŸç†-5" class="headerlink" title="åŸç†"></a>åŸç†</h2><blockquote><p>è¿™é‡Œåªæä¸€äº›å…³é”®ç‰¹å¾ï¼Œè¯¦ç»†åŸç†è§å¦‚ä¸‹å‚è€ƒæ–‡çŒ®ï¼š</p><ol><li><a target="_blank" rel="noopener" href="https://blog.csdn.net/m1j2t3/article/details/6050587?spm=1001.2101.3001.6650.2&amp;utm_medium=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~Rate-2-6050587-blog-26388669.235%5Ev43%5Epc_blog_bottom_relevance_base3&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~Rate-2-6050587-blog-26388669.235%5Ev43%5Epc_blog_bottom_relevance_base3&amp;utm_relevant_index=3">MD5ç®—æ³•è¯¦è§£_md5 0x3f-CSDNåšå®¢</a></li><li><a target="_blank" rel="noopener" href="https://bbs.kanxue.com/thread-255756.htm#msg_header_h2_0">[åŸåˆ›]äº†è§£å¸¸ç”¨åŠ è§£å¯†ç®—æ³•å¹¶ç®€å•é€†å‘è¯†åˆ«-è½¯ä»¶é€†å‘-çœ‹é›ª-å®‰å…¨ç¤¾åŒº|å®‰å…¨æ‹›è˜|kanxue.com</a></li><li><a target="_blank" rel="noopener" href="https://www.52pojie.cn/thread-1217147-1-1.html">å­¦ç ´è§£ç¬¬115å¤©ï¼Œã€ŠC++ä¹‹MD5æ¶ˆæ¯æ‘˜è¦ç®—æ³•ã€‹å­¦ä¹  - ã€è„±å£³ç ´è§£åŒºã€ - å¾çˆ±ç ´è§£ - LCG - LSG |å®‰å“ç ´è§£|ç—…æ¯’åˆ†æ|www.52pojie.cn</a></li></ol></blockquote><ol><li>ä¸ºäº†åé¢å¡«å…… 64 ä½çš„é•¿åº¦ï¼Œéœ€è¦å…ˆå¡«å……æ¶ˆæ¯ä½¿å…¶é•¿åº¦ä¸ <code>448 mod 512</code> åŒä½™</li></ol><p>å¡«å……æ–¹æ³•ï¼šé™„ä¸€ä¸ª 1 åœ¨æ¶ˆæ¯åé¢ï¼Œç„¶åç”¨ 0 å¡«å……ï¼Œå¡«å……é•¿åº¦åœ¨ 0 ~ 512 ä¹‹é—´</p><ol start="2"><li>æœ€å¼€å§‹éœ€è¦ä½¿ç”¨ä¸‹é¢çš„æ•°ç»„è¿›è¡Œåˆå§‹åŒ–ï¼š</li></ol><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">{</span> <span class="token number">0x67452301</span><span class="token punctuation">,</span> <span class="token number">0xefcdab89</span><span class="token punctuation">,</span> <span class="token number">0x98badcfe</span><span class="token punctuation">,</span> <span class="token number">0x10325476</span> <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ol start="3"><li>ç„¶åè¿›è¡Œæ•°æ®å¤„ç†</li></ol><p>éœ€è¦ä½¿ç”¨å·¦ç§»æ•°ç»„ï¼Œå¯¹åº”æ¯è½®å¤„ç†çš„ <code>4 * 16 ï¼ 64</code> æ­¥ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">{</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">21</span> <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿˜éœ€è¦ç”¨åˆ° 64 ä¸ªå­˜æ”¾ 32 ä½å­—èŠ‚çš„åŠ æ³•å¸¸æ•°æ•°ç»„ï¼Œå¯¹åº”æ¯ç»„å¤„ç†çš„ <code>4 * 16 ï¼ 64</code> æ­¥ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">{</span> <span class="token number">0xd76aa478</span><span class="token punctuation">,</span> <span class="token number">0xe8c7b756</span><span class="token punctuation">,</span> <span class="token number">0x242070db</span><span class="token punctuation">,</span> <span class="token number">0xc1bdceee</span><span class="token punctuation">,</span> <span class="token number">0xf57c0faf</span><span class="token punctuation">,</span> <span class="token number">0x4787c62a</span><span class="token punctuation">,</span> <span class="token number">0xa8304613</span><span class="token punctuation">,</span> <span class="token number">0xfd469501</span><span class="token punctuation">,</span> <span class="token number">0x698098d8</span><span class="token punctuation">,</span> <span class="token number">0x8b44f7af</span><span class="token punctuation">,</span> <span class="token number">0xffff5bb1</span><span class="token punctuation">,</span> <span class="token number">0x895cd7be</span><span class="token punctuation">,</span> <span class="token number">0x6b901122</span><span class="token punctuation">,</span> <span class="token number">0xfd987193</span><span class="token punctuation">,</span> <span class="token number">0xa679438e</span><span class="token punctuation">,</span> <span class="token number">0x49b40821</span><span class="token punctuation">,</span> <span class="token number">0xf61e2562</span><span class="token punctuation">,</span> <span class="token number">0xc040b340</span><span class="token punctuation">,</span> <span class="token number">0x265e5a51</span><span class="token punctuation">,</span> <span class="token number">0xe9b6c7aa</span><span class="token punctuation">,</span> <span class="token number">0xd62f105d</span><span class="token punctuation">,</span> <span class="token number">0x02441453</span><span class="token punctuation">,</span> <span class="token number">0xd8a1e681</span><span class="token punctuation">,</span> <span class="token number">0xe7d3fbc8</span><span class="token punctuation">,</span> <span class="token number">0x21e1cde6</span><span class="token punctuation">,</span> <span class="token number">0xc33707d6</span><span class="token punctuation">,</span> <span class="token number">0xf4d50d87</span><span class="token punctuation">,</span> <span class="token number">0x455a14ed</span><span class="token punctuation">,</span> <span class="token number">0xa9e3e905</span><span class="token punctuation">,</span> <span class="token number">0xfcefa3f8</span><span class="token punctuation">,</span> <span class="token number">0x676f02d9</span><span class="token punctuation">,</span> <span class="token number">0x8d2a4c8a</span><span class="token punctuation">,</span> <span class="token number">0xfffa3942</span><span class="token punctuation">,</span> <span class="token number">0x8771f681</span><span class="token punctuation">,</span> <span class="token number">0x6d9d6122</span><span class="token punctuation">,</span> <span class="token number">0xfde5380c</span><span class="token punctuation">,</span> <span class="token number">0xa4beea44</span><span class="token punctuation">,</span> <span class="token number">0x4bdecfa9</span><span class="token punctuation">,</span> <span class="token number">0xf6bb4b60</span><span class="token punctuation">,</span> <span class="token number">0xbebfbc70</span><span class="token punctuation">,</span> <span class="token number">0x289b7ec6</span><span class="token punctuation">,</span> <span class="token number">0xeaa127fa</span><span class="token punctuation">,</span> <span class="token number">0xd4ef3085</span><span class="token punctuation">,</span> <span class="token number">0x04881d05</span><span class="token punctuation">,</span> <span class="token number">0xd9d4d039</span><span class="token punctuation">,</span> <span class="token number">0xe6db99e5</span><span class="token punctuation">,</span> <span class="token number">0x1fa27cf8</span><span class="token punctuation">,</span> <span class="token number">0xc4ac5665</span><span class="token punctuation">,</span> <span class="token number">0xf4292244</span><span class="token punctuation">,</span> <span class="token number">0x432aff97</span><span class="token punctuation">,</span> <span class="token number">0xab9423a7</span><span class="token punctuation">,</span> <span class="token number">0xfc93a039</span><span class="token punctuation">,</span> <span class="token number">0x655b59c3</span><span class="token punctuation">,</span> <span class="token number">0x8f0ccc92</span><span class="token punctuation">,</span> <span class="token number">0xffeff47d</span><span class="token punctuation">,</span> <span class="token number">0x85845dd1</span><span class="token punctuation">,</span> <span class="token number">0x6fa87e4f</span><span class="token punctuation">,</span> <span class="token number">0xfe2ce6e0</span><span class="token punctuation">,</span> <span class="token number">0xa3014314</span><span class="token punctuation">,</span> <span class="token number">0x4e0811a1</span><span class="token punctuation">,</span> <span class="token number">0xf7537e82</span><span class="token punctuation">,</span> <span class="token number">0xbd3af235</span><span class="token punctuation">,</span> <span class="token number">0x2ad7d2bb</span><span class="token punctuation">,</span> <span class="token number">0xeb86d391</span> <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™äº›æ•°å€¼ç”± <code>2 ^ 32 * (abs(sin(i)))</code> å¾—å‡ºï¼Œ<code>i</code> çš„å–å€¼èŒƒå›´åœ¨ 1 ~ 64 ï¼ˆ<strong>è¿™ä¸ªè¡¨çš„å­˜åœ¨æ˜¯åœ¨ IDA ä¸­ç¡®è®¤ MD5 ç®—æ³•çš„å…³é”®</strong>ï¼‰</p><p>æ¥ä¸‹æ¥æ˜¯ MD5 ç®—æ³•æœ€æ ¸å¿ƒçš„ç¯èŠ‚ï¼Œåœ¨è¿™é‡Œå¯¹æ¯ä¸€ç»„æ¶ˆæ¯è¿›è¡Œ 4 è½®ã€æ¯è½® 16 æ­¥ï¼Œæ€»è®¡ 64 æ­¥çš„å¤„ç†</p><p>ä»¥ä¸‹æ˜¯æ¯æ¬¡æ“ä½œä¸­ç”¨åˆ°çš„å››ä¸ªéçº¿æ€§å‡½æ•°ï¼ˆæ¯è½®ä¸€ä¸ªï¼‰:</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">// ç¬¬ä¸€è½®é€»è¾‘å‡½æ•°</span>
<span class="token function">F</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span>x <span class="token operator">&amp;</span> y<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>x<span class="token punctuation">)</span> <span class="token operator">&amp;</span> z<span class="token punctuation">)</span>
<span class="token comment">// ç¬¬äºŒè½®é€»è¾‘å‡½æ•°</span>
<span class="token function">G</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span>x <span class="token operator">&amp;</span> y<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>y <span class="token operator">&amp;</span> <span class="token punctuation">(</span><span class="token operator">~</span>z<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// ç¬¬ä¸‰è½®é€»è¾‘å‡½æ•°</span>
<span class="token function">H</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span>x <span class="token operator">^</span> y <span class="token operator">^</span> z<span class="token punctuation">)</span>
<span class="token comment">// ç¬¬å››è½®é€»è¾‘å‡½æ•°</span>
<span class="token function">I</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">)</span> <span class="token operator">=</span> x <span class="token operator">^</span> <span class="token punctuation">(</span>x <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token operator">~</span>z<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å®šä¹‰ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token function">FF</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> Mj<span class="token punctuation">,</span> s<span class="token punctuation">,</span> ti<span class="token punctuation">)</span> æ“ä½œä¸º a <span class="token operator">=</span> b <span class="token operator">+</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span>a <span class="token operator">+</span> <span class="token function">F</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">)</span> <span class="token operator">+</span> Mj <span class="token operator">+</span> ti<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> s<span class="token punctuation">)</span>  
<span class="token function">GG</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> Mj<span class="token punctuation">,</span> s<span class="token punctuation">,</span> ti<span class="token punctuation">)</span> æ“ä½œä¸º a <span class="token operator">=</span> b <span class="token operator">+</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span>a <span class="token operator">+</span> <span class="token function">G</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">)</span> <span class="token operator">+</span> Mj <span class="token operator">+</span> ti<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> s<span class="token punctuation">)</span>  
<span class="token function">HH</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> Mj<span class="token punctuation">,</span> s<span class="token punctuation">,</span> ti<span class="token punctuation">)</span> æ“ä½œä¸º a <span class="token operator">=</span> b <span class="token operator">+</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span>a <span class="token operator">+</span> <span class="token function">H</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">)</span> <span class="token operator">+</span> Mj <span class="token operator">+</span> ti<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> s<span class="token punctuation">)</span>  
<span class="token function">II</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> Mj<span class="token punctuation">,</span> s<span class="token punctuation">,</span> ti<span class="token punctuation">)</span> æ“ä½œä¸º a <span class="token operator">=</span> b <span class="token operator">+</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span>a <span class="token operator">+</span> <span class="token function">I</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">)</span> <span class="token operator">+</span> Mj <span class="token operator">+</span> ti<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> s<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œçš„ 4 è½®ã€æ¯è½® 16 æ­¥ï¼Œæ€»è®¡ 64 æ­¥çš„å¤„ç†è¿‡ç¨‹æ˜¯ï¼š</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">// ç¬¬ä¸€è½®  </span>
<span class="token function">FF</span><span class="token punctuation">(</span>a <span class="token punctuation">,</span>b <span class="token punctuation">,</span>c <span class="token punctuation">,</span>d <span class="token punctuation">,</span>M0 <span class="token punctuation">,</span><span class="token number">7</span> <span class="token punctuation">,</span><span class="token number">0xd76aa478</span> <span class="token punctuation">)</span>  
<span class="token function">FF</span><span class="token punctuation">(</span>d <span class="token punctuation">,</span>a <span class="token punctuation">,</span>b <span class="token punctuation">,</span>c <span class="token punctuation">,</span>M1 <span class="token punctuation">,</span><span class="token number">12</span> <span class="token punctuation">,</span><span class="token number">0xe8c7b756</span> <span class="token punctuation">)</span>  
<span class="token function">FF</span><span class="token punctuation">(</span>c <span class="token punctuation">,</span>d <span class="token punctuation">,</span>a <span class="token punctuation">,</span>b <span class="token punctuation">,</span>M2 <span class="token punctuation">,</span><span class="token number">17</span> <span class="token punctuation">,</span><span class="token number">0x242070db</span> <span class="token punctuation">)</span>  
<span class="token function">FF</span><span class="token punctuation">(</span>b <span class="token punctuation">,</span>c <span class="token punctuation">,</span>d <span class="token punctuation">,</span>a <span class="token punctuation">,</span>M3 <span class="token punctuation">,</span><span class="token number">22</span> <span class="token punctuation">,</span><span class="token number">0xc1bdceee</span> <span class="token punctuation">)</span>  
<span class="token function">FF</span><span class="token punctuation">(</span>a <span class="token punctuation">,</span>b <span class="token punctuation">,</span>c <span class="token punctuation">,</span>d <span class="token punctuation">,</span>M4 <span class="token punctuation">,</span><span class="token number">7</span> <span class="token punctuation">,</span><span class="token number">0xf57c0faf</span> <span class="token punctuation">)</span>  
<span class="token function">FF</span><span class="token punctuation">(</span>d <span class="token punctuation">,</span>a <span class="token punctuation">,</span>b <span class="token punctuation">,</span>c <span class="token punctuation">,</span>M5 <span class="token punctuation">,</span><span class="token number">12</span> <span class="token punctuation">,</span><span class="token number">0x4787c62a</span> <span class="token punctuation">)</span>  
<span class="token function">FF</span><span class="token punctuation">(</span>c <span class="token punctuation">,</span>d <span class="token punctuation">,</span>a <span class="token punctuation">,</span>b <span class="token punctuation">,</span>M6 <span class="token punctuation">,</span><span class="token number">17</span> <span class="token punctuation">,</span><span class="token number">0xa8304613</span> <span class="token punctuation">)</span>  
<span class="token function">FF</span><span class="token punctuation">(</span>b <span class="token punctuation">,</span>c <span class="token punctuation">,</span>d <span class="token punctuation">,</span>a <span class="token punctuation">,</span>M7 <span class="token punctuation">,</span><span class="token number">22</span> <span class="token punctuation">,</span><span class="token number">0xfd469501</span><span class="token punctuation">)</span>  
<span class="token function">FF</span><span class="token punctuation">(</span>a <span class="token punctuation">,</span>b <span class="token punctuation">,</span>c <span class="token punctuation">,</span>d <span class="token punctuation">,</span>M8 <span class="token punctuation">,</span><span class="token number">7</span> <span class="token punctuation">,</span><span class="token number">0x698098d8</span> <span class="token punctuation">)</span>  
<span class="token function">FF</span><span class="token punctuation">(</span>d <span class="token punctuation">,</span>a <span class="token punctuation">,</span>b <span class="token punctuation">,</span>c <span class="token punctuation">,</span>M9 <span class="token punctuation">,</span><span class="token number">12</span> <span class="token punctuation">,</span><span class="token number">0x8b44f7af</span> <span class="token punctuation">)</span>  
<span class="token function">FF</span><span class="token punctuation">(</span>c <span class="token punctuation">,</span>d <span class="token punctuation">,</span>a <span class="token punctuation">,</span>b <span class="token punctuation">,</span>M10 <span class="token punctuation">,</span><span class="token number">17</span> <span class="token punctuation">,</span><span class="token number">0xffff5bb1</span> <span class="token punctuation">)</span>  
<span class="token function">FF</span><span class="token punctuation">(</span>b <span class="token punctuation">,</span>c <span class="token punctuation">,</span>d <span class="token punctuation">,</span>a <span class="token punctuation">,</span>M11 <span class="token punctuation">,</span><span class="token number">22</span> <span class="token punctuation">,</span><span class="token number">0x895cd7be</span> <span class="token punctuation">)</span>  
<span class="token function">FF</span><span class="token punctuation">(</span>a <span class="token punctuation">,</span>b <span class="token punctuation">,</span>c <span class="token punctuation">,</span>d <span class="token punctuation">,</span>M12 <span class="token punctuation">,</span><span class="token number">7</span> <span class="token punctuation">,</span><span class="token number">0x6b901122</span> <span class="token punctuation">)</span>  
<span class="token function">FF</span><span class="token punctuation">(</span>d <span class="token punctuation">,</span>a <span class="token punctuation">,</span>b <span class="token punctuation">,</span>c <span class="token punctuation">,</span>M13 <span class="token punctuation">,</span><span class="token number">12</span> <span class="token punctuation">,</span><span class="token number">0xfd987193</span> <span class="token punctuation">)</span>  
<span class="token function">FF</span><span class="token punctuation">(</span>c <span class="token punctuation">,</span>d <span class="token punctuation">,</span>a <span class="token punctuation">,</span>b <span class="token punctuation">,</span>M14 <span class="token punctuation">,</span><span class="token number">17</span> <span class="token punctuation">,</span><span class="token number">0xa679438e</span> <span class="token punctuation">)</span>  
<span class="token function">FF</span><span class="token punctuation">(</span>b <span class="token punctuation">,</span>c <span class="token punctuation">,</span>d <span class="token punctuation">,</span>a <span class="token punctuation">,</span>M15 <span class="token punctuation">,</span><span class="token number">22</span> <span class="token punctuation">,</span><span class="token number">0x49b40821</span> <span class="token punctuation">)</span>  
<span class="token comment">// ç¬¬äºŒè½®  </span>
<span class="token function">GG</span><span class="token punctuation">(</span>a <span class="token punctuation">,</span>b <span class="token punctuation">,</span>c <span class="token punctuation">,</span>d <span class="token punctuation">,</span>M1 <span class="token punctuation">,</span><span class="token number">5</span> <span class="token punctuation">,</span><span class="token number">0xf61e2562</span> <span class="token punctuation">)</span>  
<span class="token function">GG</span><span class="token punctuation">(</span>d <span class="token punctuation">,</span>a <span class="token punctuation">,</span>b <span class="token punctuation">,</span>c <span class="token punctuation">,</span>M6 <span class="token punctuation">,</span><span class="token number">9</span> <span class="token punctuation">,</span><span class="token number">0xc040b340</span> <span class="token punctuation">)</span>  
<span class="token function">GG</span><span class="token punctuation">(</span>c <span class="token punctuation">,</span>d <span class="token punctuation">,</span>a <span class="token punctuation">,</span>b <span class="token punctuation">,</span>M11 <span class="token punctuation">,</span><span class="token number">14</span> <span class="token punctuation">,</span><span class="token number">0x265e5a51</span> <span class="token punctuation">)</span>  
<span class="token function">GG</span><span class="token punctuation">(</span>b <span class="token punctuation">,</span>c <span class="token punctuation">,</span>d <span class="token punctuation">,</span>a <span class="token punctuation">,</span>M0 <span class="token punctuation">,</span><span class="token number">20</span> <span class="token punctuation">,</span><span class="token number">0xe9b6c7aa</span> <span class="token punctuation">)</span>  
<span class="token function">GG</span><span class="token punctuation">(</span>a <span class="token punctuation">,</span>b <span class="token punctuation">,</span>c <span class="token punctuation">,</span>d <span class="token punctuation">,</span>M5 <span class="token punctuation">,</span><span class="token number">5</span> <span class="token punctuation">,</span><span class="token number">0xd62f105d</span> <span class="token punctuation">)</span>  
<span class="token function">GG</span><span class="token punctuation">(</span>d <span class="token punctuation">,</span>a <span class="token punctuation">,</span>b <span class="token punctuation">,</span>c <span class="token punctuation">,</span>M10 <span class="token punctuation">,</span><span class="token number">9</span> <span class="token punctuation">,</span><span class="token number">0x02441453</span> <span class="token punctuation">)</span>  
<span class="token function">GG</span><span class="token punctuation">(</span>c <span class="token punctuation">,</span>d <span class="token punctuation">,</span>a <span class="token punctuation">,</span>b <span class="token punctuation">,</span>M15 <span class="token punctuation">,</span><span class="token number">14</span> <span class="token punctuation">,</span><span class="token number">0xd8a1e681</span> <span class="token punctuation">)</span>  
<span class="token function">GG</span><span class="token punctuation">(</span>b <span class="token punctuation">,</span>c <span class="token punctuation">,</span>d <span class="token punctuation">,</span>a <span class="token punctuation">,</span>M4 <span class="token punctuation">,</span><span class="token number">20</span> <span class="token punctuation">,</span><span class="token number">0xe7d3fbc8</span> <span class="token punctuation">)</span>  
<span class="token function">GG</span><span class="token punctuation">(</span>a <span class="token punctuation">,</span>b <span class="token punctuation">,</span>c <span class="token punctuation">,</span>d <span class="token punctuation">,</span>M9 <span class="token punctuation">,</span><span class="token number">5</span> <span class="token punctuation">,</span><span class="token number">0x21e1cde6</span> <span class="token punctuation">)</span>  
<span class="token function">GG</span><span class="token punctuation">(</span>d <span class="token punctuation">,</span>a <span class="token punctuation">,</span>b <span class="token punctuation">,</span>c <span class="token punctuation">,</span>M14 <span class="token punctuation">,</span><span class="token number">9</span> <span class="token punctuation">,</span><span class="token number">0xc33707d6</span> <span class="token punctuation">)</span>  
<span class="token function">GG</span><span class="token punctuation">(</span>c <span class="token punctuation">,</span>d <span class="token punctuation">,</span>a <span class="token punctuation">,</span>b <span class="token punctuation">,</span>M3 <span class="token punctuation">,</span><span class="token number">14</span> <span class="token punctuation">,</span><span class="token number">0xf4d50d87</span> <span class="token punctuation">)</span>  
<span class="token function">GG</span><span class="token punctuation">(</span>b <span class="token punctuation">,</span>c <span class="token punctuation">,</span>d <span class="token punctuation">,</span>a <span class="token punctuation">,</span>M8 <span class="token punctuation">,</span><span class="token number">20</span> <span class="token punctuation">,</span><span class="token number">0x455a14ed</span> <span class="token punctuation">)</span>  
<span class="token function">GG</span><span class="token punctuation">(</span>a <span class="token punctuation">,</span>b <span class="token punctuation">,</span>c <span class="token punctuation">,</span>d <span class="token punctuation">,</span>M13 <span class="token punctuation">,</span><span class="token number">5</span> <span class="token punctuation">,</span><span class="token number">0xa9e3e905</span> <span class="token punctuation">)</span>  
<span class="token function">GG</span><span class="token punctuation">(</span>d <span class="token punctuation">,</span>a <span class="token punctuation">,</span>b <span class="token punctuation">,</span>c <span class="token punctuation">,</span>M2 <span class="token punctuation">,</span><span class="token number">9</span> <span class="token punctuation">,</span><span class="token number">0xfcefa3f8</span> <span class="token punctuation">)</span>  
<span class="token function">GG</span><span class="token punctuation">(</span>c <span class="token punctuation">,</span>d <span class="token punctuation">,</span>a <span class="token punctuation">,</span>b <span class="token punctuation">,</span>M7 <span class="token punctuation">,</span><span class="token number">14</span> <span class="token punctuation">,</span><span class="token number">0x676f02d9</span> <span class="token punctuation">)</span>  
<span class="token function">GG</span><span class="token punctuation">(</span>b <span class="token punctuation">,</span>c <span class="token punctuation">,</span>d <span class="token punctuation">,</span>a <span class="token punctuation">,</span>M12 <span class="token punctuation">,</span><span class="token number">20</span> <span class="token punctuation">,</span><span class="token number">0x8d2a4c8a</span> <span class="token punctuation">)</span>  
<span class="token comment">// ç¬¬ä¸‰è½®  </span>
<span class="token function">HH</span><span class="token punctuation">(</span>a <span class="token punctuation">,</span>b <span class="token punctuation">,</span>c <span class="token punctuation">,</span>d <span class="token punctuation">,</span>M5 <span class="token punctuation">,</span><span class="token number">4</span> <span class="token punctuation">,</span><span class="token number">0xfffa3942</span> <span class="token punctuation">)</span>  
<span class="token function">HH</span><span class="token punctuation">(</span>d <span class="token punctuation">,</span>a <span class="token punctuation">,</span>b <span class="token punctuation">,</span>c <span class="token punctuation">,</span>M8 <span class="token punctuation">,</span><span class="token number">11</span> <span class="token punctuation">,</span><span class="token number">0x8771f681</span> <span class="token punctuation">)</span>  
<span class="token function">HH</span><span class="token punctuation">(</span>c <span class="token punctuation">,</span>d <span class="token punctuation">,</span>a <span class="token punctuation">,</span>b <span class="token punctuation">,</span>M11 <span class="token punctuation">,</span><span class="token number">16</span> <span class="token punctuation">,</span><span class="token number">0x6d9d6122</span> <span class="token punctuation">)</span>  
<span class="token function">HH</span><span class="token punctuation">(</span>b <span class="token punctuation">,</span>c <span class="token punctuation">,</span>d <span class="token punctuation">,</span>a <span class="token punctuation">,</span>M14 <span class="token punctuation">,</span><span class="token number">23</span> <span class="token punctuation">,</span><span class="token number">0xfde5380c</span> <span class="token punctuation">)</span>  
<span class="token function">HH</span><span class="token punctuation">(</span>a <span class="token punctuation">,</span>b <span class="token punctuation">,</span>c <span class="token punctuation">,</span>d <span class="token punctuation">,</span>M1 <span class="token punctuation">,</span><span class="token number">4</span> <span class="token punctuation">,</span><span class="token number">0xa4beea44</span> <span class="token punctuation">)</span>  
<span class="token function">HH</span><span class="token punctuation">(</span>d <span class="token punctuation">,</span>a <span class="token punctuation">,</span>b <span class="token punctuation">,</span>c <span class="token punctuation">,</span>M4 <span class="token punctuation">,</span><span class="token number">11</span> <span class="token punctuation">,</span><span class="token number">0x4bdecfa9</span> <span class="token punctuation">)</span>  
<span class="token function">HH</span><span class="token punctuation">(</span>c <span class="token punctuation">,</span>d <span class="token punctuation">,</span>a <span class="token punctuation">,</span>b <span class="token punctuation">,</span>M7 <span class="token punctuation">,</span><span class="token number">16</span> <span class="token punctuation">,</span><span class="token number">0xf6bb4b60</span> <span class="token punctuation">)</span>  
<span class="token function">HH</span><span class="token punctuation">(</span>b <span class="token punctuation">,</span>c <span class="token punctuation">,</span>d <span class="token punctuation">,</span>a <span class="token punctuation">,</span>M10 <span class="token punctuation">,</span><span class="token number">23</span> <span class="token punctuation">,</span><span class="token number">0xbebfbc70</span> <span class="token punctuation">)</span>  
<span class="token function">HH</span><span class="token punctuation">(</span>a <span class="token punctuation">,</span>b <span class="token punctuation">,</span>c <span class="token punctuation">,</span>d <span class="token punctuation">,</span>M13 <span class="token punctuation">,</span><span class="token number">4</span> <span class="token punctuation">,</span><span class="token number">0x289b7ec6</span> <span class="token punctuation">)</span>  
<span class="token function">HH</span><span class="token punctuation">(</span>d <span class="token punctuation">,</span>a <span class="token punctuation">,</span>b <span class="token punctuation">,</span>c <span class="token punctuation">,</span>M0 <span class="token punctuation">,</span><span class="token number">11</span> <span class="token punctuation">,</span><span class="token number">0xeaa127fa</span> <span class="token punctuation">)</span>  
<span class="token function">HH</span><span class="token punctuation">(</span>c <span class="token punctuation">,</span>d <span class="token punctuation">,</span>a <span class="token punctuation">,</span>b <span class="token punctuation">,</span>M3 <span class="token punctuation">,</span><span class="token number">16</span> <span class="token punctuation">,</span><span class="token number">0xd4ef3085</span> <span class="token punctuation">)</span>  
<span class="token function">HH</span><span class="token punctuation">(</span>b <span class="token punctuation">,</span>c <span class="token punctuation">,</span>d <span class="token punctuation">,</span>a <span class="token punctuation">,</span>M6 <span class="token punctuation">,</span><span class="token number">23</span> <span class="token punctuation">,</span><span class="token number">0x04881d05</span> <span class="token punctuation">)</span>  
<span class="token function">HH</span><span class="token punctuation">(</span>a <span class="token punctuation">,</span>b <span class="token punctuation">,</span>c <span class="token punctuation">,</span>d <span class="token punctuation">,</span>M9 <span class="token punctuation">,</span><span class="token number">4</span> <span class="token punctuation">,</span><span class="token number">0xd9d4d039</span> <span class="token punctuation">)</span>  
<span class="token function">HH</span><span class="token punctuation">(</span>d <span class="token punctuation">,</span>a <span class="token punctuation">,</span>b <span class="token punctuation">,</span>c <span class="token punctuation">,</span>M12 <span class="token punctuation">,</span><span class="token number">11</span> <span class="token punctuation">,</span><span class="token number">0xe6db99e5</span> <span class="token punctuation">)</span>  
<span class="token function">HH</span><span class="token punctuation">(</span>c <span class="token punctuation">,</span>d <span class="token punctuation">,</span>a <span class="token punctuation">,</span>b <span class="token punctuation">,</span>M15 <span class="token punctuation">,</span><span class="token number">16</span> <span class="token punctuation">,</span><span class="token number">0x1fa27cf8</span> <span class="token punctuation">)</span>  
<span class="token function">HH</span><span class="token punctuation">(</span>b <span class="token punctuation">,</span>c <span class="token punctuation">,</span>d <span class="token punctuation">,</span>a <span class="token punctuation">,</span>M2 <span class="token punctuation">,</span><span class="token number">23</span> <span class="token punctuation">,</span><span class="token number">0xc4ac5665</span> <span class="token punctuation">)</span>  
<span class="token comment">// ç¬¬å››è½®  </span>
<span class="token function">II</span><span class="token punctuation">(</span>a <span class="token punctuation">,</span>b <span class="token punctuation">,</span>c <span class="token punctuation">,</span>d <span class="token punctuation">,</span>M0 <span class="token punctuation">,</span><span class="token number">6</span> <span class="token punctuation">,</span><span class="token number">0xf4292244</span> <span class="token punctuation">)</span>  
<span class="token function">II</span><span class="token punctuation">(</span>d <span class="token punctuation">,</span>a <span class="token punctuation">,</span>b <span class="token punctuation">,</span>c <span class="token punctuation">,</span>M7 <span class="token punctuation">,</span><span class="token number">10</span> <span class="token punctuation">,</span><span class="token number">0x432aff97</span> <span class="token punctuation">)</span>  
<span class="token function">II</span><span class="token punctuation">(</span>c <span class="token punctuation">,</span>d <span class="token punctuation">,</span>a <span class="token punctuation">,</span>b <span class="token punctuation">,</span>M14 <span class="token punctuation">,</span><span class="token number">15</span> <span class="token punctuation">,</span><span class="token number">0xab9423a7</span> <span class="token punctuation">)</span>  
<span class="token function">II</span><span class="token punctuation">(</span>b <span class="token punctuation">,</span>c <span class="token punctuation">,</span>d <span class="token punctuation">,</span>a <span class="token punctuation">,</span>M5 <span class="token punctuation">,</span><span class="token number">21</span> <span class="token punctuation">,</span><span class="token number">0xfc93a039</span> <span class="token punctuation">)</span>  
<span class="token function">II</span><span class="token punctuation">(</span>a <span class="token punctuation">,</span>b <span class="token punctuation">,</span>c <span class="token punctuation">,</span>d <span class="token punctuation">,</span>M12 <span class="token punctuation">,</span><span class="token number">6</span> <span class="token punctuation">,</span><span class="token number">0x655b59c3</span> <span class="token punctuation">)</span>  
<span class="token function">II</span><span class="token punctuation">(</span>d <span class="token punctuation">,</span>a <span class="token punctuation">,</span>b <span class="token punctuation">,</span>c <span class="token punctuation">,</span>M3 <span class="token punctuation">,</span><span class="token number">10</span> <span class="token punctuation">,</span><span class="token number">0x8f0ccc92</span> <span class="token punctuation">)</span>  
<span class="token function">II</span><span class="token punctuation">(</span>c <span class="token punctuation">,</span>d <span class="token punctuation">,</span>a <span class="token punctuation">,</span>b <span class="token punctuation">,</span>M10 <span class="token punctuation">,</span><span class="token number">15</span> <span class="token punctuation">,</span><span class="token number">0xffeff47d</span> <span class="token punctuation">)</span>  
<span class="token function">II</span><span class="token punctuation">(</span>b <span class="token punctuation">,</span>c <span class="token punctuation">,</span>d <span class="token punctuation">,</span>a <span class="token punctuation">,</span>M1 <span class="token punctuation">,</span><span class="token number">21</span> <span class="token punctuation">,</span><span class="token number">0x85845dd1</span> <span class="token punctuation">)</span>  
<span class="token function">II</span><span class="token punctuation">(</span>a <span class="token punctuation">,</span>b <span class="token punctuation">,</span>c <span class="token punctuation">,</span>d <span class="token punctuation">,</span>M8 <span class="token punctuation">,</span><span class="token number">6</span> <span class="token punctuation">,</span><span class="token number">0x6fa87e4f</span> <span class="token punctuation">)</span>  
<span class="token function">II</span><span class="token punctuation">(</span>d <span class="token punctuation">,</span>a <span class="token punctuation">,</span>b <span class="token punctuation">,</span>c <span class="token punctuation">,</span>M15 <span class="token punctuation">,</span><span class="token number">10</span> <span class="token punctuation">,</span><span class="token number">0xfe2ce6e0</span> <span class="token punctuation">)</span>  
<span class="token function">II</span><span class="token punctuation">(</span>c <span class="token punctuation">,</span>d <span class="token punctuation">,</span>a <span class="token punctuation">,</span>b <span class="token punctuation">,</span>M6 <span class="token punctuation">,</span><span class="token number">15</span> <span class="token punctuation">,</span><span class="token number">0xa3014314</span> <span class="token punctuation">)</span>  
<span class="token function">II</span><span class="token punctuation">(</span>b <span class="token punctuation">,</span>c <span class="token punctuation">,</span>d <span class="token punctuation">,</span>a <span class="token punctuation">,</span>M13 <span class="token punctuation">,</span><span class="token number">21</span> <span class="token punctuation">,</span><span class="token number">0x4e0811a1</span> <span class="token punctuation">)</span>  
<span class="token function">II</span><span class="token punctuation">(</span>a <span class="token punctuation">,</span>b <span class="token punctuation">,</span>c <span class="token punctuation">,</span>d <span class="token punctuation">,</span>M4 <span class="token punctuation">,</span><span class="token number">6</span> <span class="token punctuation">,</span><span class="token number">0xf7537e82</span> <span class="token punctuation">)</span>  
<span class="token function">II</span><span class="token punctuation">(</span>d <span class="token punctuation">,</span>a <span class="token punctuation">,</span>b <span class="token punctuation">,</span>c <span class="token punctuation">,</span>M11 <span class="token punctuation">,</span><span class="token number">10</span> <span class="token punctuation">,</span><span class="token number">0xbd3af235</span> <span class="token punctuation">)</span>  
<span class="token function">II</span><span class="token punctuation">(</span>c <span class="token punctuation">,</span>d <span class="token punctuation">,</span>a <span class="token punctuation">,</span>b <span class="token punctuation">,</span>M2 <span class="token punctuation">,</span><span class="token number">15</span> <span class="token punctuation">,</span><span class="token number">0x2ad7d2bb</span> <span class="token punctuation">)</span>  
<span class="token function">II</span><span class="token punctuation">(</span>b <span class="token punctuation">,</span>c <span class="token punctuation">,</span>d <span class="token punctuation">,</span>a <span class="token punctuation">,</span>M9 <span class="token punctuation">,</span><span class="token number">21</span> <span class="token punctuation">,</span><span class="token number">0xeb86d391</span> <span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="4"><li>å¦‚æœ 128 ä½æ¶ˆæ¯å·²ç»å¤„ç†å®Œï¼Œåˆ™ä»ä½åœ°å€å¼€å§‹ç”¨ 16 è¿›åˆ¶é€ä¸ªè¾“å‡ºå­—èŠ‚ä¾¿å¾—åˆ° 32 å­—ç¬¦çš„ MD5 ç ï¼Œå–æ­£ä¸­é—´çš„ 16 å­—ç¬¦å°±æ˜¯ 16 å­—ç¬¦çš„ MD5 ç </li></ol><hr><h2 id="åŠ å¯†ä»£ç "><a href="#åŠ å¯†ä»£ç " class="headerlink" title="åŠ å¯†ä»£ç "></a>åŠ å¯†ä»£ç </h2><h3 id="Python-ç‰ˆ"><a href="#Python-ç‰ˆ" class="headerlink" title="Python ç‰ˆ"></a>Python ç‰ˆ</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> hashlib

string <span class="token operator">=</span> <span class="token string">'flag{welcome_to_uf4te!}'</span>


<span class="token keyword">def</span> <span class="token function">md5value</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">:</span>
    input_name <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span><span class="token punctuation">)</span>
    input_name<span class="token punctuation">.</span>update<span class="token punctuation">(</span>key<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"å¤§å†™çš„32ä½ : "</span> <span class="token operator">+</span> <span class="token punctuation">(</span>input_name<span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"å¤§å†™çš„16ä½ : "</span> <span class="token operator">+</span> <span class="token punctuation">(</span>input_name<span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"å°å†™çš„32ä½ : "</span> <span class="token operator">+</span> <span class="token punctuation">(</span>input_name<span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"å°å†™çš„16ä½ : "</span> <span class="token operator">+</span> <span class="token punctuation">(</span>input_name<span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


md5value<span class="token punctuation">(</span>string<span class="token punctuation">)</span>

<span class="token triple-quoted-string string">''' è¾“å‡ºï¼š
å¤§å†™çš„ 32 ä½ MD5 : B2E8ED4649266019056425F0E67A62A7
å¤§å†™çš„ 16 ä½ MD5 : 49266019056425F0
å°å†™çš„ 32 ä½ MD5 : b2e8ed4649266019056425f0e67a62a7
å°å†™çš„ 16 ä½ MD5 : 49266019056425f0
'''</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="IDA-ç¤ºä¾‹-5"><a href="#IDA-ç¤ºä¾‹-5" class="headerlink" title="IDA ç¤ºä¾‹"></a>IDA ç¤ºä¾‹</h2><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">// MD5_Init</span>
_DWORD <span class="token operator">*</span>__cdecl <span class="token function">sub_4012B0</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span>a1<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  _DWORD <span class="token operator">*</span>result<span class="token punctuation">;</span> <span class="token comment">// eax</span>

  result <span class="token operator">=</span> a1<span class="token punctuation">;</span>
  a1<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  a1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token operator">*</span>a1 <span class="token operator">=</span> <span class="token number">1732584193</span><span class="token punctuation">;</span>
  a1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">271733879</span><span class="token punctuation">;</span>
  a1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1732584194</span><span class="token punctuation">;</span>
  a1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">271733878</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token comment">// MD5_Update</span>
<span class="token keyword">int</span> __cdecl <span class="token function">sub_4012E0</span><span class="token punctuation">(</span><span class="token keyword">int</span> a1<span class="token punctuation">,</span> <span class="token keyword">int</span> a2<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span> a3<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v3<span class="token punctuation">;</span> <span class="token comment">// ecx</span>
  <span class="token keyword">int</span> v4<span class="token punctuation">;</span> <span class="token comment">// eax</span>
  <span class="token keyword">int</span> v5<span class="token punctuation">;</span> <span class="token comment">// ebx</span>
  <span class="token keyword">int</span> v6<span class="token punctuation">;</span> <span class="token comment">// ebp</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment">// ebx</span>

  v3 <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>a1 <span class="token operator">+</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">8</span> <span class="token operator">*</span> a3<span class="token punctuation">;</span>
  v4 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>a1 <span class="token operator">+</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x3F</span><span class="token punctuation">;</span>
  <span class="token operator">*</span><span class="token punctuation">(</span>a1 <span class="token operator">+</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">=</span> v3<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> v3 <span class="token operator">&lt;</span> <span class="token number">8</span> <span class="token operator">*</span> a3 <span class="token punctuation">)</span>
    <span class="token operator">++</span><span class="token operator">*</span><span class="token punctuation">(</span>a1 <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token operator">*</span><span class="token punctuation">(</span>a1 <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">+=</span> a3 <span class="token operator">&gt;&gt;</span> <span class="token number">29</span><span class="token punctuation">;</span>
  v5 <span class="token operator">=</span> <span class="token number">64</span> <span class="token operator">-</span> v4<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> a3 <span class="token operator">&lt;</span> <span class="token number">64</span> <span class="token operator">-</span> v4 <span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    v6 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">else</span>
  <span class="token punctuation">{</span>
    <span class="token function">sub_401DF0</span><span class="token punctuation">(</span>v4 <span class="token operator">+</span> a1 <span class="token operator">+</span> <span class="token number">24</span><span class="token punctuation">,</span> a2<span class="token punctuation">,</span> <span class="token number">64</span> <span class="token operator">-</span> v4<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">sub_401400</span><span class="token punctuation">(</span>a1<span class="token punctuation">,</span> a1 <span class="token operator">+</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    v6 <span class="token operator">=</span> v5<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> v5 <span class="token operator">+</span> <span class="token number">63</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> a3<span class="token punctuation">;</span> v6 <span class="token operator">+=</span> <span class="token number">64</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token function">sub_401400</span><span class="token punctuation">(</span>a1<span class="token punctuation">,</span> a2 <span class="token operator">+</span> i <span class="token operator">-</span> <span class="token number">63</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      i <span class="token operator">+=</span> <span class="token number">64</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    v4 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token function">sub_401DF0</span><span class="token punctuation">(</span>v4 <span class="token operator">+</span> a1 <span class="token operator">+</span> <span class="token number">24</span><span class="token punctuation">,</span> a2 <span class="token operator">+</span> v6<span class="token punctuation">,</span> a3 <span class="token operator">-</span> v6<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">int</span> __cdecl <span class="token function">sub_401400</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>a1<span class="token punctuation">,</span> <span class="token keyword">int</span> a2<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token keyword">int</span> v3<span class="token punctuation">;</span> <span class="token comment">// edi</span>
  <span class="token keyword">int</span> v4<span class="token punctuation">;</span> <span class="token comment">// ebx</span>
  <span class="token keyword">int</span> v5<span class="token punctuation">;</span> <span class="token comment">// ebp</span>
  <span class="token keyword">unsigned</span> __int64 v6<span class="token punctuation">;</span> <span class="token comment">// kr00_8</span>
  <span class="token keyword">int</span> v7<span class="token punctuation">;</span> <span class="token comment">// eax</span>
  <span class="token keyword">unsigned</span> __int64 v8<span class="token punctuation">;</span> <span class="token comment">// kr08_8</span>
  <span class="token keyword">int</span> v9<span class="token punctuation">;</span> <span class="token comment">// ecx</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v10<span class="token punctuation">;</span> <span class="token comment">// ebx</span>
  <span class="token keyword">int</span> v11<span class="token punctuation">;</span> <span class="token comment">// edx</span>
  <span class="token keyword">int</span> v12<span class="token punctuation">;</span> <span class="token comment">// edi</span>
  <span class="token keyword">int</span> v13<span class="token punctuation">;</span> <span class="token comment">// edi</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v14<span class="token punctuation">;</span> <span class="token comment">// ecx</span>
  <span class="token keyword">int</span> v15<span class="token punctuation">;</span> <span class="token comment">// eax</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v16<span class="token punctuation">;</span> <span class="token comment">// edx</span>
  <span class="token keyword">int</span> v17<span class="token punctuation">;</span> <span class="token comment">// ecx</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v18<span class="token punctuation">;</span> <span class="token comment">// edi</span>
  <span class="token keyword">int</span> v19<span class="token punctuation">;</span> <span class="token comment">// edx</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v20<span class="token punctuation">;</span> <span class="token comment">// eax</span>
  <span class="token keyword">int</span> v21<span class="token punctuation">;</span> <span class="token comment">// edi</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v22<span class="token punctuation">;</span> <span class="token comment">// ecx</span>
  <span class="token keyword">int</span> v23<span class="token punctuation">;</span> <span class="token comment">// eax</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v24<span class="token punctuation">;</span> <span class="token comment">// edx</span>
  <span class="token keyword">int</span> v25<span class="token punctuation">;</span> <span class="token comment">// ecx</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v26<span class="token punctuation">;</span> <span class="token comment">// edi</span>
  <span class="token keyword">int</span> v27<span class="token punctuation">;</span> <span class="token comment">// edx</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v28<span class="token punctuation">;</span> <span class="token comment">// eax</span>
  <span class="token keyword">int</span> v29<span class="token punctuation">;</span> <span class="token comment">// edi</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v30<span class="token punctuation">;</span> <span class="token comment">// ecx</span>
  <span class="token keyword">int</span> v31<span class="token punctuation">;</span> <span class="token comment">// eax</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v32<span class="token punctuation">;</span> <span class="token comment">// edx</span>
  <span class="token keyword">int</span> v33<span class="token punctuation">;</span> <span class="token comment">// ecx</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v34<span class="token punctuation">;</span> <span class="token comment">// edi</span>
  <span class="token keyword">int</span> v35<span class="token punctuation">;</span> <span class="token comment">// edx</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v36<span class="token punctuation">;</span> <span class="token comment">// eax</span>
  <span class="token keyword">int</span> v37<span class="token punctuation">;</span> <span class="token comment">// edi</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v38<span class="token punctuation">;</span> <span class="token comment">// ecx</span>
  <span class="token keyword">int</span> v39<span class="token punctuation">;</span> <span class="token comment">// eax</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v40<span class="token punctuation">;</span> <span class="token comment">// edx</span>
  <span class="token keyword">int</span> v41<span class="token punctuation">;</span> <span class="token comment">// ecx</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v42<span class="token punctuation">;</span> <span class="token comment">// edi</span>
  <span class="token keyword">int</span> v43<span class="token punctuation">;</span> <span class="token comment">// edx</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v44<span class="token punctuation">;</span> <span class="token comment">// eax</span>
  <span class="token keyword">int</span> v45<span class="token punctuation">;</span> <span class="token comment">// edi</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v46<span class="token punctuation">;</span> <span class="token comment">// ecx</span>
  <span class="token keyword">int</span> v47<span class="token punctuation">;</span> <span class="token comment">// eax</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v48<span class="token punctuation">;</span> <span class="token comment">// edx</span>
  <span class="token keyword">int</span> v49<span class="token punctuation">;</span> <span class="token comment">// ecx</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v50<span class="token punctuation">;</span> <span class="token comment">// edi</span>
  <span class="token keyword">int</span> v51<span class="token punctuation">;</span> <span class="token comment">// edx</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v52<span class="token punctuation">;</span> <span class="token comment">// eax</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v53<span class="token punctuation">;</span> <span class="token comment">// edi</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v54<span class="token punctuation">;</span> <span class="token comment">// eax</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v55<span class="token punctuation">;</span> <span class="token comment">// ecx</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v56<span class="token punctuation">;</span> <span class="token comment">// ebx</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v57<span class="token punctuation">;</span> <span class="token comment">// edx</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v58<span class="token punctuation">;</span> <span class="token comment">// edi</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v59<span class="token punctuation">;</span> <span class="token comment">// eax</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v60<span class="token punctuation">;</span> <span class="token comment">// ecx</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v61<span class="token punctuation">;</span> <span class="token comment">// ebx</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v62<span class="token punctuation">;</span> <span class="token comment">// eax</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v63<span class="token punctuation">;</span> <span class="token comment">// edx</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v64<span class="token punctuation">;</span> <span class="token comment">// ebx</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v65<span class="token punctuation">;</span> <span class="token comment">// edi</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v66<span class="token punctuation">;</span> <span class="token comment">// edx</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v67<span class="token punctuation">;</span> <span class="token comment">// ecx</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v68<span class="token punctuation">;</span> <span class="token comment">// eax</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v69<span class="token punctuation">;</span> <span class="token comment">// ebx</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v70<span class="token punctuation">;</span> <span class="token comment">// edi</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v71<span class="token punctuation">;</span> <span class="token comment">// edx</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v72<span class="token punctuation">;</span> <span class="token comment">// ebx</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v73<span class="token punctuation">;</span> <span class="token comment">// ecx</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v74<span class="token punctuation">;</span> <span class="token comment">// eax</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v75<span class="token punctuation">;</span> <span class="token comment">// edi</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v76<span class="token punctuation">;</span> <span class="token comment">// edx</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v77<span class="token punctuation">;</span> <span class="token comment">// ebx</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v78<span class="token punctuation">;</span> <span class="token comment">// edi</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v79<span class="token punctuation">;</span> <span class="token comment">// ecx</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v80<span class="token punctuation">;</span> <span class="token comment">// ebx</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v81<span class="token punctuation">;</span> <span class="token comment">// eax</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v82<span class="token punctuation">;</span> <span class="token comment">// ecx</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v83<span class="token punctuation">;</span> <span class="token comment">// edx</span>
  <span class="token keyword">int</span> v84<span class="token punctuation">;</span> <span class="token comment">// eax</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v85<span class="token punctuation">;</span> <span class="token comment">// edi</span>
  <span class="token keyword">int</span> v86<span class="token punctuation">;</span> <span class="token comment">// edx</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v87<span class="token punctuation">;</span> <span class="token comment">// ebx</span>
  <span class="token keyword">int</span> v88<span class="token punctuation">;</span> <span class="token comment">// edi</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v89<span class="token punctuation">;</span> <span class="token comment">// ecx</span>
  <span class="token keyword">int</span> v90<span class="token punctuation">;</span> <span class="token comment">// ebx</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v91<span class="token punctuation">;</span> <span class="token comment">// eax</span>
  <span class="token keyword">int</span> v92<span class="token punctuation">;</span> <span class="token comment">// ecx</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v93<span class="token punctuation">;</span> <span class="token comment">// edx</span>
  <span class="token keyword">int</span> v94<span class="token punctuation">;</span> <span class="token comment">// eax</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v95<span class="token punctuation">;</span> <span class="token comment">// edi</span>
  <span class="token keyword">int</span> v96<span class="token punctuation">;</span> <span class="token comment">// edx</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v97<span class="token punctuation">;</span> <span class="token comment">// ebx</span>
  <span class="token keyword">int</span> v98<span class="token punctuation">;</span> <span class="token comment">// edi</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v99<span class="token punctuation">;</span> <span class="token comment">// ecx</span>
  <span class="token keyword">int</span> v100<span class="token punctuation">;</span> <span class="token comment">// ebx</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v101<span class="token punctuation">;</span> <span class="token comment">// eax</span>
  <span class="token keyword">int</span> v102<span class="token punctuation">;</span> <span class="token comment">// ecx</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v103<span class="token punctuation">;</span> <span class="token comment">// edx</span>
  <span class="token keyword">int</span> v104<span class="token punctuation">;</span> <span class="token comment">// eax</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v105<span class="token punctuation">;</span> <span class="token comment">// edi</span>
  <span class="token keyword">int</span> v106<span class="token punctuation">;</span> <span class="token comment">// edx</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v107<span class="token punctuation">;</span> <span class="token comment">// ebx</span>
  <span class="token keyword">int</span> v108<span class="token punctuation">;</span> <span class="token comment">// edi</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v109<span class="token punctuation">;</span> <span class="token comment">// ecx</span>
  <span class="token keyword">int</span> v110<span class="token punctuation">;</span> <span class="token comment">// ebx</span>
  <span class="token keyword">int</span> v111<span class="token punctuation">;</span> <span class="token comment">// ebp</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v112<span class="token punctuation">;</span> <span class="token comment">// eax</span>
  <span class="token keyword">int</span> v113<span class="token punctuation">;</span> <span class="token comment">// ecx</span>
  <span class="token keyword">int</span> v114<span class="token punctuation">;</span> <span class="token comment">// edx</span>
  <span class="token keyword">int</span> v115<span class="token punctuation">;</span> <span class="token comment">// ebx</span>
  <span class="token keyword">int</span> v117<span class="token punctuation">;</span> <span class="token comment">// [esp+10h] [ebp-40h] BYREF</span>
  <span class="token keyword">int</span> v118<span class="token punctuation">;</span> <span class="token comment">// [esp+14h] [ebp-3Ch]</span>
  <span class="token keyword">int</span> v119<span class="token punctuation">;</span> <span class="token comment">// [esp+18h] [ebp-38h]</span>
  <span class="token keyword">int</span> v120<span class="token punctuation">;</span> <span class="token comment">// [esp+1Ch] [ebp-34h]</span>
  <span class="token keyword">int</span> v121<span class="token punctuation">;</span> <span class="token comment">// [esp+20h] [ebp-30h]</span>
  <span class="token keyword">int</span> v122<span class="token punctuation">;</span> <span class="token comment">// [esp+24h] [ebp-2Ch]</span>
  <span class="token keyword">int</span> v123<span class="token punctuation">;</span> <span class="token comment">// [esp+28h] [ebp-28h]</span>
  <span class="token keyword">int</span> v124<span class="token punctuation">;</span> <span class="token comment">// [esp+2Ch] [ebp-24h]</span>
  <span class="token keyword">int</span> v125<span class="token punctuation">;</span> <span class="token comment">// [esp+30h] [ebp-20h]</span>
  <span class="token keyword">int</span> v126<span class="token punctuation">;</span> <span class="token comment">// [esp+34h] [ebp-1Ch]</span>
  <span class="token keyword">int</span> v127<span class="token punctuation">;</span> <span class="token comment">// [esp+38h] [ebp-18h]</span>
  <span class="token keyword">int</span> v128<span class="token punctuation">;</span> <span class="token comment">// [esp+3Ch] [ebp-14h]</span>
  <span class="token keyword">int</span> v129<span class="token punctuation">;</span> <span class="token comment">// [esp+40h] [ebp-10h]</span>
  <span class="token keyword">int</span> v130<span class="token punctuation">;</span> <span class="token comment">// [esp+44h] [ebp-Ch]</span>
  <span class="token keyword">int</span> v131<span class="token punctuation">;</span> <span class="token comment">// [esp+48h] [ebp-8h]</span>
  <span class="token keyword">int</span> v132<span class="token punctuation">;</span> <span class="token comment">// [esp+4Ch] [ebp-4h]</span>
  <span class="token keyword">int</span> v133<span class="token punctuation">;</span> <span class="token comment">// [esp+54h] [ebp+4h]</span>
  <span class="token keyword">int</span> v134<span class="token punctuation">;</span> <span class="token comment">// [esp+54h] [ebp+4h]</span>
  <span class="token keyword">int</span> v135<span class="token punctuation">;</span> <span class="token comment">// [esp+54h] [ebp+4h]</span>
  <span class="token keyword">int</span> v136<span class="token punctuation">;</span> <span class="token comment">// [esp+54h] [ebp+4h]</span>
  <span class="token keyword">int</span> v137<span class="token punctuation">;</span> <span class="token comment">// [esp+54h] [ebp+4h]</span>
  <span class="token keyword">int</span> v138<span class="token punctuation">;</span> <span class="token comment">// [esp+54h] [ebp+4h]</span>
  <span class="token keyword">int</span> v139<span class="token punctuation">;</span> <span class="token comment">// [esp+54h] [ebp+4h]</span>
  <span class="token keyword">int</span> v140<span class="token punctuation">;</span> <span class="token comment">// [esp+54h] [ebp+4h]</span>

  v3 <span class="token operator">=</span> a1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  v4 <span class="token operator">=</span> a1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  v5 <span class="token operator">=</span> a1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  v133 <span class="token operator">=</span> <span class="token operator">*</span>a1<span class="token punctuation">;</span>
  <span class="token function">sub_401DA0</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v117<span class="token punctuation">,</span> a2<span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v6 <span class="token operator">=</span> <span class="token punctuation">(</span>v133 <span class="token operator">+</span> v117 <span class="token operator">+</span> <span class="token punctuation">(</span>v3 <span class="token operator">&amp;</span> v4 <span class="token operator">|</span> v5 <span class="token operator">&amp;</span> <span class="token operator">~</span>v3<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">680876936</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">7</span><span class="token punctuation">;</span>
  v7 <span class="token operator">=</span> v3 <span class="token operator">+</span> <span class="token punctuation">(</span>v6 <span class="token operator">|</span> <span class="token function">HIDWORD</span><span class="token punctuation">(</span>v6<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v8 <span class="token operator">=</span> <span class="token punctuation">(</span>v118 <span class="token operator">+</span> <span class="token punctuation">(</span>v7 <span class="token operator">&amp;</span> v3 <span class="token operator">|</span> v4 <span class="token operator">&amp;</span> <span class="token operator">~</span>v7<span class="token punctuation">)</span> <span class="token operator">+</span> v5 <span class="token operator">-</span> <span class="token number">389564586</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">12</span><span class="token punctuation">;</span>
  v9 <span class="token operator">=</span> v7 <span class="token operator">+</span> <span class="token punctuation">(</span>v8 <span class="token operator">|</span> <span class="token function">HIDWORD</span><span class="token punctuation">(</span>v8<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v10 <span class="token operator">=</span> v4 <span class="token operator">+</span> v119 <span class="token operator">+</span> <span class="token punctuation">(</span>v7 <span class="token operator">&amp;</span> v9 <span class="token operator">|</span> v3 <span class="token operator">&amp;</span> <span class="token operator">~</span>v9<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">606105819</span><span class="token punctuation">;</span>
  v11 <span class="token operator">=</span> v9 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v10 <span class="token operator">&lt;&lt;</span> <span class="token number">17</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>v10 <span class="token operator">&gt;&gt;</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v134 <span class="token operator">=</span> v11
       <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>v3 <span class="token operator">+</span> v120 <span class="token operator">+</span> <span class="token punctuation">(</span>v11 <span class="token operator">&amp;</span> v9 <span class="token operator">|</span> v7 <span class="token operator">&amp;</span> <span class="token operator">~</span>v11<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1044525330</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v3 <span class="token operator">+</span> v120 <span class="token operator">+</span> <span class="token punctuation">(</span>v11 <span class="token operator">&amp;</span> v9 <span class="token operator">|</span> v7 <span class="token operator">&amp;</span> <span class="token operator">~</span>v11<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1044525330</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v12 <span class="token operator">=</span> v121 <span class="token operator">+</span> <span class="token punctuation">(</span>v134 <span class="token operator">&amp;</span> v11 <span class="token operator">|</span> v9 <span class="token operator">&amp;</span> <span class="token operator">~</span>v134<span class="token punctuation">)</span><span class="token punctuation">;</span>
  v13 <span class="token operator">=</span> v134 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>v7 <span class="token operator">+</span> v12 <span class="token operator">-</span> <span class="token number">176418897</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">7</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v7 <span class="token operator">+</span> v12 <span class="token operator">-</span> <span class="token number">176418897</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v14 <span class="token operator">=</span> v9 <span class="token operator">+</span> v122 <span class="token operator">+</span> <span class="token punctuation">(</span>v13 <span class="token operator">&amp;</span> v134 <span class="token operator">|</span> v11 <span class="token operator">&amp;</span> <span class="token operator">~</span>v13<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1200080426</span><span class="token punctuation">;</span>
  v15 <span class="token operator">=</span> v13 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v14 <span class="token operator">&lt;&lt;</span> <span class="token number">12</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>v14 <span class="token operator">&gt;&gt;</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v16 <span class="token operator">=</span> v11 <span class="token operator">+</span> v123 <span class="token operator">+</span> <span class="token punctuation">(</span>v13 <span class="token operator">&amp;</span> v15 <span class="token operator">|</span> v134 <span class="token operator">&amp;</span> <span class="token operator">~</span>v15<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1473231341</span><span class="token punctuation">;</span>
  v17 <span class="token operator">=</span> v15 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v16 <span class="token operator">&lt;&lt;</span> <span class="token number">17</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>v16 <span class="token operator">&gt;&gt;</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v135 <span class="token operator">=</span> v17
       <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>v134 <span class="token operator">+</span> v124 <span class="token operator">+</span> <span class="token punctuation">(</span>v17 <span class="token operator">&amp;</span> v15 <span class="token operator">|</span> v13 <span class="token operator">&amp;</span> <span class="token operator">~</span>v17<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">45705983</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v134
                                                                        <span class="token operator">+</span> v124
                                                                        <span class="token operator">+</span> <span class="token punctuation">(</span>v17 <span class="token operator">&amp;</span> v15 <span class="token operator">|</span> v13 <span class="token operator">&amp;</span> <span class="token operator">~</span>v17<span class="token punctuation">)</span>
                                                                        <span class="token operator">-</span> <span class="token number">45705983</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v18 <span class="token operator">=</span> v13 <span class="token operator">+</span> v125 <span class="token operator">+</span> <span class="token punctuation">(</span>v135 <span class="token operator">&amp;</span> v17 <span class="token operator">|</span> v15 <span class="token operator">&amp;</span> <span class="token operator">~</span>v135<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1770035416</span><span class="token punctuation">;</span>
  v19 <span class="token operator">=</span> v135 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v18 <span class="token operator">&lt;&lt;</span> <span class="token number">7</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>v18 <span class="token operator">&gt;&gt;</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v20 <span class="token operator">=</span> v15 <span class="token operator">+</span> v126 <span class="token operator">+</span> <span class="token punctuation">(</span>v19 <span class="token operator">&amp;</span> v135 <span class="token operator">|</span> v17 <span class="token operator">&amp;</span> <span class="token operator">~</span>v19<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1958414417</span><span class="token punctuation">;</span>
  v21 <span class="token operator">=</span> v19 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v20 <span class="token operator">&lt;&lt;</span> <span class="token number">12</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>v20 <span class="token operator">&gt;&gt;</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v22 <span class="token operator">=</span> v17 <span class="token operator">+</span> v127 <span class="token operator">+</span> <span class="token punctuation">(</span>v19 <span class="token operator">&amp;</span> v21 <span class="token operator">|</span> v135 <span class="token operator">&amp;</span> <span class="token operator">~</span>v21<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">42063</span><span class="token punctuation">;</span>
  v23 <span class="token operator">=</span> v21 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v22 <span class="token operator">&lt;&lt;</span> <span class="token number">17</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>v22 <span class="token operator">&gt;&gt;</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v136 <span class="token operator">=</span> v23
       <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>v135 <span class="token operator">+</span> v128 <span class="token operator">+</span> <span class="token punctuation">(</span>v23 <span class="token operator">&amp;</span> v21 <span class="token operator">|</span> v19 <span class="token operator">&amp;</span> <span class="token operator">~</span>v23<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1990404162</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v135
                                                                          <span class="token operator">+</span> v128
                                                                          <span class="token operator">+</span> <span class="token punctuation">(</span>v23 <span class="token operator">&amp;</span> v21 <span class="token operator">|</span> v19 <span class="token operator">&amp;</span> <span class="token operator">~</span>v23<span class="token punctuation">)</span>
                                                                          <span class="token operator">-</span> <span class="token number">1990404162</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v24 <span class="token operator">=</span> v19 <span class="token operator">+</span> v129 <span class="token operator">+</span> <span class="token punctuation">(</span>v136 <span class="token operator">&amp;</span> v23 <span class="token operator">|</span> v21 <span class="token operator">&amp;</span> <span class="token operator">~</span>v136<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1804603682</span><span class="token punctuation">;</span>
  v25 <span class="token operator">=</span> v136 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v24 <span class="token operator">&lt;&lt;</span> <span class="token number">7</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>v24 <span class="token operator">&gt;&gt;</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v26 <span class="token operator">=</span> v21 <span class="token operator">+</span> v130 <span class="token operator">+</span> <span class="token punctuation">(</span>v25 <span class="token operator">&amp;</span> v136 <span class="token operator">|</span> v23 <span class="token operator">&amp;</span> <span class="token operator">~</span>v25<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">40341101</span><span class="token punctuation">;</span>
  v27 <span class="token operator">=</span> v25 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v26 <span class="token operator">&lt;&lt;</span> <span class="token number">12</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>v26 <span class="token operator">&gt;&gt;</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v28 <span class="token operator">=</span> v23 <span class="token operator">+</span> v131 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token operator">~</span>v27 <span class="token operator">&amp;</span> v136 <span class="token operator">|</span> v25 <span class="token operator">&amp;</span> v27<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1502002290</span><span class="token punctuation">;</span>
  v29 <span class="token operator">=</span> v27 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v28 <span class="token operator">&lt;&lt;</span> <span class="token number">17</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>v28 <span class="token operator">&gt;&gt;</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v137 <span class="token operator">=</span> v29
       <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>v136 <span class="token operator">+</span> v132 <span class="token operator">+</span> <span class="token punctuation">(</span>v29 <span class="token operator">&amp;</span> v27 <span class="token operator">|</span> v25 <span class="token operator">&amp;</span> <span class="token operator">~</span>v29<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1236535329</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v136
                                                                          <span class="token operator">+</span> v132
                                                                          <span class="token operator">+</span> <span class="token punctuation">(</span>v29 <span class="token operator">&amp;</span> v27 <span class="token operator">|</span> v25 <span class="token operator">&amp;</span> <span class="token operator">~</span>v29<span class="token punctuation">)</span>
                                                                          <span class="token operator">+</span> <span class="token number">1236535329</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v30 <span class="token operator">=</span> v25 <span class="token operator">+</span> v118 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token operator">~</span>v27 <span class="token operator">&amp;</span> v29 <span class="token operator">|</span> v137 <span class="token operator">&amp;</span> v27<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">165796510</span><span class="token punctuation">;</span>
  v31 <span class="token operator">=</span> v137 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">32</span> <span class="token operator">*</span> v30<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>v30 <span class="token operator">&gt;&gt;</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v32 <span class="token operator">=</span> v27 <span class="token operator">+</span> v123 <span class="token operator">+</span> <span class="token punctuation">(</span>v31 <span class="token operator">&amp;</span> v29 <span class="token operator">|</span> v137 <span class="token operator">&amp;</span> <span class="token operator">~</span>v29<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1069501632</span><span class="token punctuation">;</span>
  v33 <span class="token operator">=</span> v31 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v32 <span class="token operator">&lt;&lt;</span> <span class="token number">9</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>v32 <span class="token operator">&gt;&gt;</span> <span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v34 <span class="token operator">=</span> v29 <span class="token operator">+</span> v128 <span class="token operator">+</span> <span class="token punctuation">(</span>v137 <span class="token operator">&amp;</span> v33 <span class="token operator">|</span> v31 <span class="token operator">&amp;</span> <span class="token operator">~</span>v137<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">643717713</span><span class="token punctuation">;</span>
  v35 <span class="token operator">=</span> v33 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v34 <span class="token operator">&lt;&lt;</span> <span class="token number">14</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>v34 <span class="token operator">&gt;&gt;</span> <span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v138 <span class="token operator">=</span> v35
       <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>v137 <span class="token operator">+</span> v117 <span class="token operator">+</span> <span class="token punctuation">(</span>v31 <span class="token operator">&amp;</span> v35 <span class="token operator">|</span> v33 <span class="token operator">&amp;</span> <span class="token operator">~</span>v31<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">373897302</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">12</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v137
                                                                         <span class="token operator">+</span> v117
                                                                         <span class="token operator">+</span> <span class="token punctuation">(</span>v31 <span class="token operator">&amp;</span> v35 <span class="token operator">|</span> v33 <span class="token operator">&amp;</span> <span class="token operator">~</span>v31<span class="token punctuation">)</span>
                                                                         <span class="token operator">-</span> <span class="token number">373897302</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v36 <span class="token operator">=</span> v31 <span class="token operator">+</span> v122 <span class="token operator">+</span> <span class="token punctuation">(</span>v138 <span class="token operator">&amp;</span> v33 <span class="token operator">|</span> v35 <span class="token operator">&amp;</span> <span class="token operator">~</span>v33<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">701558691</span><span class="token punctuation">;</span>
  v37 <span class="token operator">=</span> v138 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">32</span> <span class="token operator">*</span> v36<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>v36 <span class="token operator">&gt;&gt;</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v38 <span class="token operator">=</span> v33 <span class="token operator">+</span> v127 <span class="token operator">+</span> <span class="token punctuation">(</span>v37 <span class="token operator">&amp;</span> v35 <span class="token operator">|</span> v138 <span class="token operator">&amp;</span> <span class="token operator">~</span>v35<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">38016083</span><span class="token punctuation">;</span>
  v39 <span class="token operator">=</span> v37 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v38 <span class="token operator">&lt;&lt;</span> <span class="token number">9</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>v38 <span class="token operator">&gt;&gt;</span> <span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v40 <span class="token operator">=</span> v35 <span class="token operator">+</span> v132 <span class="token operator">+</span> <span class="token punctuation">(</span>v138 <span class="token operator">&amp;</span> v39 <span class="token operator">|</span> v37 <span class="token operator">&amp;</span> <span class="token operator">~</span>v138<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">660478335</span><span class="token punctuation">;</span>
  v41 <span class="token operator">=</span> v39 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v40 <span class="token operator">&lt;&lt;</span> <span class="token number">14</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>v40 <span class="token operator">&gt;&gt;</span> <span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v139 <span class="token operator">=</span> v41
       <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>v138 <span class="token operator">+</span> v121 <span class="token operator">+</span> <span class="token punctuation">(</span>v37 <span class="token operator">&amp;</span> v41 <span class="token operator">|</span> v39 <span class="token operator">&amp;</span> <span class="token operator">~</span>v37<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">405537848</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">12</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v138
                                                                         <span class="token operator">+</span> v121
                                                                         <span class="token operator">+</span> <span class="token punctuation">(</span>v37 <span class="token operator">&amp;</span> v41 <span class="token operator">|</span> v39 <span class="token operator">&amp;</span> <span class="token operator">~</span>v37<span class="token punctuation">)</span>
                                                                         <span class="token operator">-</span> <span class="token number">405537848</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v42 <span class="token operator">=</span> v37 <span class="token operator">+</span> v126 <span class="token operator">+</span> <span class="token punctuation">(</span>v139 <span class="token operator">&amp;</span> v39 <span class="token operator">|</span> v41 <span class="token operator">&amp;</span> <span class="token operator">~</span>v39<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">568446438</span><span class="token punctuation">;</span>
  v43 <span class="token operator">=</span> v139 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">32</span> <span class="token operator">*</span> v42<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>v42 <span class="token operator">&gt;&gt;</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v44 <span class="token operator">=</span> v39 <span class="token operator">+</span> v131 <span class="token operator">+</span> <span class="token punctuation">(</span>v43 <span class="token operator">&amp;</span> v41 <span class="token operator">|</span> v139 <span class="token operator">&amp;</span> <span class="token operator">~</span>v41<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1019803690</span><span class="token punctuation">;</span>
  v45 <span class="token operator">=</span> v43 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v44 <span class="token operator">&lt;&lt;</span> <span class="token number">9</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>v44 <span class="token operator">&gt;&gt;</span> <span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v46 <span class="token operator">=</span> v41 <span class="token operator">+</span> v120 <span class="token operator">+</span> <span class="token punctuation">(</span>v139 <span class="token operator">&amp;</span> v45 <span class="token operator">|</span> v43 <span class="token operator">&amp;</span> <span class="token operator">~</span>v139<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">187363961</span><span class="token punctuation">;</span>
  v47 <span class="token operator">=</span> v45 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v46 <span class="token operator">&lt;&lt;</span> <span class="token number">14</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>v46 <span class="token operator">&gt;&gt;</span> <span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v140 <span class="token operator">=</span> v47
       <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>v139 <span class="token operator">+</span> v125 <span class="token operator">+</span> <span class="token punctuation">(</span>v43 <span class="token operator">&amp;</span> v47 <span class="token operator">|</span> v45 <span class="token operator">&amp;</span> <span class="token operator">~</span>v43<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1163531501</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">12</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v139
                                                                          <span class="token operator">+</span> v125
                                                                          <span class="token operator">+</span> <span class="token punctuation">(</span>v43 <span class="token operator">&amp;</span> v47 <span class="token operator">|</span> v45 <span class="token operator">&amp;</span> <span class="token operator">~</span>v43<span class="token punctuation">)</span>
                                                                          <span class="token operator">+</span> <span class="token number">1163531501</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v48 <span class="token operator">=</span> v43 <span class="token operator">+</span> v130 <span class="token operator">+</span> <span class="token punctuation">(</span>v140 <span class="token operator">&amp;</span> v45 <span class="token operator">|</span> v47 <span class="token operator">&amp;</span> <span class="token operator">~</span>v45<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1444681467</span><span class="token punctuation">;</span>
  v49 <span class="token operator">=</span> v140 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">32</span> <span class="token operator">*</span> v48<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>v48 <span class="token operator">&gt;&gt;</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v50 <span class="token operator">=</span> v45 <span class="token operator">+</span> v119 <span class="token operator">+</span> <span class="token punctuation">(</span>v49 <span class="token operator">&amp;</span> v47 <span class="token operator">|</span> v140 <span class="token operator">&amp;</span> <span class="token operator">~</span>v47<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">51403784</span><span class="token punctuation">;</span>
  v51 <span class="token operator">=</span> v49 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v50 <span class="token operator">&lt;&lt;</span> <span class="token number">9</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>v50 <span class="token operator">&gt;&gt;</span> <span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v52 <span class="token operator">=</span> v47 <span class="token operator">+</span> v124 <span class="token operator">+</span> <span class="token punctuation">(</span>v140 <span class="token operator">&amp;</span> v51 <span class="token operator">|</span> v49 <span class="token operator">&amp;</span> <span class="token operator">~</span>v140<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1735328473</span><span class="token punctuation">;</span>
  v53 <span class="token operator">=</span> v51 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v52 <span class="token operator">&lt;&lt;</span> <span class="token number">14</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>v52 <span class="token operator">&gt;&gt;</span> <span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v54 <span class="token operator">=</span> v53
      <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>v140 <span class="token operator">+</span> v129 <span class="token operator">+</span> <span class="token punctuation">(</span>v49 <span class="token operator">&amp;</span> v53 <span class="token operator">|</span> v51 <span class="token operator">&amp;</span> <span class="token operator">~</span>v49<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1926607734</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">12</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v140
                                                                         <span class="token operator">+</span> v129
                                                                         <span class="token operator">+</span> <span class="token punctuation">(</span>v49 <span class="token operator">&amp;</span> v53 <span class="token operator">|</span> v51 <span class="token operator">&amp;</span> <span class="token operator">~</span>v49<span class="token punctuation">)</span>
                                                                         <span class="token operator">-</span> <span class="token number">1926607734</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v55 <span class="token operator">=</span> v49 <span class="token operator">+</span> v122 <span class="token operator">+</span> <span class="token punctuation">(</span>v54 <span class="token operator">^</span> v53 <span class="token operator">^</span> v51<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">378558</span><span class="token punctuation">;</span>
  v56 <span class="token operator">=</span> v54 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">16</span> <span class="token operator">*</span> v55<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>v55 <span class="token operator">&gt;&gt;</span> <span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v57 <span class="token operator">=</span> v56
      <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>v51 <span class="token operator">+</span> v125 <span class="token operator">+</span> <span class="token punctuation">(</span>v56 <span class="token operator">^</span> v54 <span class="token operator">^</span> v53<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">2022574463</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v51 <span class="token operator">+</span> v125 <span class="token operator">+</span> <span class="token punctuation">(</span>v56 <span class="token operator">^</span> v54 <span class="token operator">^</span> v53<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">2022574463</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v58 <span class="token operator">=</span> v57
      <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>v53 <span class="token operator">+</span> v128 <span class="token operator">+</span> <span class="token punctuation">(</span>v56 <span class="token operator">^</span> v54 <span class="token operator">^</span> v57<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1839030562</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v53 <span class="token operator">+</span> v128 <span class="token operator">+</span> <span class="token punctuation">(</span>v56 <span class="token operator">^</span> v54 <span class="token operator">^</span> v57<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1839030562</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v59 <span class="token operator">=</span> v54 <span class="token operator">+</span> v131 <span class="token operator">+</span> <span class="token punctuation">(</span>v56 <span class="token operator">^</span> v58 <span class="token operator">^</span> v57<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">35309556</span><span class="token punctuation">;</span>
  v60 <span class="token operator">=</span> v58 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v59 <span class="token operator">&gt;&gt;</span> <span class="token number">9</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>v59 <span class="token operator">&lt;&lt;</span> <span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v61 <span class="token operator">=</span> v56 <span class="token operator">+</span> v118 <span class="token operator">+</span> <span class="token punctuation">(</span>v60 <span class="token operator">^</span> v58 <span class="token operator">^</span> v57<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1530992060</span><span class="token punctuation">;</span>
  v62 <span class="token operator">=</span> v60 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">16</span> <span class="token operator">*</span> v61<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>v61 <span class="token operator">&gt;&gt;</span> <span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v63 <span class="token operator">=</span> v57 <span class="token operator">+</span> v121 <span class="token operator">+</span> <span class="token punctuation">(</span>v62 <span class="token operator">^</span> v60 <span class="token operator">^</span> v58<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1272893353</span><span class="token punctuation">;</span>
  v64 <span class="token operator">=</span> v62 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v63 <span class="token operator">&lt;&lt;</span> <span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>v63 <span class="token operator">&gt;&gt;</span> <span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v65 <span class="token operator">=</span> v58 <span class="token operator">+</span> v124 <span class="token operator">+</span> <span class="token punctuation">(</span>v62 <span class="token operator">^</span> v60 <span class="token operator">^</span> v64<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">155497632</span><span class="token punctuation">;</span>
  v66 <span class="token operator">=</span> v64 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v65 <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token function">HIWORD</span><span class="token punctuation">(</span>v65<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v67 <span class="token operator">=</span> v66
      <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>v60 <span class="token operator">+</span> v127 <span class="token operator">+</span> <span class="token punctuation">(</span>v62 <span class="token operator">^</span> v66 <span class="token operator">^</span> v64<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1094730640</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">9</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v60 <span class="token operator">+</span> v127 <span class="token operator">+</span> <span class="token punctuation">(</span>v62 <span class="token operator">^</span> v66 <span class="token operator">^</span> v64<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1094730640</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v68 <span class="token operator">=</span> v67
      <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">16</span> <span class="token operator">*</span> <span class="token punctuation">(</span>v62 <span class="token operator">+</span> v130 <span class="token operator">+</span> <span class="token punctuation">(</span>v67 <span class="token operator">^</span> v66 <span class="token operator">^</span> v64<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">681279174</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v62 <span class="token operator">+</span> v130 <span class="token operator">+</span> <span class="token punctuation">(</span>v67 <span class="token operator">^</span> v66 <span class="token operator">^</span> v64<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">681279174</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v69 <span class="token operator">=</span> v64 <span class="token operator">+</span> v117 <span class="token operator">+</span> <span class="token punctuation">(</span>v68 <span class="token operator">^</span> v67 <span class="token operator">^</span> v66<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">358537222</span><span class="token punctuation">;</span>
  v70 <span class="token operator">=</span> v68 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v69 <span class="token operator">&lt;&lt;</span> <span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>v69 <span class="token operator">&gt;&gt;</span> <span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v71 <span class="token operator">=</span> v66 <span class="token operator">+</span> v120 <span class="token operator">+</span> <span class="token punctuation">(</span>v68 <span class="token operator">^</span> v67 <span class="token operator">^</span> v70<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">722521979</span><span class="token punctuation">;</span>
  v72 <span class="token operator">=</span> v70 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v71 <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token function">HIWORD</span><span class="token punctuation">(</span>v71<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v73 <span class="token operator">=</span> v72 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>v67 <span class="token operator">+</span> v123 <span class="token operator">+</span> <span class="token punctuation">(</span>v68 <span class="token operator">^</span> v72 <span class="token operator">^</span> v70<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">76029189</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">9</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v67 <span class="token operator">+</span> v123 <span class="token operator">+</span> <span class="token punctuation">(</span>v68 <span class="token operator">^</span> v72 <span class="token operator">^</span> v70<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">76029189</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v74 <span class="token operator">=</span> v73
      <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">16</span> <span class="token operator">*</span> <span class="token punctuation">(</span>v68 <span class="token operator">+</span> v126 <span class="token operator">+</span> <span class="token punctuation">(</span>v73 <span class="token operator">^</span> v72 <span class="token operator">^</span> v70<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">640364487</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v68 <span class="token operator">+</span> v126 <span class="token operator">+</span> <span class="token punctuation">(</span>v73 <span class="token operator">^</span> v72 <span class="token operator">^</span> v70<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">640364487</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v75 <span class="token operator">=</span> v70 <span class="token operator">+</span> v129 <span class="token operator">+</span> <span class="token punctuation">(</span>v74 <span class="token operator">^</span> v73 <span class="token operator">^</span> v72<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">421815835</span><span class="token punctuation">;</span>
  v76 <span class="token operator">=</span> v74 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v75 <span class="token operator">&lt;&lt;</span> <span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>v75 <span class="token operator">&gt;&gt;</span> <span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v77 <span class="token operator">=</span> v72 <span class="token operator">+</span> v132 <span class="token operator">+</span> <span class="token punctuation">(</span>v74 <span class="token operator">^</span> v73 <span class="token operator">^</span> v76<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">530742520</span><span class="token punctuation">;</span>
  v78 <span class="token operator">=</span> v76 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v77 <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token function">HIWORD</span><span class="token punctuation">(</span>v77<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v79 <span class="token operator">=</span> v73 <span class="token operator">+</span> v119 <span class="token operator">+</span> <span class="token punctuation">(</span>v74 <span class="token operator">^</span> v78 <span class="token operator">^</span> v76<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">995338651</span><span class="token punctuation">;</span>
  v80 <span class="token operator">=</span> v78 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v79 <span class="token operator">&gt;&gt;</span> <span class="token number">9</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>v79 <span class="token operator">&lt;&lt;</span> <span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v81 <span class="token operator">=</span> v74 <span class="token operator">+</span> v117 <span class="token operator">+</span> <span class="token punctuation">(</span>v78 <span class="token operator">^</span> <span class="token punctuation">(</span>v80 <span class="token operator">|</span> <span class="token operator">~</span>v76<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">198630844</span><span class="token punctuation">;</span>
  v82 <span class="token operator">=</span> v80 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v81 <span class="token operator">&lt;&lt;</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>v81 <span class="token operator">&gt;&gt;</span> <span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v83 <span class="token operator">=</span> v76 <span class="token operator">+</span> v124 <span class="token operator">+</span> <span class="token punctuation">(</span>v80 <span class="token operator">^</span> <span class="token punctuation">(</span>v82 <span class="token operator">|</span> <span class="token operator">~</span>v78<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1126891415</span><span class="token punctuation">;</span>
  v84 <span class="token operator">=</span> v82 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v83 <span class="token operator">&lt;&lt;</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>v83 <span class="token operator">&gt;&gt;</span> <span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v85 <span class="token operator">=</span> v78 <span class="token operator">+</span> v131 <span class="token operator">+</span> <span class="token punctuation">(</span>v82 <span class="token operator">^</span> <span class="token punctuation">(</span>v84 <span class="token operator">|</span> <span class="token operator">~</span>v80<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1416354905</span><span class="token punctuation">;</span>
  v86 <span class="token operator">=</span> v84 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v85 <span class="token operator">&lt;&lt;</span> <span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>v85 <span class="token operator">&gt;&gt;</span> <span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v87 <span class="token operator">=</span> v80 <span class="token operator">+</span> v122 <span class="token operator">+</span> <span class="token punctuation">(</span>v84 <span class="token operator">^</span> <span class="token punctuation">(</span>v86 <span class="token operator">|</span> <span class="token operator">~</span>v82<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">57434055</span><span class="token punctuation">;</span>
  v88 <span class="token operator">=</span> v86 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v87 <span class="token operator">&gt;&gt;</span> <span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>v87 <span class="token operator">&lt;&lt;</span> <span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v89 <span class="token operator">=</span> v82 <span class="token operator">+</span> v129 <span class="token operator">+</span> <span class="token punctuation">(</span>v86 <span class="token operator">^</span> <span class="token punctuation">(</span>v88 <span class="token operator">|</span> <span class="token operator">~</span>v84<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1700485571</span><span class="token punctuation">;</span>
  v90 <span class="token operator">=</span> v88 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v89 <span class="token operator">&lt;&lt;</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>v89 <span class="token operator">&gt;&gt;</span> <span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v91 <span class="token operator">=</span> v84 <span class="token operator">+</span> v120 <span class="token operator">+</span> <span class="token punctuation">(</span>v88 <span class="token operator">^</span> <span class="token punctuation">(</span>v90 <span class="token operator">|</span> <span class="token operator">~</span>v86<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1894986606</span><span class="token punctuation">;</span>
  v92 <span class="token operator">=</span> v90 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v91 <span class="token operator">&lt;&lt;</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>v91 <span class="token operator">&gt;&gt;</span> <span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v93 <span class="token operator">=</span> v86 <span class="token operator">+</span> v127 <span class="token operator">+</span> <span class="token punctuation">(</span>v90 <span class="token operator">^</span> <span class="token punctuation">(</span>v92 <span class="token operator">|</span> <span class="token operator">~</span>v88<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1051523</span><span class="token punctuation">;</span>
  v94 <span class="token operator">=</span> v92 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v93 <span class="token operator">&lt;&lt;</span> <span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>v93 <span class="token operator">&gt;&gt;</span> <span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v95 <span class="token operator">=</span> v88 <span class="token operator">+</span> v118 <span class="token operator">+</span> <span class="token punctuation">(</span>v92 <span class="token operator">^</span> <span class="token punctuation">(</span>v94 <span class="token operator">|</span> <span class="token operator">~</span>v90<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">2054922799</span><span class="token punctuation">;</span>
  v96 <span class="token operator">=</span> v94 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v95 <span class="token operator">&gt;&gt;</span> <span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>v95 <span class="token operator">&lt;&lt;</span> <span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v97 <span class="token operator">=</span> v90 <span class="token operator">+</span> v125 <span class="token operator">+</span> <span class="token punctuation">(</span>v94 <span class="token operator">^</span> <span class="token punctuation">(</span>v96 <span class="token operator">|</span> <span class="token operator">~</span>v92<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1873313359</span><span class="token punctuation">;</span>
  v98 <span class="token operator">=</span> v96 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v97 <span class="token operator">&lt;&lt;</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>v97 <span class="token operator">&gt;&gt;</span> <span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v99 <span class="token operator">=</span> v92 <span class="token operator">+</span> v132 <span class="token operator">+</span> <span class="token punctuation">(</span>v96 <span class="token operator">^</span> <span class="token punctuation">(</span>v98 <span class="token operator">|</span> <span class="token operator">~</span>v94<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">30611744</span><span class="token punctuation">;</span>
  v100 <span class="token operator">=</span> v98 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v99 <span class="token operator">&lt;&lt;</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>v99 <span class="token operator">&gt;&gt;</span> <span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v101 <span class="token operator">=</span> v94 <span class="token operator">+</span> v123 <span class="token operator">+</span> <span class="token punctuation">(</span>v98 <span class="token operator">^</span> <span class="token punctuation">(</span>v100 <span class="token operator">|</span> <span class="token operator">~</span>v96<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1560198380</span><span class="token punctuation">;</span>
  v102 <span class="token operator">=</span> v100 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v101 <span class="token operator">&lt;&lt;</span> <span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>v101 <span class="token operator">&gt;&gt;</span> <span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v103 <span class="token operator">=</span> v96 <span class="token operator">+</span> v130 <span class="token operator">+</span> <span class="token punctuation">(</span>v100 <span class="token operator">^</span> <span class="token punctuation">(</span>v102 <span class="token operator">|</span> <span class="token operator">~</span>v98<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1309151649</span><span class="token punctuation">;</span>
  v104 <span class="token operator">=</span> v102 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v103 <span class="token operator">&gt;&gt;</span> <span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>v103 <span class="token operator">&lt;&lt;</span> <span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v105 <span class="token operator">=</span> v98 <span class="token operator">+</span> v121 <span class="token operator">+</span> <span class="token punctuation">(</span>v102 <span class="token operator">^</span> <span class="token punctuation">(</span>v104 <span class="token operator">|</span> <span class="token operator">~</span>v100<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">145523070</span><span class="token punctuation">;</span>
  v106 <span class="token operator">=</span> v104 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v105 <span class="token operator">&lt;&lt;</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>v105 <span class="token operator">&gt;&gt;</span> <span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v107 <span class="token operator">=</span> v100 <span class="token operator">+</span> v128 <span class="token operator">+</span> <span class="token punctuation">(</span>v104 <span class="token operator">^</span> <span class="token punctuation">(</span>v106 <span class="token operator">|</span> <span class="token operator">~</span>v102<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1120210379</span><span class="token punctuation">;</span>
  v108 <span class="token operator">=</span> v106 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v107 <span class="token operator">&lt;&lt;</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>v107 <span class="token operator">&gt;&gt;</span> <span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v109 <span class="token operator">=</span> v102 <span class="token operator">+</span> v119 <span class="token operator">+</span> <span class="token punctuation">(</span>v106 <span class="token operator">^</span> <span class="token punctuation">(</span>v108 <span class="token operator">|</span> <span class="token operator">~</span>v104<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">718787259</span><span class="token punctuation">;</span>
  v110 <span class="token operator">=</span> v108 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v109 <span class="token operator">&lt;&lt;</span> <span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>v109 <span class="token operator">&gt;&gt;</span> <span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v111 <span class="token operator">=</span> v110 <span class="token operator">+</span> a1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  v112 <span class="token operator">=</span> v104 <span class="token operator">+</span> v126 <span class="token operator">+</span> <span class="token punctuation">(</span>v108 <span class="token operator">^</span> <span class="token punctuation">(</span>v110 <span class="token operator">|</span> <span class="token operator">~</span>v106<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">343485551</span><span class="token punctuation">;</span>
  v113 <span class="token operator">=</span> v106 <span class="token operator">+</span> <span class="token operator">*</span>a1<span class="token punctuation">;</span>
  v114 <span class="token operator">=</span> v110 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v112 <span class="token operator">&gt;&gt;</span> <span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>v112 <span class="token operator">&lt;&lt;</span> <span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v115 <span class="token operator">=</span> v108 <span class="token operator">+</span> a1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  a1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+=</span> v114<span class="token punctuation">;</span>
  <span class="token operator">*</span>a1 <span class="token operator">=</span> v113<span class="token punctuation">;</span>
  a1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> v111<span class="token punctuation">;</span>
  a1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> v115<span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token function">sub_401E10</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v117<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token comment">// MD5_Final</span>
<span class="token keyword">int</span> __cdecl <span class="token function">sub_401390</span><span class="token punctuation">(</span><span class="token keyword">int</span> a1<span class="token punctuation">,</span> <span class="token keyword">int</span> a2<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v2<span class="token punctuation">;</span> <span class="token comment">// eax</span>
  <span class="token keyword">int</span> v3<span class="token punctuation">;</span> <span class="token comment">// ecx</span>
  <span class="token keyword">char</span> v5<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [esp+8h] [ebp-8h] BYREF</span>

  <span class="token function">sub_401D50</span><span class="token punctuation">(</span>v5<span class="token punctuation">,</span> a2 <span class="token operator">+</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>a2 <span class="token operator">+</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x3F</span><span class="token punctuation">;</span>
  v3 <span class="token operator">=</span> <span class="token number">56</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> v2 <span class="token operator">&gt;=</span> <span class="token number">0x38</span> <span class="token punctuation">)</span>
    v3 <span class="token operator">=</span> <span class="token number">120</span><span class="token punctuation">;</span>
  <span class="token function">sub_4012E0</span><span class="token punctuation">(</span>a2<span class="token punctuation">,</span> <span class="token operator">&amp;</span>unk_407030<span class="token punctuation">,</span> v3 <span class="token operator">-</span> v2<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">sub_4012E0</span><span class="token punctuation">(</span>a2<span class="token punctuation">,</span> v5<span class="token punctuation">,</span> <span class="token number">8u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">sub_401D50</span><span class="token punctuation">(</span>a1<span class="token punctuation">,</span> a2<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token function">sub_401E10</span><span class="token punctuation">(</span>a2<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">88</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">int</span> __cdecl <span class="token function">sub_4012E0</span><span class="token punctuation">(</span><span class="token keyword">int</span> a1<span class="token punctuation">,</span> <span class="token keyword">int</span> a2<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span> a3<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v3<span class="token punctuation">;</span> <span class="token comment">// ecx</span>
  <span class="token keyword">int</span> v4<span class="token punctuation">;</span> <span class="token comment">// eax</span>
  <span class="token keyword">int</span> v5<span class="token punctuation">;</span> <span class="token comment">// ebx</span>
  <span class="token keyword">int</span> v6<span class="token punctuation">;</span> <span class="token comment">// ebp</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment">// ebx</span>

  v3 <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>a1 <span class="token operator">+</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">8</span> <span class="token operator">*</span> a3<span class="token punctuation">;</span>
  v4 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>a1 <span class="token operator">+</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x3F</span><span class="token punctuation">;</span>
  <span class="token operator">*</span><span class="token punctuation">(</span>a1 <span class="token operator">+</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">=</span> v3<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> v3 <span class="token operator">&lt;</span> <span class="token number">8</span> <span class="token operator">*</span> a3 <span class="token punctuation">)</span>
    <span class="token operator">++</span><span class="token operator">*</span><span class="token punctuation">(</span>a1 <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token operator">*</span><span class="token punctuation">(</span>a1 <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">+=</span> a3 <span class="token operator">&gt;&gt;</span> <span class="token number">29</span><span class="token punctuation">;</span>
  v5 <span class="token operator">=</span> <span class="token number">64</span> <span class="token operator">-</span> v4<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> a3 <span class="token operator">&lt;</span> <span class="token number">64</span> <span class="token operator">-</span> v4 <span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    v6 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">else</span>
  <span class="token punctuation">{</span>
    <span class="token function">sub_401DF0</span><span class="token punctuation">(</span>v4 <span class="token operator">+</span> a1 <span class="token operator">+</span> <span class="token number">24</span><span class="token punctuation">,</span> a2<span class="token punctuation">,</span> <span class="token number">64</span> <span class="token operator">-</span> v4<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">sub_401400</span><span class="token punctuation">(</span>a1<span class="token punctuation">,</span> a1 <span class="token operator">+</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    v6 <span class="token operator">=</span> v5<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> v5 <span class="token operator">+</span> <span class="token number">63</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> a3<span class="token punctuation">;</span> v6 <span class="token operator">+=</span> <span class="token number">64</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token function">sub_401400</span><span class="token punctuation">(</span>a1<span class="token punctuation">,</span> a2 <span class="token operator">+</span> i <span class="token operator">-</span> <span class="token number">63</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      i <span class="token operator">+=</span> <span class="token number">64</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    v4 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token function">sub_401DF0</span><span class="token punctuation">(</span>v4 <span class="token operator">+</span> a1 <span class="token operator">+</span> <span class="token number">24</span><span class="token punctuation">,</span> a2 <span class="token operator">+</span> v6<span class="token punctuation">,</span> a3 <span class="token operator">-</span> v6<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h1 id="DES"><a href="#DES" class="headerlink" title="DES"></a>DES</h1><blockquote><p>DES åŠ å¯†ï¼Œå³å³æ•°æ®åŠ å¯†æ ‡å‡†ï¼ˆData Encryption Standardï¼‰ï¼Œå±äºå¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œæ˜¯ä¸€ç§ä½¿ç”¨å¯†é’¥åŠ å¯†çš„åˆ†ç»„ç®—æ³•</p><p>å‚è€ƒæ–‡çŒ®ï¼š</p><ol><li><a target="_blank" rel="noopener" href="https://bbs.kanxue.com/thread-265939.htm#msg_header_h1_6">[åŸåˆ›]é€†å‘ä¸­å¸¸è§çš„Hashç®—æ³•å’Œå¯¹ç§°åŠ å¯†ç®—æ³•çš„åˆ†æ-å¯†ç åº”ç”¨-çœ‹é›ª-å®‰å…¨ç¤¾åŒº|å®‰å…¨æ‹›è˜|kanxue.com</a></li><li><a target="_blank" rel="noopener" href="https://bbs.kanxue.com/thread-269299.htm#msg_header_h1_2">[åˆ†äº«]DESåŠ å¯†-å¯†ç åº”ç”¨-çœ‹é›ª-å®‰å…¨ç¤¾åŒº|å®‰å…¨æ‹›è˜|kanxue.com</a></li></ol></blockquote><h2 id="ç‰¹ç‚¹-6"><a href="#ç‰¹ç‚¹-6" class="headerlink" title="ç‰¹ç‚¹"></a>ç‰¹ç‚¹</h2><ol><li><p>Key ä¸º 8 å­—èŠ‚å…± 64 ä½ï¼ˆå®é™…ä½¿ç”¨ 56 ä½ï¼‰ï¼Œæ˜æ–‡æˆ–å¯†æ–‡ä¹Ÿä¸º 8 å­—èŠ‚ 64 ä½</p></li><li><p>DES ç®—æ³•ä¸€èˆ¬æœ‰ä¸¤ä¸ªå…³é”®ç‚¹ï¼šåŠ å¯†ç®—æ³•å’Œæ•°æ®è¡¥ä½</p></li><li><p>å­˜åœ¨ 8 ä¸ªç½®æ¢ç›’ <code>S1 ~ S8</code></p></li></ol><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> S1<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>
             <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>
             <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
 
<span class="token keyword">int</span> S2<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>
             <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>
             <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>
            <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
 
<span class="token keyword">int</span> S3<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>
            <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>
             <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
 
<span class="token keyword">int</span> S4<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>
            <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>
            <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>
             <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
 
<span class="token keyword">int</span> S5<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>
            <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>
             <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>
            <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
 
<span class="token keyword">int</span> S6<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>
            <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>
             <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>
             <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
 
<span class="token keyword">int</span> S7<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>
             <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>
             <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
 
<span class="token keyword">int</span> S8<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>
             <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>
             <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>
             <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blog-markdown-1317553172.cos.ap-nanjing.myqcloud.com/%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95%E7%9A%84%E5%87%BD%E6%95%B0%E7%89%B9%E5%BE%8111.png" alt="åŠ å¯†ç®—æ³•çš„å‡½æ•°ç‰¹å¾11.png"></p><hr><h2 id="åŸç†-6"><a href="#åŸç†-6" class="headerlink" title="åŸç†"></a>åŸç†</h2><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blog-markdown-1317553172.cos.ap-nanjing.myqcloud.com/%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95%E7%9A%84%E5%87%BD%E6%95%B0%E7%89%B9%E5%BE%8110.png" alt="åŠ å¯†ç®—æ³•çš„å‡½æ•°ç‰¹å¾10.png"></p><hr><h2 id="åŠ è§£å¯†ä»£ç -5"><a href="#åŠ è§£å¯†ä»£ç -5" class="headerlink" title="åŠ è§£å¯†ä»£ç "></a>åŠ è§£å¯†ä»£ç </h2><h3 id="Python-ç‰ˆï¼ˆCBC-æ¨¡å¼ï¼‰"><a href="#Python-ç‰ˆï¼ˆCBC-æ¨¡å¼ï¼‰" class="headerlink" title="Python ç‰ˆï¼ˆCBC æ¨¡å¼ï¼‰"></a>Python ç‰ˆï¼ˆCBC æ¨¡å¼ï¼‰</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pyDes <span class="token keyword">import</span> des<span class="token punctuation">,</span> CBC<span class="token punctuation">,</span> PAD_PKCS5  
<span class="token keyword">import</span> binascii  
  
key <span class="token operator">=</span> <span class="token string">'hi_uf4te'</span>  <span class="token comment"># ç§˜é’¥, 8 ä½  </span>
iv <span class="token operator">=</span> <span class="token string">'uf4te!!!'</span>  <span class="token comment"># åç§»é‡ iv, 8 ä½  </span>
  
  
<span class="token keyword">def</span> <span class="token function">des_encrypt</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>  
    <span class="token comment"># key : åŠ å¯†å¯†é’¥, CBC : åŠ å¯†æ¨¡å¼ï¼Œiv : åç§», padmode : å¡«å……  </span>
    des_obj <span class="token operator">=</span> des<span class="token punctuation">(</span>key<span class="token punctuation">,</span> CBC<span class="token punctuation">,</span> iv<span class="token punctuation">,</span> pad<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> padmode<span class="token operator">=</span>PAD_PKCS5<span class="token punctuation">)</span>  
    <span class="token comment"># è¿”å›ä¸ºå­—èŠ‚  </span>
    secret_bytes <span class="token operator">=</span> des_obj<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>s<span class="token punctuation">,</span> padmode<span class="token operator">=</span>PAD_PKCS5<span class="token punctuation">)</span>  
    <span class="token comment"># å°†å­—èŠ‚å¯¹è±¡è½¬æ¢ä¸ºåå…­è¿›åˆ¶å­—ç¬¦ä¸²  </span>
    <span class="token keyword">return</span> binascii<span class="token punctuation">.</span>b2a_hex<span class="token punctuation">(</span>secret_bytes<span class="token punctuation">)</span>  
  
  
<span class="token keyword">def</span> <span class="token function">des_descrypt</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>  
    <span class="token comment"># key : åŠ å¯†å¯†é’¥, CBC : åŠ å¯†æ¨¡å¼ï¼Œiv : åç§», padmode : å¡«å……  </span>
    des_obj <span class="token operator">=</span> des<span class="token punctuation">(</span>key<span class="token punctuation">,</span> CBC<span class="token punctuation">,</span> iv<span class="token punctuation">,</span> pad<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> padmode<span class="token operator">=</span>PAD_PKCS5<span class="token punctuation">)</span>  
    decrypt_str <span class="token operator">=</span> des_obj<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>binascii<span class="token punctuation">.</span>a2b_hex<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">,</span> padmode<span class="token operator">=</span>PAD_PKCS5<span class="token punctuation">)</span>  
    <span class="token keyword">return</span> decrypt_str  
  
  
text <span class="token operator">=</span> <span class="token string">b'welcome_to_uf4te'</span>  <span class="token comment"># åŠ è§£å¯†å†…å®¹  </span>
  
enc <span class="token operator">=</span> des_encrypt<span class="token punctuation">(</span>text<span class="token punctuation">)</span>  <span class="token comment"># DES åŠ å¯†ï¼Œç»“æœä¸º 16 è¿›åˆ¶å­—èŠ‚æµ  </span>
<span class="token keyword">print</span><span class="token punctuation">(</span>enc<span class="token punctuation">)</span>  
  
dec <span class="token operator">=</span> des_descrypt<span class="token punctuation">(</span>enc<span class="token punctuation">)</span>  <span class="token comment"># DES è§£å¯†  </span>
<span class="token keyword">print</span><span class="token punctuation">(</span>dec<span class="token punctuation">)</span>


<span class="token triple-quoted-string string">''' è¾“å‡ºï¼š
b'54576e252cc9973824e53ea43eb28489b3bb662a97e07165'
b'welcome_to_uf4te'
'''</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Python-ç‰ˆï¼ˆECB-æ¨¡å¼ï¼‰"><a href="#Python-ç‰ˆï¼ˆECB-æ¨¡å¼ï¼‰" class="headerlink" title="Python ç‰ˆï¼ˆECB æ¨¡å¼ï¼‰"></a>Python ç‰ˆï¼ˆECB æ¨¡å¼ï¼‰</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> DES
<span class="token keyword">import</span> binascii

key <span class="token operator">=</span> <span class="token string">b'hi_uf4te'</span>  <span class="token comment"># å¯†é’¥ 8 ä½æˆ– 16 ä½,å¿…é¡»ä¸º bytes ç±»å‹</span>
text <span class="token operator">=</span> <span class="token string">'welcome_to_uf4te'</span>


<span class="token keyword">def</span> <span class="token function">pad</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># å¦‚æœ text ä¸æ˜¯ 8 çš„å€æ•°ã€åŠ å¯†æ–‡æœ¬ text å¿…é¡»ä¸º 8 çš„å€æ•°ï¼ã€‘ï¼Œè¡¥è¶³ä¸º 8 çš„å€æ•°</span>
    <span class="token keyword">while</span> <span class="token builtin">len</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">8</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>
        text <span class="token operator">+=</span> <span class="token string">' '</span>
    <span class="token keyword">return</span> text


des <span class="token operator">=</span> DES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> DES<span class="token punctuation">.</span>MODE_ECB<span class="token punctuation">)</span>  <span class="token comment"># åˆ›å»º DES å®ä¾‹</span>
padded_text <span class="token operator">=</span> pad<span class="token punctuation">(</span>text<span class="token punctuation">)</span>   <span class="token comment"># å¡«å……</span>

enc <span class="token operator">=</span> des<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>padded_text<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># åŠ å¯†ï¼Œç»“æœä¸º 16 è¿›åˆ¶å­—èŠ‚æµ</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>binascii<span class="token punctuation">.</span>b2a_hex<span class="token punctuation">(</span>enc<span class="token punctuation">)</span><span class="token punctuation">)</span>   <span class="token comment"># å°†å­—èŠ‚å¯¹è±¡è½¬æ¢ä¸ºåå…­è¿›åˆ¶å­—ç¬¦ä¸²</span>

dec <span class="token operator">=</span> des<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>enc<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>rstrip<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span>  <span class="token comment"># è§£å¯†</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>dec<span class="token punctuation">)</span>


<span class="token triple-quoted-string string">''' è¾“å‡ºï¼š
b'8c8641d37affbc2b251cbd968cb124a8'
welcome_to_uf4te
'''</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h1 id="AES"><a href="#AES" class="headerlink" title="AES"></a>AES</h1><blockquote><p>AES åŠ å¯†ï¼Œå³é«˜çº§åŠ å¯†æ ‡å‡†ï¼ˆAdvanced Encryption Standardï¼‰ï¼Œå±äºå¯¹ç§°åŠ å¯†ç®—æ³•ï¼ŒåŸºäºæ•°æ®å—çš„åŠ å¯†æ–¹å¼ï¼šåˆ†ç»„è¾“å…¥ã€åˆ†ç»„è¾“å‡ºï¼Œè¯¥ç®—æ³•å·²è¢«ç”¨æ¥æ›¿ä»£ DES ç®—æ³•ï¼Œå¹¶åœ¨ä¸–ç•ŒèŒƒå›´å†…å¹¿æ³›ä½¿ç”¨</p><p>AES åŠ å¯†ç®—æ³•çš„é€Ÿåº¦æ¯”å…¬é’¥åŠ å¯†ç­‰åŠ å¯†ç®—æ³•å¿«å¾ˆå¤šï¼Œåœ¨å¾ˆå¤šåœºåˆéƒ½éœ€è¦ AES å¯¹ç§°åŠ å¯†ï¼Œä¸»è¦ç¼ºç‚¹åœ¨äºè¦æ±‚åŠ å¯†å’Œè§£å¯†åŒæ–¹éƒ½ä½¿ç”¨ç›¸åŒçš„å¯†é’¥</p><p>å‚è€ƒæ–‡çŒ®ï¼š</p><ol><li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/Hellowshuo/p/15706590.html">pythonå®ç°AESåŠ å¯†è§£å¯† - Hello_wshuo - åšå®¢å›­</a></li><li><a target="_blank" rel="noopener" href="https://blog.csdn.net/abel_big_xu/article/details/115703082">é€†å‘åˆ†æä¸­çš„å¯†ç å­¦â€”AES_0x01 0x02 0x04 0x08æ˜¯ä»€ä¹ˆæ„æ€-CSDNåšå®¢</a></li></ol></blockquote><h2 id="ç‰¹ç‚¹-7"><a href="#ç‰¹ç‚¹-7" class="headerlink" title="ç‰¹ç‚¹"></a>ç‰¹ç‚¹</h2><ol><li>AES æŒ‰ç…§å¯†é’¥çš„é•¿åº¦å¯ä»¥åˆ†ä¸ºï¼šAES-128ã€AES-192ã€AES-256 ä¸‰ç§</li></ol><table><thead><tr><th></th><th>å¯†é’¥é•¿åº¦</th><th>åˆ†ç»„é•¿åº¦</th><th>è½®æ•°</th></tr></thead><tbody><tr><td>AES-128</td><td>128 bit</td><td>4 bit</td><td>10 è½®</td></tr><tr><td>AES-192</td><td>192 bit</td><td>4 bit</td><td>12 è½®</td></tr><tr><td>AES-256</td><td>256 bit</td><td>4 bit</td><td>14 è½®</td></tr></tbody></table><ol start="2"><li>åŠ è§£å¯†çš„å­—èŠ‚æ›¿ä»£è¿‡ç¨‹ä¸­ä½¿ç”¨äº† <code>s_box</code> å’Œé€† <code>s_box</code> å®Œæˆä¸€ä¸ªå­—èŠ‚åˆ°å¦ä¸€ä¸ªå­—èŠ‚çš„æ˜ å°„</li></ol><p><code>s</code> ç›’ï¼š</p><table><thead><tr><th>è¡Œ/åˆ—</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th><th>A</th><th>B</th><th>C</th><th>D</th><th>E</th><th>F</th></tr></thead><tbody><tr><td>0</td><td>0x63</td><td>0x7c</td><td>0x77</td><td>0x7b</td><td>0xf2</td><td>0x6b</td><td>0x6f</td><td>0xc5</td><td>0x30</td><td>0x01</td><td>0x67</td><td>0x2b</td><td>0xfe</td><td>0xd7</td><td>0xab</td><td>0x76</td></tr><tr><td>1</td><td>0xca</td><td>0x82</td><td>0xc9</td><td>0x7d</td><td>0xfa</td><td>0x59</td><td>0x47</td><td>0xf0</td><td>0xad</td><td>0xd4</td><td>0xa2</td><td>0xaf</td><td>0x9c</td><td>0xa4</td><td>0x72</td><td>0xc0</td></tr><tr><td>2</td><td>0xb7</td><td>0xfd</td><td>0x93</td><td>0x26</td><td>0x36</td><td>0x3f</td><td>0xf7</td><td>0xcc</td><td>0x34</td><td>0xa5</td><td>0xe5</td><td>0xf1</td><td>0x71</td><td>0xd8</td><td>0x31</td><td>0x15</td></tr><tr><td>3</td><td>0x04</td><td>0xc7</td><td>0x23</td><td>0xc3</td><td>0x18</td><td>0x96</td><td>0x05</td><td>0x9a</td><td>0x07</td><td>0x12</td><td>0x80</td><td>0xe2</td><td>0xeb</td><td>0x27</td><td>0xb2</td><td>0x75</td></tr><tr><td>4</td><td>0x09</td><td>0x83</td><td>0x2c</td><td>0x1a</td><td>0x1b</td><td>0x6e</td><td>0x5a</td><td>0xa0</td><td>0x52</td><td>0x3b</td><td>0xd6</td><td>0xb3</td><td>0x29</td><td>0xe3</td><td>0x2f</td><td>0x84</td></tr><tr><td>5</td><td>0x53</td><td>0xd1</td><td>0x00</td><td>0xed</td><td>0x20</td><td>0xfc</td><td>0xb1</td><td>0x5b</td><td>0x6a</td><td>0xcb</td><td>0xbe</td><td>0x39</td><td>0x4a</td><td>0x4c</td><td>0x58</td><td>0xcf</td></tr><tr><td>6</td><td>0xd0</td><td>0xef</td><td>0xaa</td><td>0xfb</td><td>0x43</td><td>0x4d</td><td>0x33</td><td>0x85</td><td>0x45</td><td>0xf9</td><td>0x02</td><td>0x7f</td><td>0x50</td><td>0x3c</td><td>0x9f</td><td>0xa8</td></tr><tr><td>7</td><td>0x51</td><td>0xa3</td><td>0x40</td><td>0x8f</td><td>0x92</td><td>0x9d</td><td>0x38</td><td>0xf5</td><td>0xbc</td><td>0xb6</td><td>0xda</td><td>0x21</td><td>0x10</td><td>0xff</td><td>0xf3</td><td>0xd2</td></tr><tr><td>8</td><td>0xcd</td><td>0x0c</td><td>0x13</td><td>0xec</td><td>0x5f</td><td>0x97</td><td>0x44</td><td>0x17</td><td>0xc4</td><td>0xa7</td><td>0x7e</td><td>0x3d</td><td>0x64</td><td>0x5d</td><td>0x19</td><td>0x73</td></tr><tr><td>9</td><td>0x60</td><td>0x81</td><td>0x4f</td><td>0xdc</td><td>0x22</td><td>0x2a</td><td>0x90</td><td>0x88</td><td>0x46</td><td>0xee</td><td>0xb8</td><td>0x14</td><td>0xde</td><td>0x5e</td><td>0x0b</td><td>0xdb</td></tr><tr><td>A</td><td>0xe0</td><td>0x32</td><td>0x3a</td><td>0x0a</td><td>0x49</td><td>0x06</td><td>0x24</td><td>0x5c</td><td>0xc2</td><td>0xd3</td><td>0xac</td><td>0x62</td><td>0x91</td><td>0x95</td><td>0xe4</td><td>0x79</td></tr><tr><td>B</td><td>0xe7</td><td>0xc8</td><td>0x37</td><td>0x6d</td><td>0x8d</td><td>0xd5</td><td>0x4e</td><td>0xa9</td><td>0x6c</td><td>0x56</td><td>0xf4</td><td>0xea</td><td>0x65</td><td>0x7a</td><td>0xae</td><td>0x08</td></tr><tr><td>C</td><td>0xba</td><td>0x78</td><td>0x25</td><td>0x2e</td><td>0x1c</td><td>0xa6</td><td>0xb4</td><td>0xc6</td><td>0xe8</td><td>0xdd</td><td>0x74</td><td>0x1f</td><td>0x4b</td><td>0xbd</td><td>0x8b</td><td>0x8a</td></tr><tr><td>D</td><td>0x70</td><td>0x3e</td><td>0xb5</td><td>0x66</td><td>0x48</td><td>0x03</td><td>0xf6</td><td>0x0e</td><td>0x61</td><td>0x35</td><td>0x57</td><td>0xb9</td><td>0x86</td><td>0xc1</td><td>0x1d</td><td>0x9e</td></tr><tr><td>E</td><td>0xe1</td><td>0xf8</td><td>0x98</td><td>0x11</td><td>0x69</td><td>0xd9</td><td>0x8e</td><td>0x94</td><td>0x9b</td><td>0x1e</td><td>0x87</td><td>0xe9</td><td>0xce</td><td>0x55</td><td>0x28</td><td>0xdf</td></tr><tr><td>F</td><td>0x8c</td><td>0xa1</td><td>0x89</td><td>0x0d</td><td>0xbf</td><td>0xe6</td><td>0x42</td><td>0x68</td><td>0x41</td><td>0x99</td><td>0x2d</td><td>0x0f</td><td>0xb0</td><td>0x54</td><td>0xbb</td><td>0x16</td></tr></tbody></table><p>é€† <code>s</code> ç›’ï¼š</p><table><thead><tr><th>è¡Œ/åˆ—</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th><th>A</th><th>B</th><th>C</th><th>D</th><th>E</th><th>F</th></tr></thead><tbody><tr><td>0</td><td>0x52</td><td>0x09</td><td>0x6a</td><td>0xd5</td><td>0x30</td><td>0x36</td><td>0xa5</td><td>0x38</td><td>0xbf</td><td>0x40</td><td>0xa3</td><td>0x9e</td><td>0x81</td><td>0xf3</td><td>0xd7</td><td>0xfb</td></tr><tr><td>1</td><td>0x7c</td><td>0xe3</td><td>0x39</td><td>0x82</td><td>0x9b</td><td>0x2f</td><td>0xff</td><td>0x87</td><td>0x34</td><td>0x8e</td><td>0x43</td><td>0x44</td><td>0xc4</td><td>0xde</td><td>0xe9</td><td>0xcb</td></tr><tr><td>2</td><td>0x54</td><td>0x7b</td><td>0x94</td><td>0x32</td><td>0xa6</td><td>0xc2</td><td>0x23</td><td>0x3d</td><td>0xee</td><td>0x4c</td><td>0x95</td><td>0x0b</td><td>0x42</td><td>0xfa</td><td>0xc3</td><td>0x4e</td></tr><tr><td>3</td><td>0x08</td><td>0x2e</td><td>0xa1</td><td>0x66</td><td>0x28</td><td>0xd9</td><td>0x24</td><td>0xb2</td><td>0x76</td><td>0x5b</td><td>0xa2</td><td>0x49</td><td>0x6d</td><td>0x8b</td><td>0xd1</td><td>0x25</td></tr><tr><td>4</td><td>0x72</td><td>0xf8</td><td>0xf6</td><td>0x64</td><td>0x86</td><td>0x68</td><td>0x98</td><td>0x16</td><td>0xd4</td><td>0xa4</td><td>0x5c</td><td>0xcc</td><td>0x5d</td><td>0x65</td><td>0xb6</td><td>0x92</td></tr><tr><td>5</td><td>0x6c</td><td>0x70</td><td>0x48</td><td>0x50</td><td>0xfd</td><td>0xed</td><td>0xb9</td><td>0xda</td><td>0x5e</td><td>0x15</td><td>0x46</td><td>0x57</td><td>0xa7</td><td>0x8d</td><td>0x9d</td><td>0x84</td></tr><tr><td>6</td><td>0x90</td><td>0xd8</td><td>0xab</td><td>0x00</td><td>0x8c</td><td>0xbc</td><td>0xd3</td><td>0x0a</td><td>0xf7</td><td>0xe4</td><td>0x58</td><td>0x05</td><td>0xb8</td><td>0xb3</td><td>0x45</td><td>0x06</td></tr><tr><td>7</td><td>0xd0</td><td>0x2c</td><td>0x1e</td><td>0x8f</td><td>0xca</td><td>0x3f</td><td>0x0f</td><td>0x02</td><td>0xc1</td><td>0xaf</td><td>0xbd</td><td>0x03</td><td>0x01</td><td>0x13</td><td>0x8a</td><td>0x6b</td></tr><tr><td>8</td><td>0x3a</td><td>0x91</td><td>0x11</td><td>0x41</td><td>0x4f</td><td>0x67</td><td>0xdc</td><td>0xea</td><td>0x97</td><td>0xf2</td><td>0xcf</td><td>0xce</td><td>0xf0</td><td>0xb4</td><td>0xe6</td><td>0x73</td></tr><tr><td>9</td><td>0x96</td><td>0xac</td><td>0x74</td><td>0x22</td><td>0xe7</td><td>0xad</td><td>0x35</td><td>0x85</td><td>0xe2</td><td>0xf9</td><td>0x37</td><td>0xe8</td><td>0x1c</td><td>0x75</td><td>0xdf</td><td>0x6e</td></tr><tr><td>A</td><td>0x47</td><td>0xf1</td><td>0x1a</td><td>0x71</td><td>0x1d</td><td>0x29</td><td>0xc5</td><td>0x89</td><td>0x6f</td><td>0xb7</td><td>0x62</td><td>0x0e</td><td>0xaa</td><td>0x18</td><td>0xbe</td><td>0x1b</td></tr><tr><td>B</td><td>0xfc</td><td>0x56</td><td>0x3e</td><td>0x4b</td><td>0xc6</td><td>0xd2</td><td>0x79</td><td>0x20</td><td>0x9a</td><td>0xdb</td><td>0xc0</td><td>0xfe</td><td>0x78</td><td>0xcd</td><td>0x5a</td><td>0xf4</td></tr><tr><td>C</td><td>0x1f</td><td>0xdd</td><td>0xa8</td><td>0x33</td><td>0x88</td><td>0x07</td><td>0xc7</td><td>0x31</td><td>0xb1</td><td>0x12</td><td>0x10</td><td>0x59</td><td>0x27</td><td>0x80</td><td>0xec</td><td>0x5f</td></tr><tr><td>D</td><td>0x60</td><td>0x51</td><td>0x7f</td><td>0xa9</td><td>0x19</td><td>0xb5</td><td>0x4a</td><td>0x0d</td><td>0x2d</td><td>0xe5</td><td>0x7a</td><td>0x9f</td><td>0x93</td><td>0xc9</td><td>0x9c</td><td>0xef</td></tr><tr><td>E</td><td>0xa0</td><td>0xe0</td><td>0x3b</td><td>0x4d</td><td>0xae</td><td>0x2a</td><td>0xf5</td><td>0xb0</td><td>0xc8</td><td>0xeb</td><td>0xbb</td><td>0x3c</td><td>0x83</td><td>0x53</td><td>0x99</td><td>0x61</td></tr><tr><td>F</td><td>0x17</td><td>0x2b</td><td>0x04</td><td>0x7e</td><td>0xba</td><td>0x77</td><td>0xd6</td><td>0x26</td><td>0xe1</td><td>0x69</td><td>0x14</td><td>0x63</td><td>0x55</td><td>0x21</td><td>0x0c</td><td>0x7d</td></tr></tbody></table><ol start="3"><li>é€šè¿‡ IDA æ’ä»¶ <code>Findcrypt</code> å¯ä»¥è¯†åˆ«å‡º AES</li></ol><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blog-markdown-1317553172.cos.ap-nanjing.myqcloud.com/%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95%E7%9A%84%E5%87%BD%E6%95%B0%E7%89%B9%E5%BE%819.png" alt="åŠ å¯†ç®—æ³•çš„å‡½æ•°ç‰¹å¾9.png"></p><hr><h2 id="åŸç†-7"><a href="#åŸç†-7" class="headerlink" title="åŸç†"></a>åŸç†</h2><blockquote><p>è¯¦ç»†è¿‡ç¨‹å‚è€ƒï¼š</p><ol><li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/gaoyucan/p/17087521.html">é€†å‘ä¸­çš„å¸¸è§å¯†ç çš„è¯†åˆ«ï¼ˆæŒç»­æ›´æ–°ä¸­ï¼‰ - gaoyucan - åšå®¢å›­</a></li><li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/luop/p/4334160.html">å¯†ç ç®—æ³•è¯¦è§£â€”â€”AES - ReadingLover - åšå®¢å›­</a></li></ol></blockquote><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blog-markdown-1317553172.cos.ap-nanjing.myqcloud.com/%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95%E7%9A%84%E5%87%BD%E6%95%B0%E7%89%B9%E5%BE%818.png" alt="åŠ å¯†ç®—æ³•çš„å‡½æ•°ç‰¹å¾8.png"></p><p>AES å¸¸ç”¨çš„åŠ å¯†å·¥ä½œæ¨¡å¼æœ‰ï¼šECBï¼ŒCBCï¼ŒOFBï¼ŒCFBï¼ŒCTR</p><table><thead><tr><th align="left">æ¨¡å¼</th><th align="left">å«ä¹‰</th><th align="left">åç§»é‡ IV</th></tr></thead><tbody><tr><td align="left">ECB</td><td align="left">ç”µå­å¯†ç æœ¬æ¨¡å¼</td><td align="left">æ— </td></tr><tr><td align="left">CBC</td><td align="left">å¯†ç åˆ†ç»„é“¾æ¥æ¨¡å¼</td><td align="left">æœ‰</td></tr><tr><td align="left">OFB</td><td align="left">è¾“å‡ºåé¦ˆæ¨¡å¼</td><td align="left">æœ‰</td></tr><tr><td align="left">CFB</td><td align="left">å¯†ç åé¦ˆæ¨¡å¼</td><td align="left">æœ‰</td></tr><tr><td align="left">CTR</td><td align="left">è®¡æ•°å™¨æ¨¡å¼</td><td align="left">æœ‰</td></tr></tbody></table><p>æœ€å¸¸ç”¨çš„æ˜¯ ECB å’Œ CBC æ¨¡å¼ï¼Œä¸»è¦åŒºåˆ«åœ¨äº ECB æ— éœ€åç§»é‡ IVï¼ŒCBC éœ€è¦åç§»é‡</p><hr><h2 id="åŠ è§£å¯†ä»£ç -6"><a href="#åŠ è§£å¯†ä»£ç -6" class="headerlink" title="åŠ è§£å¯†ä»£ç "></a>åŠ è§£å¯†ä»£ç </h2><blockquote><p>å¦‚æœåœ¨ Windows å¹³å°ä¸‹ï¼Œä½¿ç”¨ <code>from Crypto.Cipher import AES</code> é‡åˆ°å…³äº <code>Module Not Found Error : No module named 'Crypto'</code> çš„æŠ¥é”™ï¼Œå¯å°è¯•å¦‚ä¸‹åŠæ³•è§£å†³</p><p>å‚è€ƒæ–‡çŒ®ï¼š</p><ol><li><a target="_blank" rel="noopener" href="https://blog.csdn.net/chouzhou9701/article/details/106432497/">å…³äºModule Not Found Error No module named Cryptoè§£å†³_windows modulenotfounderror: no module named â€˜cryp-CSDNåšå®¢</a></li></ol></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pip uninstall crypto
pip uninstall pycryptodome
pip <span class="token function">install</span> pycryptodome<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="Python-ç‰ˆï¼ˆCBC-æ¨¡å¼ï¼‰-1"><a href="#Python-ç‰ˆï¼ˆCBC-æ¨¡å¼ï¼‰-1" class="headerlink" title="Python ç‰ˆï¼ˆCBC æ¨¡å¼ï¼‰"></a>Python ç‰ˆï¼ˆCBC æ¨¡å¼ï¼‰</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES  
<span class="token keyword">import</span> binascii  
  
key <span class="token operator">=</span> <span class="token string">b'1234567812345678'</span>  <span class="token comment"># ç§˜é’¥ï¼Œbytes ç±»å‹  </span>
iv <span class="token operator">=</span> <span class="token string">b'1234567812345678'</span>  <span class="token comment"># iv åç§»é‡ï¼Œbytes ç±»å‹  </span>
text <span class="token operator">=</span> <span class="token string">b'welcome_to_uf4te'</span>  <span class="token comment"># éœ€è¦åŠ è§£å¯†çš„å†…å®¹ï¼Œbytes ç±»å‹  </span>
  
aes <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_CBC<span class="token punctuation">,</span> iv<span class="token punctuation">)</span>  <span class="token comment"># åˆ›å»ºä¸€ä¸ª AES å¯¹è±¡ï¼ŒAES.MODE_CBC è¡¨ç¤º CBC æ¨¡å¼  </span>
den_text <span class="token operator">=</span> aes<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>text<span class="token punctuation">)</span>  <span class="token comment"># è§£å¯†ï¼Œbytes ç±»å‹  </span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"è§£å¯†ï¼š"</span><span class="token punctuation">,</span> binascii<span class="token punctuation">.</span>b2a_hex<span class="token punctuation">(</span>den_text<span class="token punctuation">)</span><span class="token punctuation">)</span>   <span class="token comment"># å°†å­—èŠ‚å¯¹è±¡è½¬æ¢ä¸ºåå…­è¿›åˆ¶å­—ç¬¦ä¸²  </span>
  
aes <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_CBC<span class="token punctuation">,</span> iv<span class="token punctuation">)</span>  <span class="token comment"># CBC æ¨¡å¼ä¸‹è§£å¯†éœ€è¦é‡æ–°åˆ›å»ºä¸€ä¸ª AES å¯¹è±¡ï¼ŒAES.MODE_CBC è¡¨ç¤º CBC æ¨¡å¼  </span>
en_text <span class="token operator">=</span> aes<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>den_text<span class="token punctuation">)</span>  <span class="token comment"># åŠ å¯†ï¼Œbytes ç±»å‹  </span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"åŠ å¯†ï¼š"</span><span class="token punctuation">,</span> en_text<span class="token punctuation">)</span>


<span class="token triple-quoted-string string">''' è¾“å‡ºï¼š
è§£å¯†ï¼š b'576fab9d1e22110b39027d9d85f7417f'
åŠ å¯†ï¼š b'welcome_to_uf4te'
'''</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Python-ç‰ˆï¼ˆECB-æ¨¡å¼ï¼‰-1"><a href="#Python-ç‰ˆï¼ˆECB-æ¨¡å¼ï¼‰-1" class="headerlink" title="Python ç‰ˆï¼ˆECB æ¨¡å¼ï¼‰"></a>Python ç‰ˆï¼ˆECB æ¨¡å¼ï¼‰</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES  
<span class="token keyword">import</span> binascii  
  
key <span class="token operator">=</span> <span class="token string">b'1234567812345678'</span>  <span class="token comment"># ç§˜é’¥ï¼Œbytes ç±»å‹  </span>
text <span class="token operator">=</span> <span class="token string">b'weclome_to_uf4te'</span>  <span class="token comment"># éœ€è¦åŠ è§£å¯†çš„å†…å®¹ï¼Œbytes ç±»å‹  </span>
  
aes <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_ECB<span class="token punctuation">)</span>  <span class="token comment"># åˆ›å»ºä¸€ä¸ª AES å¯¹è±¡ï¼ŒAES.MODE_ECB è¡¨ç¤ºæ¨¡å¼æ˜¯ ECB æ¨¡å¼  </span>
  
den_text <span class="token operator">=</span> aes<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>text<span class="token punctuation">)</span>  <span class="token comment"># è§£å¯†ï¼Œbytes ç±»å‹  </span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"è§£å¯†ï¼š"</span><span class="token punctuation">,</span> binascii<span class="token punctuation">.</span>b2a_hex<span class="token punctuation">(</span>den_text<span class="token punctuation">)</span><span class="token punctuation">)</span>  
  
en_text <span class="token operator">=</span> aes<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>den_text<span class="token punctuation">)</span>  <span class="token comment"># åŠ å¯†ï¼Œbytes ç±»å‹  </span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"åŠ å¯†ï¼š"</span><span class="token punctuation">,</span> en_text<span class="token punctuation">)</span>


<span class="token triple-quoted-string string">''' è¾“å‡ºï¼š
è§£å¯†ï¼š b'914532f3c0677e44c5169a096ffccbd7'
åŠ å¯†ï¼š b'weclome_to_uf4te'
'''</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="IDA-ç¤ºä¾‹-6"><a href="#IDA-ç¤ºä¾‹-6" class="headerlink" title="IDA ç¤ºä¾‹"></a>IDA ç¤ºä¾‹</h2><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> __cdecl <span class="token function">sub_401EC0</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>a1<span class="token punctuation">,</span> <span class="token keyword">int</span> a2<span class="token punctuation">,</span> <span class="token keyword">int</span> a3<span class="token punctuation">,</span> <span class="token keyword">int</span> a4<span class="token punctuation">,</span> <span class="token keyword">int</span> a5<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token keyword">int</span> v5<span class="token punctuation">;</span> <span class="token comment">// ebx</span>
  <span class="token keyword">int</span> <span class="token operator">*</span>v7<span class="token punctuation">;</span> <span class="token comment">// ebp</span>
  <span class="token keyword">int</span> v8<span class="token punctuation">;</span> <span class="token comment">// eax</span>
  <span class="token keyword">char</span> <span class="token operator">*</span>v10<span class="token punctuation">;</span> <span class="token comment">// esi</span>
  <span class="token keyword">int</span> v11<span class="token punctuation">;</span> <span class="token comment">// esi</span>
  <span class="token keyword">int</span> <span class="token operator">*</span>v12<span class="token punctuation">;</span> <span class="token comment">// edi</span>
  <span class="token keyword">char</span> <span class="token operator">*</span>v13<span class="token punctuation">;</span> <span class="token comment">// esi</span>
  <span class="token keyword">int</span> v14<span class="token punctuation">;</span> <span class="token comment">// eax</span>
  <span class="token keyword">int</span> v15<span class="token punctuation">;</span> <span class="token comment">// ecx</span>
  <span class="token keyword">int</span> <span class="token operator">*</span>v16<span class="token punctuation">;</span> <span class="token comment">// eax</span>
  <span class="token keyword">char</span> <span class="token operator">*</span>v17<span class="token punctuation">;</span> <span class="token comment">// edx</span>
  _DWORD <span class="token operator">*</span>v18<span class="token punctuation">;</span> <span class="token comment">// ebp</span>
  <span class="token keyword">int</span> v19<span class="token punctuation">;</span> <span class="token comment">// edx</span>
  <span class="token keyword">int</span> v20<span class="token punctuation">;</span> <span class="token comment">// ecx</span>
  <span class="token keyword">int</span> <span class="token operator">*</span>v21<span class="token punctuation">;</span> <span class="token comment">// eax</span>
  <span class="token keyword">char</span> <span class="token operator">*</span>v22<span class="token punctuation">;</span> <span class="token comment">// edx</span>
  <span class="token keyword">bool</span> v23<span class="token punctuation">;</span> <span class="token comment">// cc</span>
  <span class="token keyword">int</span> <span class="token operator">*</span>v24<span class="token punctuation">;</span> <span class="token comment">// edx</span>
  <span class="token keyword">int</span> <span class="token operator">*</span>v25<span class="token punctuation">;</span> <span class="token comment">// ecx</span>
  <span class="token keyword">int</span> v26<span class="token punctuation">;</span> <span class="token comment">// esi</span>
  <span class="token keyword">int</span> v27<span class="token punctuation">;</span> <span class="token comment">// edi</span>
  <span class="token keyword">int</span> v28<span class="token punctuation">;</span> <span class="token comment">// edi</span>
  _DWORD <span class="token operator">*</span>v29<span class="token punctuation">;</span> <span class="token comment">// esi</span>
  _DWORD <span class="token operator">*</span>v30<span class="token punctuation">;</span> <span class="token comment">// edi</span>
  <span class="token keyword">int</span> v31<span class="token punctuation">;</span> <span class="token comment">// ebx</span>
  <span class="token keyword">bool</span> v32<span class="token punctuation">;</span> <span class="token comment">// zf</span>
  <span class="token keyword">int</span> v33<span class="token punctuation">;</span> <span class="token comment">// ebx</span>
  <span class="token keyword">int</span> v34<span class="token punctuation">;</span> <span class="token comment">// ecx</span>
  <span class="token keyword">int</span> <span class="token operator">*</span>v35<span class="token punctuation">;</span> <span class="token comment">// edx</span>
  <span class="token keyword">int</span> v36<span class="token punctuation">;</span> <span class="token comment">// esi</span>
  <span class="token keyword">int</span> v37<span class="token punctuation">;</span> <span class="token comment">// edi</span>
  <span class="token keyword">int</span> v38<span class="token punctuation">;</span> <span class="token comment">// eax</span>
  <span class="token keyword">char</span> v39<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [esp+8h] [ebp-20h] BYREF</span>
  <span class="token keyword">int</span> v40<span class="token punctuation">;</span> <span class="token comment">// [esp+2Ch] [ebp+4h]</span>
  _DWORD <span class="token operator">*</span>v41<span class="token punctuation">;</span> <span class="token comment">// [esp+30h] [ebp+8h]</span>
  <span class="token keyword">int</span> v42<span class="token punctuation">;</span> <span class="token comment">// [esp+30h] [ebp+8h]</span>
  <span class="token keyword">int</span> v43<span class="token punctuation">;</span> <span class="token comment">// [esp+34h] [ebp+Ch]</span>
  <span class="token keyword">char</span> <span class="token operator">*</span>v44<span class="token punctuation">;</span> <span class="token comment">// [esp+38h] [ebp+10h]</span>
  <span class="token keyword">int</span> v45<span class="token punctuation">;</span> <span class="token comment">// [esp+3Ch] [ebp+14h]</span>
  <span class="token keyword">int</span> v46<span class="token punctuation">;</span> <span class="token comment">// [esp+3Ch] [ebp+14h]</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v47<span class="token punctuation">;</span> <span class="token comment">// [esp+3Ch] [ebp+14h]</span>

  v5 <span class="token operator">=</span> a3 <span class="token operator">/</span> <span class="token number">4</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> a3 <span class="token operator">/</span> <span class="token number">4</span> <span class="token operator">!=</span> <span class="token number">4</span> <span class="token operator">&amp;&amp;</span> v5 <span class="token operator">!=</span> <span class="token number">6</span> <span class="token operator">&amp;&amp;</span> v5 <span class="token operator">!=</span> <span class="token number">8</span> <span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
  v7 <span class="token operator">=</span> a1<span class="token punctuation">;</span>
  <span class="token operator">*</span>a1 <span class="token operator">=</span> v5<span class="token punctuation">;</span>
  a1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> v5 <span class="token operator">+</span> <span class="token number">6</span><span class="token punctuation">;</span>
  <span class="token function">sub_401E80</span><span class="token punctuation">(</span>a1<span class="token punctuation">,</span> a2<span class="token punctuation">,</span> a5<span class="token punctuation">)</span><span class="token punctuation">;</span>
  v8 <span class="token operator">=</span> <span class="token number">4</span> <span class="token operator">*</span> <span class="token punctuation">(</span>v5 <span class="token operator">+</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">;</span>
  v43 <span class="token operator">=</span> v8<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> v5 <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    v10 <span class="token operator">=</span> v39<span class="token punctuation">;</span>
    v45 <span class="token operator">=</span> v5<span class="token punctuation">;</span>
    <span class="token keyword">do</span>
    <span class="token punctuation">{</span>
      <span class="token operator">*</span>v10 <span class="token operator">=</span> <span class="token function">sub_4021A0</span><span class="token punctuation">(</span>a4<span class="token punctuation">)</span><span class="token punctuation">;</span>
      v10 <span class="token operator">+=</span> <span class="token number">4</span><span class="token punctuation">;</span>
      a4 <span class="token operator">+=</span> <span class="token number">4</span><span class="token punctuation">;</span>
      <span class="token operator">--</span>v45<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span> v45 <span class="token punctuation">)</span><span class="token punctuation">;</span>
    v8 <span class="token operator">=</span> <span class="token number">4</span> <span class="token operator">*</span> <span class="token punctuation">(</span>v5 <span class="token operator">+</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">;</span>
    <span class="token function">qmemcpy</span><span class="token punctuation">(</span>a1 <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">,</span> v39<span class="token punctuation">,</span> <span class="token number">4</span> <span class="token operator">*</span> v5<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  v46 <span class="token operator">=</span> v5<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> v5 <span class="token operator">&lt;</span> v8 <span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    v41 <span class="token operator">=</span> <span class="token operator">&amp;</span>unk_4084DC<span class="token punctuation">;</span>
    v11 <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">8</span> <span class="token operator">-</span> a1<span class="token punctuation">;</span>
    v12 <span class="token operator">=</span> <span class="token operator">&amp;</span>a1<span class="token punctuation">[</span>v5 <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span> <span class="token number">1</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      v13 <span class="token operator">=</span> v12 <span class="token operator">+</span> v11<span class="token punctuation">;</span>
      v14 <span class="token operator">=</span> <span class="token function">sub_4021D0</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">*</span>v12 <span class="token operator">&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token operator">*</span>v12 <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// sub_4021D0 å‡½æ•°å¯¹ s_box è¿›è¡Œå­—èŠ‚çš„æ˜ å°„</span>
      v15 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
      v12<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">*</span>v41 <span class="token operator">^</span> <span class="token operator">*</span><span class="token operator">&amp;</span>v13<span class="token punctuation">[</span>a1 <span class="token operator">+</span> <span class="token number">12</span> <span class="token operator">+</span> <span class="token operator">-</span><span class="token number">4</span> <span class="token operator">*</span> v5<span class="token punctuation">]</span> <span class="token operator">^</span> v14<span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span> v5 <span class="token operator">&gt;</span> <span class="token number">6</span> <span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
        v18 <span class="token operator">=</span> v12 <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span>
        v44 <span class="token operator">=</span> <span class="token operator">&amp;</span>v13<span class="token punctuation">[</span>a1 <span class="token operator">+</span> <span class="token number">16</span> <span class="token operator">+</span> <span class="token operator">-</span><span class="token number">4</span> <span class="token operator">*</span> v5<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">do</span>
        <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span> v15 <span class="token operator">+</span> v46 <span class="token operator">&gt;=</span> v43 <span class="token punctuation">)</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
          v19 <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>v18<span class="token operator">++</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token operator">++</span>v15<span class="token punctuation">;</span>
          <span class="token operator">*</span><span class="token punctuation">(</span>v18 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token operator">*</span>v44 <span class="token operator">^</span> v19<span class="token punctuation">;</span>
          v44 <span class="token operator">+=</span> <span class="token number">4</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span> v15 <span class="token operator">&lt;</span> <span class="token number">4</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span> v46 <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">&lt;</span> v43 <span class="token punctuation">)</span>
          v12<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token operator">&amp;</span>v13<span class="token punctuation">[</span>a1 <span class="token operator">+</span> <span class="token number">28</span> <span class="token operator">+</span> <span class="token operator">-</span><span class="token number">4</span> <span class="token operator">*</span> v5<span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token function">sub_4021D0</span><span class="token punctuation">(</span>v12<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        v20 <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
        v21 <span class="token operator">=</span> v12 <span class="token operator">+</span> <span class="token number">6</span><span class="token punctuation">;</span>
        v22 <span class="token operator">=</span> <span class="token operator">&amp;</span>v13<span class="token punctuation">[</span>a1 <span class="token operator">+</span> <span class="token number">32</span> <span class="token operator">+</span> <span class="token operator">-</span><span class="token number">4</span> <span class="token operator">*</span> v5<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">do</span>
        <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span> v20 <span class="token operator">+</span> v46 <span class="token operator">&gt;=</span> v43 <span class="token punctuation">)</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
          <span class="token operator">++</span>v20<span class="token punctuation">;</span>
          <span class="token operator">*</span>v21 <span class="token operator">=</span> <span class="token operator">*</span>v22 <span class="token operator">^</span> <span class="token operator">*</span><span class="token punctuation">(</span>v21 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          v22 <span class="token operator">+=</span> <span class="token number">4</span><span class="token punctuation">;</span>
          <span class="token operator">++</span>v21<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span> v20 <span class="token operator">&lt;</span> v5 <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span> v5 <span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
        v16 <span class="token operator">=</span> v12 <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span>
        v17 <span class="token operator">=</span> <span class="token operator">&amp;</span>v13<span class="token punctuation">[</span>a1 <span class="token operator">+</span> <span class="token number">16</span> <span class="token operator">+</span> <span class="token operator">-</span><span class="token number">4</span> <span class="token operator">*</span> v5<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">do</span>
        <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span> v15 <span class="token operator">+</span> v46 <span class="token operator">&gt;=</span> v43 <span class="token punctuation">)</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
          <span class="token operator">++</span>v15<span class="token punctuation">;</span>
          <span class="token operator">*</span>v16 <span class="token operator">=</span> <span class="token operator">*</span>v17 <span class="token operator">^</span> <span class="token operator">*</span><span class="token punctuation">(</span>v16 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          v17 <span class="token operator">+=</span> <span class="token number">4</span><span class="token punctuation">;</span>
          <span class="token operator">++</span>v16<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span> v15 <span class="token operator">&lt;</span> v5 <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      v12 <span class="token operator">+=</span> v5<span class="token punctuation">;</span>
      v8 <span class="token operator">=</span> <span class="token number">4</span> <span class="token operator">*</span> <span class="token punctuation">(</span>v5 <span class="token operator">+</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">;</span>
      v23 <span class="token operator">=</span> v5 <span class="token operator">+</span> v46 <span class="token operator">&lt;</span> v43<span class="token punctuation">;</span>
      v46 <span class="token operator">+=</span> v5<span class="token punctuation">;</span>
      <span class="token operator">++</span>v41<span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span>v23 <span class="token punctuation">)</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
      v11 <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">8</span> <span class="token operator">-</span> a1<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    v7 <span class="token operator">=</span> a1<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  v24 <span class="token operator">=</span> <span class="token operator">&amp;</span>v7<span class="token punctuation">[</span>v8 <span class="token operator">+</span> <span class="token number">59</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  v25 <span class="token operator">=</span> v7 <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">;</span>
  v26 <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
  <span class="token keyword">do</span>
  <span class="token punctuation">{</span>
    v27 <span class="token operator">=</span> <span class="token operator">*</span>v25<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token operator">*</span>v24<span class="token operator">++</span> <span class="token operator">=</span> v27<span class="token punctuation">;</span>
    <span class="token operator">--</span>v26<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span> v26 <span class="token punctuation">)</span><span class="token punctuation">;</span>
  v28 <span class="token operator">=</span> v8 <span class="token operator">-</span> <span class="token number">4</span><span class="token punctuation">;</span>
  v42 <span class="token operator">=</span> v8 <span class="token operator">-</span> <span class="token number">4</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> v8 <span class="token operator">-</span> <span class="token number">4</span> <span class="token operator">&gt;</span> <span class="token number">4</span> <span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    v29 <span class="token operator">=</span> v7 <span class="token operator">+</span> <span class="token number">7</span><span class="token punctuation">;</span>
    v40 <span class="token operator">=</span> <span class="token operator">&amp;</span>v7<span class="token punctuation">[</span>v8 <span class="token operator">+</span> <span class="token number">55</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    v47 <span class="token operator">=</span> <span class="token punctuation">(</span>v8 <span class="token operator">-</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token keyword">do</span>
    <span class="token punctuation">{</span>
      v30 <span class="token operator">=</span> v40<span class="token punctuation">;</span>
      v31 <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
      <span class="token keyword">do</span>
      <span class="token punctuation">{</span>
        <span class="token operator">*</span>v30<span class="token operator">++</span> <span class="token operator">=</span> <span class="token function">sub_402270</span><span class="token punctuation">(</span><span class="token operator">*</span>v29<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token operator">--</span>v31<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">while</span> <span class="token punctuation">(</span> v31 <span class="token punctuation">)</span><span class="token punctuation">;</span>
      v32 <span class="token operator">=</span> v47 <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">;</span>
      v40 <span class="token operator">-=</span> <span class="token number">16</span><span class="token punctuation">;</span>
      <span class="token operator">--</span>v47<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span> <span class="token operator">!</span>v32 <span class="token punctuation">)</span><span class="token punctuation">;</span>
    v8 <span class="token operator">=</span> v43<span class="token punctuation">;</span>
    v28 <span class="token operator">=</span> v42<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> v28 <span class="token operator">&lt;</span> v8 <span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    v33 <span class="token operator">=</span> <span class="token number">4</span> <span class="token operator">*</span> v8<span class="token punctuation">;</span>
    v34 <span class="token operator">=</span> <span class="token number">4</span> <span class="token operator">*</span> v28<span class="token punctuation">;</span>
    v35 <span class="token operator">=</span> <span class="token operator">&amp;</span>v7<span class="token punctuation">[</span>v28 <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    v36 <span class="token operator">=</span> v8 <span class="token operator">-</span> v28<span class="token punctuation">;</span>
    <span class="token keyword">do</span>
    <span class="token punctuation">{</span>
      v37 <span class="token operator">=</span> <span class="token operator">*</span>v35<span class="token punctuation">;</span>
      v38 <span class="token operator">=</span> v34 <span class="token operator">-</span> v33<span class="token punctuation">;</span>
      v34 <span class="token operator">+=</span> <span class="token number">4</span><span class="token punctuation">;</span>
      <span class="token operator">++</span>v35<span class="token punctuation">;</span>
      <span class="token operator">--</span>v36<span class="token punctuation">;</span>
      <span class="token operator">*</span><span class="token punctuation">(</span>v7 <span class="token operator">+</span> v38 <span class="token operator">+</span> <span class="token number">268</span><span class="token punctuation">)</span> <span class="token operator">=</span> v37<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span> v36 <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr></article><div class="post-copyright"><div class="post-copyright__title"><span class="post-copyright-info"><h>IDAä¸­åŠ å¯†ç®—æ³•ç‰¹å¾ä¸è§£å¯†</h></span></div><div class="post-copyright__type"><span class="post-copyright-info">æœ¬æ–‡é“¾æ¥ï¼š<a href="https://www.uf4te.cn/posts/52521377.html">https://www.uf4te.cn/posts/52521377.html</a></span></div><div class="post-copyright-m"><div class="post-copyright-m-info"><div class="post-copyright-a" style="padding-left:6px;display:inline-block;width:120px"><h>ä½œè€…</h><div class="post-copyright-cc-info"><h>uf4te</h></div></div><div class="post-copyright-c" style="padding-left:6px;display:inline-block;width:120px"><h>å‘å¸ƒäº</h><div class="post-copyright-cc-info"><h>2023-03-17</h></div></div><div class="post-copyright-u" style="padding-left:6px;display:inline-block;width:120px"><h>æ›´æ–°äº</h><div class="post-copyright-cc-info"><h>2024-10-25</h></div></div><div class="post-copyright-c" style="padding-left:6px;display:inline-block;width:120px"><h>è®¸å¯åè®®</h><div class="post-copyright-cc-info"><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a rel="noopener" target="_blank" title="CC BY 4.0" href="https://creativecommons.org/licenses/by/4.0/deed.zh">CC BY 4.0</a></div></div></div></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Reverse/">Reverse</a><a class="post-meta__tags" href="/tags/IDA/">IDA</a><a class="post-meta__tags" href="/tags/CTF/">CTF</a><a class="post-meta__tags" href="/tags/Crypto/">Crypto</a></div><div class="post_share"><div class="social-share" data-image="/img/cover/cover-45.jpg" data-sites="facebook, twitter, wechat, weibo, qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> å¥–åŠ±ä¸€ä¸‹ç«™é•¿</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/rewards/wechat.png" target="_blank"><img class="post-qr-code-img" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/rewards/wechat.png" alt="å¾®ä¿¡æ”¯ä»˜"></a><div class="post-qr-code-desc">å¾®ä¿¡æ”¯ä»˜</div></li><li class="reward-item"><a href="/img/rewards/alipay.png" target="_blank"><img class="post-qr-code-img" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/rewards/alipay.png" alt="æ”¯ä»˜å®"></a><div class="post-qr-code-desc">æ”¯ä»˜å®</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/44dd15d4.html" title="IDAçš„åŸºç¡€å’Œè¿œç¨‹è°ƒè¯•"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover/cover-48.jpg" onerror='onerror=null,src="/img/404/pic_404.png"' alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">IDAçš„åŸºç¡€å’Œè¿œç¨‹è°ƒè¯•</div></div></a></div><div class="next-post pull-right"><a href="/posts/73edb5dc.html" title="IDAä¸­çš„ä¸€äº›Cè¯­è¨€å‡½æ•°"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover/cover-46.jpg" onerror='onerror=null,src="/img/404/pic_404.png"' alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">IDAä¸­çš„ä¸€äº›Cè¯­è¨€å‡½æ•°</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><div><a href="/posts/44dd15d4.html" title="IDAçš„åŸºç¡€å’Œè¿œç¨‹è°ƒè¯•"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover/cover-48.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2024-10-19</div><div class="title">IDAçš„åŸºç¡€å’Œè¿œç¨‹è°ƒè¯•</div></div></a></div><div><a href="/posts/874a8fd2.html" title="IDAä¸­çš„ä¸€äº›æ•°æ®ç±»å‹"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover/cover-47.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2024-06-05</div><div class="title">IDAä¸­çš„ä¸€äº›æ•°æ®ç±»å‹</div></div></a></div><div><a href="/posts/73edb5dc.html" title="IDAä¸­çš„ä¸€äº›Cè¯­è¨€å‡½æ•°"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover/cover-46.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2024-06-05</div><div class="title">IDAä¸­çš„ä¸€äº›Cè¯­è¨€å‡½æ•°</div></div></a></div></div></div><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i> <span>è¯„è®º</span></div></div><div class="comment-wrap"><div><div id="waline-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="author_top is-center"><div class="card-info-avatar"><div class="avatar-img"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/blog/avatar.jpg" onerror='this.onerror=null,this.src="/img/404/loading_404.gif"' alt="avatar"></div><div class="author-status-box"><div class="author-status"><g-emoji class="g-emoji" alias="palm_tree" fallback-src="https://lskypro.acozycotage.net/LightPicture/2022/12/fe1dc0402e623096.jpg">ğŸ¤¡</g-emoji><span>è¿·èŒ«</span></div></div></div><div class="author-info__name">uf4te</div><div class="author-info__description">å¤©é“é…¬å‹¤</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">134</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">27</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">8</div></a><a href="/commentwall/"><div class="headline">è¯„è®º</div><div class="length-num comment-total">0</div></a><a href="/about/#reward-me"><div class="headline">èµåŠ©</div><div class="length-num reward-total">1</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/uf4te/uf4te.github.io"><i class="fab fa-github"></i><span>ç»™æˆ‘çš„ç½‘ç«™ä¸€ä¸ªstar ğŸ¤—</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="mailto:916884674@qq.com" target="_blank" title="mail æˆ‘çš„é‚®ç®±"><i class="fas fa-envelope"></i></a><a class="social-icon" href="/img/me/QRCode_QQ.png" target="_blank" title="åŠ æˆ‘ QQ"><i class="fa-brands fa-qq"></i></a><a class="social-icon" href="/img/me/QRCode_WeChat.png" target="_blank" title="åŠ æˆ‘å¾®ä¿¡"><i class="fa-brands fa-weixin"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title="RSS è®¢é˜…"><i class="fa-solid fa-square-rss"></i></a><a class="social-icon" href="/about/#reward-me" target="_blank" title="èµåŠ©æœ¬ç«™"><i class="fa-sharp fa-solid fa-heart-circle-bolt"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fa-solid fa-medal"></i><span>æ¬¢è¿æ¥åˆ°æˆ‘çš„å°ç«™</span></div><div class="announcement_content">æˆ‘æ˜¯ä¸€ä¸ªå–œæ¬¢å­¦ä¹  PWN å’Œé€†å‘çš„äºŒè¿›åˆ¶ CTFerï¼ŒåŠ æ²¹ï¼Œäº’å‹‰ï¼</div><div style="margin-bottom:8px"></div><div class="item-headline"><i class="fa-solid fa-hourglass-half fa-shake"></i><span>è®¡æ—¶å°åŠ©æ‰‹</span></div><div id="timing"></div><div style="margin-bottom:8px"></div><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>æœ€æ–°å…¬å‘Š</span></div><div class="newest_announcement_content">å¯ä»¥åœ¨ã€Šäº’åŠ¨ -&gt; æˆ‘çš„è¯´è¯´ã€‹ä¸‹æŸ¥çœ‹æœ¬ç«™çš„æ›´æ–°åŠåŠ¨æ€ï¼š<a href="https://www.uf4te.cn/artitalk/" target="_blank" title="ç‚¹å‡»ç›´è¾¾">æˆ‘çš„è¯´è¯´</a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Base64"><span class="toc-text">Base64</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%B9%E7%82%B9"><span class="toc-text">ç‰¹ç‚¹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8E%9F%E7%90%86"><span class="toc-text">åŸç†</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%A0%E8%A7%A3%E5%AF%86%E4%BB%A3%E7%A0%81"><span class="toc-text">åŠ è§£å¯†ä»£ç </span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Python-%E7%89%88%EF%BC%88%E7%AE%80%E6%B4%81%E8%84%9A%E6%9C%AC%EF%BC%89"><span class="toc-text">Python ç‰ˆï¼ˆç®€æ´è„šæœ¬ï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Python-%E7%89%88%EF%BC%88%E5%AE%8C%E6%95%B4%E7%B3%BB%E7%BB%9F%EF%BC%89"><span class="toc-text">Python ç‰ˆï¼ˆå®Œæ•´ç³»ç»Ÿï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#C-%E7%89%88%EF%BC%88%E5%AE%8C%E6%95%B4%E7%B3%BB%E7%BB%9F%EF%BC%89"><span class="toc-text">C++ ç‰ˆï¼ˆå®Œæ•´ç³»ç»Ÿï¼‰</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IDA-%E7%A4%BA%E4%BE%8B"><span class="toc-text">IDA ç¤ºä¾‹</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#RC4"><span class="toc-text">RC4</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%B9%E7%82%B9-1"><span class="toc-text">ç‰¹ç‚¹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8E%9F%E7%90%86-1"><span class="toc-text">åŸç†</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96%E9%83%A8%E5%88%86"><span class="toc-text">åˆå§‹åŒ–éƒ¨åˆ†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A0%E8%A7%A3%E5%AF%86%E9%83%A8%E5%88%86"><span class="toc-text">åŠ è§£å¯†éƒ¨åˆ†</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%A0%E8%A7%A3%E5%AF%86%E4%BB%A3%E7%A0%81-1"><span class="toc-text">åŠ è§£å¯†ä»£ç </span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Python-%E7%89%88%EF%BC%88%E7%AE%80%E6%B4%81%E8%84%9A%E6%9C%AC%EF%BC%89-1"><span class="toc-text">Python ç‰ˆï¼ˆç®€æ´è„šæœ¬ï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Python-%E7%89%88%EF%BC%88%E5%85%B7%E4%BD%93%E5%AE%9E%E7%8E%B0%EF%BC%89"><span class="toc-text">Python ç‰ˆï¼ˆå…·ä½“å®ç°ï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#C-%E7%89%88%EF%BC%88%E5%85%B7%E4%BD%93%E5%AE%9E%E7%8E%B0%EF%BC%89"><span class="toc-text">C++ ç‰ˆï¼ˆå…·ä½“å®ç°ï¼‰</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IDA-%E7%A4%BA%E4%BE%8B-1"><span class="toc-text">IDA ç¤ºä¾‹</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#TEA"><span class="toc-text">TEA</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%B9%E7%82%B9-2"><span class="toc-text">ç‰¹ç‚¹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8E%9F%E7%90%86-2"><span class="toc-text">åŸç†</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%A0%E8%A7%A3%E5%AF%86%E4%BB%A3%E7%A0%81-2"><span class="toc-text">åŠ è§£å¯†ä»£ç </span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#C-%E7%89%88"><span class="toc-text">C++ ç‰ˆ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IDA-%E7%A4%BA%E4%BE%8B-2"><span class="toc-text">IDA ç¤ºä¾‹</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#XTEA"><span class="toc-text">XTEA</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%B9%E7%82%B9-3"><span class="toc-text">ç‰¹ç‚¹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8E%9F%E7%90%86-3"><span class="toc-text">åŸç†</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%A0%E8%A7%A3%E5%AF%86%E4%BB%A3%E7%A0%81-3"><span class="toc-text">åŠ è§£å¯†ä»£ç </span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#C-%E7%89%88-1"><span class="toc-text">C++ ç‰ˆ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IDA-%E7%A4%BA%E4%BE%8B-3"><span class="toc-text">IDA ç¤ºä¾‹</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#XXTEA"><span class="toc-text">XXTEA</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%B9%E7%82%B9-4"><span class="toc-text">ç‰¹ç‚¹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8E%9F%E7%90%86-4"><span class="toc-text">åŸç†</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%A0%E8%A7%A3%E5%AF%86%E4%BB%A3%E7%A0%81-4"><span class="toc-text">åŠ è§£å¯†ä»£ç </span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#C-%E7%89%88-2"><span class="toc-text">C++ ç‰ˆ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IDA-%E7%A4%BA%E4%BE%8B-4"><span class="toc-text">IDA ç¤ºä¾‹</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MD5"><span class="toc-text">MD5</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%B9%E7%82%B9-5"><span class="toc-text">ç‰¹ç‚¹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8E%9F%E7%90%86-5"><span class="toc-text">åŸç†</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%A0%E5%AF%86%E4%BB%A3%E7%A0%81"><span class="toc-text">åŠ å¯†ä»£ç </span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Python-%E7%89%88"><span class="toc-text">Python ç‰ˆ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IDA-%E7%A4%BA%E4%BE%8B-5"><span class="toc-text">IDA ç¤ºä¾‹</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DES"><span class="toc-text">DES</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%B9%E7%82%B9-6"><span class="toc-text">ç‰¹ç‚¹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8E%9F%E7%90%86-6"><span class="toc-text">åŸç†</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%A0%E8%A7%A3%E5%AF%86%E4%BB%A3%E7%A0%81-5"><span class="toc-text">åŠ è§£å¯†ä»£ç </span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Python-%E7%89%88%EF%BC%88CBC-%E6%A8%A1%E5%BC%8F%EF%BC%89"><span class="toc-text">Python ç‰ˆï¼ˆCBC æ¨¡å¼ï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Python-%E7%89%88%EF%BC%88ECB-%E6%A8%A1%E5%BC%8F%EF%BC%89"><span class="toc-text">Python ç‰ˆï¼ˆECB æ¨¡å¼ï¼‰</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#AES"><span class="toc-text">AES</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%B9%E7%82%B9-7"><span class="toc-text">ç‰¹ç‚¹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8E%9F%E7%90%86-7"><span class="toc-text">åŸç†</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%A0%E8%A7%A3%E5%AF%86%E4%BB%A3%E7%A0%81-6"><span class="toc-text">åŠ è§£å¯†ä»£ç </span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Python-%E7%89%88%EF%BC%88CBC-%E6%A8%A1%E5%BC%8F%EF%BC%89-1"><span class="toc-text">Python ç‰ˆï¼ˆCBC æ¨¡å¼ï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Python-%E7%89%88%EF%BC%88ECB-%E6%A8%A1%E5%BC%8F%EF%BC%89-1"><span class="toc-text">Python ç‰ˆï¼ˆECB æ¨¡å¼ï¼‰</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IDA-%E7%A4%BA%E4%BE%8B-6"><span class="toc-text">IDA ç¤ºä¾‹</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/f5dbafd0.html" title="AFL++ç¯å¢ƒæ­å»ºä¸æ¨¡ç³Šæµ‹è¯•"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover/cover-135.jpg" onerror='this.onerror=null,this.src="/img/404/pic_404.png"' alt="AFL++ç¯å¢ƒæ­å»ºä¸æ¨¡ç³Šæµ‹è¯•"></a><div class="content"><a class="title" href="/posts/f5dbafd0.html" title="AFL++ç¯å¢ƒæ­å»ºä¸æ¨¡ç³Šæµ‹è¯•">AFL++ç¯å¢ƒæ­å»ºä¸æ¨¡ç³Šæµ‹è¯•</a><time datetime="2024-10-14T15:06:13.000Z" title="å‘è¡¨äº 2024-10-14 23:06:13">2024-10-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/194d06e.html" title="Uç›˜é‡è£…ç³»ç»Ÿä»¥åŠUbuntuä¸WindowsåŒç³»ç»Ÿ"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover/cover-134.jpg" onerror='this.onerror=null,this.src="/img/404/pic_404.png"' alt="Uç›˜é‡è£…ç³»ç»Ÿä»¥åŠUbuntuä¸WindowsåŒç³»ç»Ÿ"></a><div class="content"><a class="title" href="/posts/194d06e.html" title="Uç›˜é‡è£…ç³»ç»Ÿä»¥åŠUbuntuä¸WindowsåŒç³»ç»Ÿ">Uç›˜é‡è£…ç³»ç»Ÿä»¥åŠUbuntuä¸WindowsåŒç³»ç»Ÿ</a><time datetime="2024-09-28T04:30:04.000Z" title="å‘è¡¨äº 2024-09-28 12:30:04">2024-09-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/bb411a4c.html" title="å¤šæ¶æ„ä¸äº¤å‰ç¼–è¯‘"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover/cover-133.jpg" onerror='this.onerror=null,this.src="/img/404/pic_404.png"' alt="å¤šæ¶æ„ä¸äº¤å‰ç¼–è¯‘"></a><div class="content"><a class="title" href="/posts/bb411a4c.html" title="å¤šæ¶æ„ä¸äº¤å‰ç¼–è¯‘">å¤šæ¶æ„ä¸äº¤å‰ç¼–è¯‘</a><time datetime="2024-06-16T14:48:33.000Z" title="å‘è¡¨äº 2024-06-16 22:48:33">2024-06-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/f0cbf9ee.html" title="IOTå›ºä»¶ä»¿çœŸä¸gdbserverè¿œç¨‹è°ƒè¯•"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover/cover-132.jpg" onerror='this.onerror=null,this.src="/img/404/pic_404.png"' alt="IOTå›ºä»¶ä»¿çœŸä¸gdbserverè¿œç¨‹è°ƒè¯•"></a><div class="content"><a class="title" href="/posts/f0cbf9ee.html" title="IOTå›ºä»¶ä»¿çœŸä¸gdbserverè¿œç¨‹è°ƒè¯•">IOTå›ºä»¶ä»¿çœŸä¸gdbserverè¿œç¨‹è°ƒè¯•</a><time datetime="2024-06-16T14:16:49.000Z" title="å‘è¡¨äº 2024-06-16 22:16:49">2024-06-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/c2233a9.html" title="CNVD-2013-11625å¤ç°"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover/cover-131.jpg" onerror='this.onerror=null,this.src="/img/404/pic_404.png"' alt="CNVD-2013-11625å¤ç°"></a><div class="content"><a class="title" href="/posts/c2233a9.html" title="CNVD-2013-11625å¤ç°">CNVD-2013-11625å¤ç°</a><time datetime="2024-06-12T13:03:01.000Z" title="å‘è¡¨äº 2024-06-12 21:03:01">2024-06-12</time></div></div></div></div><div class="card-widget" id="card-newest-comments"><div class="item-headline"><i class="fas fa-comment-dots"></i><span>æœ€æ–°è¯„è®º</span></div><div class="aside-list"><span>æ­£åœ¨åŠ è½½ä¸­...</span></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">Â©2023 - 2025 By uf4te</div><div class="framework-info"><span>æ¡†æ¶</span> <a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>ä¸»é¢˜</span> <a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div id="running-time"></div><script id="LA-DATA-WIDGET" crossorigin="anonymous" charset="UTF-8" src="https://v6-widget.51.la/v6/3GoBenqrrrBby5er/quote.js?theme=#1690FF,#00C4B6,#CACACA,#00C4B6,#FFFFFF,#1690FF,14&amp;f=12"></script><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&amp;logo=hexo" title="åšå®¢æ¡†æ¶ Hexo_v6.3.0"></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&amp;logo=bitdefender" title="ä¸»é¢˜ç‰ˆæœ¬ Butterfly_v4.7.0"></a><a class="github-badge" target="_blank" href="https://vercel.com/" style="margin-inline:5px"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Hosted-Vercel-black?style=flat&amp;logo=Vercel" title="æœ¬ç«™é‡‡ç”¨å¤šçº¿éƒ¨ç½²ï¼Œä¸»çº¿è·¯éƒ¨ç½²äº Vercel"></a><a class="github-badge" target="_blank" href="https://www.cloudflare.com/zh-cn/" style="margin-inline:5px"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Hosted-Cloudflare-F38020?style=flat&amp;logo=Cloudflare" title="æœ¬ç«™é‡‡ç”¨å¤šçº¿éƒ¨ç½²ï¼Œå¤‡ç”¨çº¿è·¯éƒ¨ç½²äº Cloudflare"></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&amp;logo=GitHub" title="æœ¬ç«™é¡¹ç›®ä¸»è¦ç”± Github æ‰˜ç®¡ä¸å¤‡ä»½"></a><a class="github-badge" target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-FF3030?style=flat&amp;logo=Claris" title="æœ¬ç«™é‡‡ç”¨çŸ¥è¯†å…±äº«ç½²å - éå•†ä¸šæ€§ä½¿ç”¨ - ç›¸åŒæ–¹å¼å…±äº« 4.0 å›½é™…è®¸å¯åè®®è¿›è¡Œè®¸å¯"></a><a class="github-badge" target="_blank" href="https://icp.gov.moe/?keyword=20240052" style="margin-inline:5px"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/%E8%90%8CICP%E5%A4%87-20240052%E5%8F%B7-fe1384?style-flat&amp;logo=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAABS2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDIgNzkuMTYwOTI0LCAyMDE3LzA3LzEzLTAxOjA2OjM5ICAgICAgICAiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIi8+CiA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgo8P3hwYWNrZXQgZW5kPSJyIj8+nhxg7wAAByxJREFUSInl1nlwVeUZx/HPuTckkD0kQFiCEEIUlNUCAqKoSBV1AIt1ikpVLFbLONjWGUXbmWrbweJMy7hUxbbTjsUq6KCiWEvr0kE2WVK2QCKBJCxJgEASsienfxwqMob+3Zm+f93z3vM+32f5vc9z+H9bwVcfOp/YQ+1prhhEZS1VDQzqQ1MjiQmIC5Liwm3lBWpqFimrulb/7A/067vM2IsOBZ2h8MhJQW6KMDNVsKeaizKEyUlsKueqgWJ39AMJF3QpDCNYr1SaEig/lWNX2Z1h6dH5/lVyGdVIZFf7MHo9bEfh9rCg/+8NyHlN77QTsnpQ0i2y08VK+BosfhbW0cHxqmSfFd9qW+l9Pi+5WltFdGTsOBbO5dJcdh3lN5+xff0Y2zuelXjRsyYUrjOu4BVJaavlpbWIJRBLOM+J81O95AAnTtM9vNHGknut3zdT48FutJE3koWTuG4oSXH+VsInX3B9IdcVUNfCuv08t4GjO6NspOa3BNcOXx1eOugVHQnrTMkTuyWrC/BjRZO9uPYTpw7HhTWkXcLd45l9GblpHD7NWzt5ZTMXZ/OdkTy+lvR07rmcmWffq6pn9W5e/oymfcT6kJbXHiydMyVYkL/x66n+ZMcctQfjhgxl6UIGZ3Ooltd2RIZqjqKRS0ew9cFIA1cO5urlLHuPZWsZPJiZw7gqn0VT2HCIR9+jvCQhfHPrLGyE2Hng2roBxHnmJoZnc9drbD3I6QaaWkjpSVoeu4+x5XB05qMDqCenHz37UHmcFRv54ZuMeoYrB/L0DPRgZ0WfrsXVKzPX3nYykrn3dUZl8+Q0Qox/gc/L6ZlKzxQefo+UROpa6Z4VCedkPd8YyJYHI3u5T/HAShZNQxsXZfR3pCtwRW066VEeOuIUVUf77+9jTw2pycTOJml7Je1t9EgiI5X2jkgyze1fCSSdtjhBiJCkpKyuI+5oTdAtkTCgVwrbKsl8ko6QjO40tZ67EpkpdIbRf20dkbPpPTjdwsSX6I5dJYy4hoQAaZQdDy4A1iEMI613T6LtBPXJpPakrjGqc1Y6CTFq62htJp5KRwPJKWSkU3WKiiPEEqO6xgM6oZmctJhDXYH7Z59xuCyKpK6R26ZE+ys3MWYoN1/Mc5uoqmbEQJ6fTc/ulJ3i/lUc+YIfzeKhKzjVHN31A3XRHddKSrf6/6DOV3VTcw1hVKfkxOhaPDAe1UwfwmNTqT1Drxw+nE9xNXetIjHG2vnoxoT+rNrN2Of58Rp6JZ+ldKes5kjX4G7dKuikpoERfaltYnQ/DOSS3hEAFk9lXQkLnmf7Ib65lPJT3HU1+46Tm8rYvgzKYVA2h+vQIMjvewHwdSN20MiOSmZczO4a1hSzYi77T7CiiPF5JMTZexjJ5OagkwNV9M+MnJ09nKU3smgyQ3PYWoEO4fUjii4QceJmevJuMeP6csUAln4atcbSGoqOUpjD30uZNwnpHNtN3lC+NZa1xeT34pGVTJ3PL9+Ohs6GQ8gVtHZs6VLVwZhBReGwoXvt3THM/hP0SWVnCR8f4PMjkffjB/DQS8waxpHFfFgaaeHZDRRtJn0yP5tF31ymFVJ2nN27GD66KBzca2/XEWdkUpD3Fmd4tYj0FMS54Q9UnuaDUv6yE/24ewWP/DU6N/d1fvousYEs28DyLVEvGDOAt/egmSkXv2VYn3NBfpXbua6J8hMFFvy2RHsL+57gmX+w/AN651PfEDWQzLRI+afqIqOxFDJT6Rbn9Bmad3PnTH5wIxOXkJTWGiz57hCDsyqDWVldRNzeyOh+paaPfpFKnvqQX88iZwDVx0lLJqUHbe3EkZ1Odm+yUqK2GHYKmhvIG8fyeTz9IY5x67jnFPapdPDkl6jzwEF9IDjZJlgwfbG+o2u8+g4rd7D/UYI41TXnevV5K4j2q6uESckUP8rvNrH6fUH/sRXB9AlPONMSDZ8uazwoi56JjEyvdftV88jinhf4uIzmJRQOoOYgja0RKAiIBZxpjvZH5tP0c97axcLlyBXOuWZemJTYFFbUCU+1dl3j8PGSyFhnJ7EkYcWh7/njqpep5xfzWTyZZ7dEg73xOJKiGqf3YenNLBjLTz7i539COg/OvSOYO2GFo/VRG0Zwe0YX4Ns3R7NXSCxBeM8IthXfZvGf3xCWc/kkXvg2vVP4YB/rDzC1gGlDo+50/xvs2khKPrNnzAzmTH5HbzR0fkkKro93Ab5vx9kfaGgT3lLA5EyWbRpoTdHbSreOppGJV/PwlRTksK+aZz5l6z+RLBgxaau5k2cJelTKzmRQMq0d51J8UxL+23d1TDTcj7WQllZu4YwxDo+eZc22X9mwd6gN65GIFmQzampxcMOoR1xeuMbpVoqromsXdG3+wmCiekNtfSSmiUNWu2zgap+WjlZW8X11TeNkpWwICvNfCm8u3Cmxg4PN0VdmEJw7/7+0/g32RaqCbhRecAAAAABJRU5ErkJggg==" title="æœ¬ç«™å·²é€šè¿‡èŒå¤‡å¤‡æ¡ˆï¼šèŒICPå¤‡20240052å·"></a></p></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="go-down" type="button" title="åˆ·æ–°é¡µé¢" onclick="window.location.reload()"><i class="fa-solid fa-arrows-rotate"></i></button><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fa-solid fa-book-open-reader"></i></button><button id="translateLink" type="button" title="ç¹ç®€åˆ‡æ¢">ç¹</button><button id="darkmode" type="button" title="æ˜¼å¤œåˆ‡æ¢"><i class="fa-solid fa-moon"></i></button><button id="hide-aside-btn" type="button" title="å…¨å±æ¨¡å¼" onclick="rmf.fullScreen()"><i class="fas fa-expand"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="ç›´è¾¾è¯„è®º"><i class="fa fa-comments"></i></a><button id="go-down" type="button" title="åˆ†äº«æœ¬é¡µ" onclick="rmf.copyWordsLink()"><i class="fa-solid fa-share-from-square"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button><button id="go-down" type="button" title="ç›´è¾¾åº•éƒ¨" onclick="btf.scrollToDest(document.body.scrollHeight,500)"><i class="fas fa-arrow-down"></i></button></div></div><div class="js-pjax" id="rightMenu"><div class="rightMenu-group rightMenu-small"><a class="rightMenu-item" title="åé€€ä¸€æ­¥" href="javascript:window.history.back();"><i class="fa fa-arrow-left"></i></a><a class="rightMenu-item" title="å‰è¿›ä¸€æ­¥" href="javascript:window.history.forward();"><i class="fa fa-arrow-right"></i></a><a class="rightMenu-item" title="åˆ·æ–°é¡µé¢" href="javascript:window.location.reload();"><i class="fa fa-refresh"></i></a><a class="rightMenu-item" title="ç›´è¾¾é¡¶éƒ¨" href="javascript:btf.scrollToDest(0, 500)"><i class="fa fa-arrow-up"></i></a><a class="rightMenu-item" title="ç›´è¾¾åº•éƒ¨" href="javascript:btf.scrollToDest(document.body.scrollHeight, 500)"><i class="fas fa-arrow-down"></i></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" href="/archives/"><i class="fa-solid fa-calendar-days"></i><span>æ–‡ç« å½’æ¡£</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="fas fa-tags"></i><span>æ–‡ç« æ ‡ç­¾</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="fas fa-folder-open"></i><span>æ–‡ç« åˆ†ç±»</span></a><a class="rightMenu-item" href="javascript:toRandomPost()"><i class="fa fa-paper-plane"></i><span>éšä¾¿é€›é€›</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-text"><a class="rightMenu-item" href="javascript:rmf.copySelect();"><i class="fa fa-copy"></i><span>å¤åˆ¶</span></a><a class="rightMenu-item" href="javascript:window.open(&quot;https://www.bing.com/search?q=&quot;+window.getSelection().toString());window.location.reload();"><i class="fa-brands fa-edge"></i><span>ç”¨Bingæœç´¢</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-too"><a class="rightMenu-item" href="javascript:window.open(window.getSelection().toString());window.location.reload();"><i class="fa fa-link"></i><span>è½¬åˆ°é“¾æ¥</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-paste"><a class="rightMenu-item" href="javascript:rmf.paste()"><i class="fa fa-copy"></i><span>ç²˜è´´</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-post"><a class="rightMenu-item" href="#post-comment"><i class="fa fa-comments"></i><span>ç›´è¾¾è¯„è®º</span></a><a class="rightMenu-item" href="javascript:rmf.copyWordsLink()"><i class="fa fa-link"></i><span>å¤åˆ¶æœ¬æ–‡åœ°å€</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-to"><a class="rightMenu-item" href="javascript:rmf.openWithNewTab()"><i class="fa fa-window-restore"></i><span>æ–°çª—å£æ‰“å¼€</span></a><a class="rightMenu-item" id="menu-too" href="javascript:rmf.open()"><i class="fa fa-link"></i><span>è½¬åˆ°é“¾æ¥</span></a><a class="rightMenu-item" href="javascript:rmf.copyLink()"><i class="fa fa-copy"></i><span>å¤åˆ¶é“¾æ¥</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-img"><a class="rightMenu-item" href="javascript:rmf.saveAs()"><i class="fa fa-download"></i><span>ä¿å­˜å›¾ç‰‡</span></a><a class="rightMenu-item" href="javascript:rmf.openWithNewTab()"><i class="fa fa-window-restore"></i><span>åœ¨æ–°çª—å£æ‰“å¼€</span></a><a class="rightMenu-item" href="javascript:rmf.click()"><i class="fa fa-arrows-alt"></i><span>å…¨å±æ˜¾ç¤º</span></a><a class="rightMenu-item" href="javascript:rmf.copyLink()"><i class="fa fa-copy"></i><span>å¤åˆ¶å›¾ç‰‡é“¾æ¥</span></a></div><div class="rightMenu-group rightMenu-line"><a class="rightMenu-item" href="javascript:rmf.switchDarkMode();"><i class="fa fa-moon"></i><span>æ˜¼å¤œåˆ‡æ¢</span></a><a class="rightMenu-item menu-link" href="/copyright/"><i class="fa-solid fa-copyright"></i><span>æœ¬ç«™åè®®</span></a><a class="rightMenu-item menu-link" href="/about/#reward-me"><i class="fa-sharp fa-solid fa-heart-circle-bolt"></i><span>èµåŠ©æœ¬ç«™</span></a><a class="rightMenu-item menu-link" href="/about/"><i class="fa-regular fa-address-card"></i><span>å…³äºæœ¬ç«™</span></a></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"><script>function loadWaline(){function e(){Waline.init(Object.assign({el:"#waline-wrap",reaction:!0,serverURL:"https://waline.uf4te.cn",avatarCDN:"https://cn.cravatar.com/avatar/",pageview:!0,dark:'html[data-theme="dark"]',path:window.location.pathname,comment:!0,reaction:["https://unpkg.com/@waline/emojis@1.1.0/weibo/weibo_wink.png","https://unpkg.com/@waline/emojis@1.1.0/weibo/weibo_blush.png","https://unpkg.com/@waline/emojis@1.1.0/weibo/weibo_think.png","https://unpkg.com/@waline/emojis@1.1.0/weibo/weibo_awkward.png"]},{locale:{nick:"æ˜µç§° (é€‰å¡«)",mail:"é‚®ç®± (å»ºè®®å¡«å†™)",link:"ä½ çš„ä¸»é¡µ (é€‰å¡«)",placeholder:"è¯·æ–‡æ˜å‘è¨€ï¼Œç‰¢è®°ç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚ï¼ï¼ˆä¸å¡«å†™æ˜µç§°å’Œé‚®ç®±å¯ä»¥åŒ¿åè¯„è®ºï¼Œä½†å»ºè®®å¡«å†™é‚®ç®±å¯åœ¨è¢«å›å¤æ—¶æ”¶åˆ°é‚®ä»¶æé†’ï¼Œé‚®ç®±ä¿¡æ¯ä¸ä¼šè¢«å…¬å¼€ï¼‰",requiredMeta:[],sofa:"æœ‰ä»€ä¹ˆæƒ³è¯´çš„ï¼Ÿå¿«æ¥å‘è¡¨è¯„è®ºæŠ¢æ²™å‘å§ï¼",login:"ç™»å½• (å¯é€‰)",anonymous:"æŸä¸çŸ¥åç½‘å‹",level0:"æ½œæ°´",level1:"å†’æ³¡",level2:"åæ§½",level3:"æ´»è·ƒ",level4:"è¯ç—¨",level5:"ä¼ è¯´",reactionTitle:"æ„Ÿè§‰æ€ä¹ˆæ ·ï¼Œè¯„ä»·ä¸€ä¸‹ï¼Ÿ",reaction0:"æ„Ÿè§‰å¾ˆèµ",reaction1:"æ”¯æŒä¸€ä¸‹",reaction2:"æ„Ÿè§‰ä¸€èˆ¬",reaction3:"å‹‰å‹‰å¼ºå¼º"}}))}const n=document.getElementById("waline-css");"object"==typeof Waline?n?e():getCSS("/css/waline.css","waline-css").then(e):getCSS("/css/waline.css","waline-css").then((()=>{getScript("/js/waline.js").then(e)}))}{function loadOtherComment(){loadWaline()}setTimeout(loadWaline,0)}</script></div><script>window.addEventListener("load",(()=>{const e=e=>{let t="";if(e.length)for(let n=0;n<e.length;n++){t+="<div class='aside-list-item'>";{const a="data-lazy-src";t+=`<a href='${e[n].url}' class='thumbnail'><img ${a}='${e[n].avatar}' alt='${e[n].nick}'></a>`}t+=`<div class='content'>\n        <a class='comment' href='${e[n].url}' title='${e[n].content}'>${e[n].content}</a>\n        <div class='name'><span>${e[n].nick} / </span><time datetime="${e[n].date}">${btf.diffDate(e[n].date,!0)}</time></div>\n        </div></div>`}else t+="æ²¡æœ‰è¯„è®º";let n=document.querySelector("#card-newest-comments .aside-list");n.innerHTML=t,window.lazyLoadInstance&&window.lazyLoadInstance.update(),window.pjax&&window.pjax.refresh(n)},t=()=>{if(document.querySelector("#card-newest-comments .aside-list")){const t=saveToLocal.get("waline-newest-comments");t?e(JSON.parse(t)):(()=>{const t=()=>{Waline.RecentComments({serverURL:"https://waline.uf4te.cn",count:13}).then((({comments:t})=>{let n=t.filter((e=>"uf4te"!==e.nick));n.length<3&&(n=n.concat(t.filter((e=>"uf4te"===e.nick)).slice(0,3-n.length)));const a=n.slice(0,3).map((e=>{return{content:(t=e.comment,""===t||(t=(t=(t=(t=t.replace(/<img.*?src="(.*?)"?[^\>]+>/gi,"[å›¾ç‰‡]")).replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi,"[é“¾æ¥]")).replace(/<pre><code>.*?<\/pre>/gi,"[ä»£ç ]")).replace(/<[^>]+>/g,"")).length>150&&(t=t.substring(0,150)+"..."),t),avatar:e.avatar,nick:e.nick,url:e.url+"#"+e.objectId,date:e.insertedAt};var t}));saveToLocal.set("waline-newest-comments",JSON.stringify(a),10/1440),e(a)})).catch((e=>{document.querySelector("#card-newest-comments .aside-list").innerHTML="æ— æ³•è·å–è¯„è®ºï¼Œè¯·ç¡®è®¤ç›¸å…³é…ç½®æ˜¯å¦æ­£ç¡®"}))};"object"==typeof Waline?t():getScript("/js/waline.js").then(t)})()}};t(),document.addEventListener("pjax:complete",t)}))</script><script src="/js/jquery.min.js"></script><script src="/js/sakura.js"></script><script data-pjax="" src="/js/footer_beautification.js"></script><canvas id="universe"></canvas><script src="/js/universe.js"></script><script src="/js/title.js"></script><script async data-pjax="" src="/js/fps.js"></script><script async data-pjax="" src="/js/txmap.js"></script><script src="/js/console.js"></script><script src="/js/hotsearch.js"></script><div class="aplayer no-destroy" data-id="8252365535" data-server="netease" data-type="playlist" data-order="random" data-fixed="true" data-autoplay="false" data-theme="#00C4B6" data-volume="0.8" data-mutex="true" data-listmaxheight="330px"></div><script src="//npm.elemecdn.com/pace-js@1.2.4/pace.min.js"></script><script async data-pjax="" src="/js/timing.js"></script><script data-pjax="" src="/js/rightmenu.js"></script><script src="/js/random.js"></script><script src="https://cdn.jsdelivr.net/npm/js-heo@1.0.11/poem/jinrishici.js"></script><script data-pjax="" src="/js/poem.js"></script><script src="/js/chuckle-post-ai.js"></script><script data-pjax="" defer>new ChucklePostAI({el:"#post>#article-container",key:"e3524467cea76d785e9a",title_el:".post-title",interface:{name:"uf4te çš„ AI å°åŠ©æ‰‹",introduce:"Heyï¼Œä½ å¥½ï¼å¾ˆé«˜å…´è§åˆ°ä½ ï¼æˆ‘æ˜¯ uf4te çš„æ–‡ç« è¾…åŠ© AIï¼Œç‚¹å‡»ä¸‹æ–¹çš„æŒ‰é’®ï¼Œæˆ‘å¯ä»¥ä¸ºä½ ç”Ÿæˆæœ¬æ–‡æ‘˜è¦ã€æ¨èç›¸å…³æ–‡ç« ï¼ˆé¦–æ¬¡ç”Ÿæˆå¯èƒ½ä¼šæ¯”è¾ƒæ…¢ï¼Œè¯·æ‚¨è€å¿ƒç­‰å¾…ä¸€å°ä¼šï¼Œè°¢è°¢ç†è§£å“¦~ï¼‰",version:"GPT-3.5",button:["ä»‹ç»è‡ªå·±","æ¨èç›¸å…³æ–‡ç« ","ç”Ÿæˆæœ¬æ–‡æ‘˜è¦","çŸ©é˜µç©¿æ¢­"]},hide_shuttle:!0,pjax:!0,summary_toggle:!1,summary_speech:!0})</script><script data-pjax="" src="/js/random-friends-post.js"></script><script data-pjax="" src="/js/pagination.js"></script><script async data-pjax="" src="/js/commentsum.js"></script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-show-text.min.js" data-mobile="false" data-text="â™¡å¯Œå¼ºâ™¡,â™¡æ°‘ä¸»â™¡,â™¡æ–‡æ˜â™¡,â™¡å’Œè°â™¡,â™¡è‡ªç”±â™¡,â™¡å¹³ç­‰â™¡,â™¡å…¬æ­£â™¡,â™¡æ³•æ²»â™¡,â™¡çˆ±å›½â™¡,â™¡æ•¬ä¸šâ™¡,â™¡è¯šä¿¡â™¡,â™¡å‹å–„â™¡" data-fontsize="16px" data-random="false" async></script><link rel="stylesheet" href="/js/APlayer/APlayer.min.css" media="print" onload='this.media="all"'><script src="/js/APlayer/APlayer.min.js"></script><script src="/js/APlayer/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors=["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"];var pjax=new Pjax({elements:'a:not([target="_blank"])',selectors:pjaxSelectors,cacheBust:!1,analytics:!1,scrollRestoration:!1});document.addEventListener("pjax:send",(function(){if(window.tocScrollFn&&window.removeEventListener("scroll",window.tocScrollFn),window.scrollCollect&&window.removeEventListener("scroll",scrollCollect),document.getElementById("rightside").style.cssText="opacity: ''; transform: ''",window.aplayers)for(let e=0;e<window.aplayers.length;e++)window.aplayers[e].options.fixed||window.aplayers[e].destroy();"object"==typeof typed&&typed.destroy();const e=document.body.classList;e.contains("read-mode")&&e.remove("read-mode"),"object"==typeof disqusjs&&disqusjs.destroy()})),document.addEventListener("pjax:complete",(function(){window.refreshFn(),document.querySelectorAll("script[data-pjax], .pjax-reload script").forEach((e=>{const t=document.createElement("script"),o=e.text||e.textContent||e.innerHTML||"";Array.from(e.attributes).forEach((e=>t.setAttribute(e.name,e.value))),t.appendChild(document.createTextNode(o)),e.parentNode.replaceChild(t,e)})),GLOBAL_CONFIG.islazyload&&window.lazyLoadInstance.update(),"function"==typeof chatBtnFn&&chatBtnFn(),"function"==typeof panguInit&&panguInit(),"function"==typeof gtag&&gtag("config","",{page_path:window.location.pathname}),"object"==typeof _hmt&&_hmt.push(["_trackPageview",window.location.pathname]),"function"==typeof loadMeting&&document.getElementsByClassName("aplayer").length&&loadMeting(),"object"==typeof Prism&&Prism.highlightAll()})),document.addEventListener("pjax:error",(e=>{404===e.request.status&&pjax.loadUrl("/404.html")}))</script><div class="pjax-reload"><script async>for(var arr=document.getElementsByClassName("recent-post-item"),i=0;i<arr.length;i++)arr[i].classList.add("wow"),arr[i].classList.add("animate__fadeInLeft"),arr[i].setAttribute("data-wow-duration","600ms"),arr[i].setAttribute("data-wow-delay","200ms"),arr[i].setAttribute("data-wow-offset","100"),arr[i].setAttribute("data-wow-iteration","1")</script><script async>for(var arr=document.getElementsByClassName("card-widget"),i=0;i<arr.length;i++)arr[i].classList.add("wow"),arr[i].classList.add("animate__fadeInRightBig"),arr[i].setAttribute("data-wow-duration",""),arr[i].setAttribute("data-wow-delay",""),arr[i].setAttribute("data-wow-offset",""),arr[i].setAttribute("data-wow-iteration","")</script></div><script defer src="https://cdn.jsdelivr.net/gh/graingert/wow@1.3.0/dist/wow.min.js"></script><script defer src="/js/wow_init.js"></script></div><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœç´¢</span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-info"><div class="algolia-stats"></div><div class="algolia-poweredBy"></div></div></div></div></div><div id="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/algoliasearch/dist/algoliasearch-lite.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instantsearch.js/dist/instantsearch.production.min.js"></script><script src="/js/search/algolia.js"></script></div><div class="js-pjax"><script async>for(var arr=document.getElementsByClassName("recent-post-item"),i=0;i<arr.length;i++)arr[i].classList.add("wow"),arr[i].classList.add("animate__fadeInLeft"),arr[i].setAttribute("data-wow-duration","600ms"),arr[i].setAttribute("data-wow-delay","200ms"),arr[i].setAttribute("data-wow-offset","100"),arr[i].setAttribute("data-wow-iteration","1")</script><script async>for(var arr=document.getElementsByClassName("card-widget"),i=0;i<arr.length;i++)arr[i].classList.add("wow"),arr[i].classList.add("animate__fadeInRightBig"),arr[i].setAttribute("data-wow-duration",""),arr[i].setAttribute("data-wow-delay",""),arr[i].setAttribute("data-wow-offset",""),arr[i].setAttribute("data-wow-iteration","")</script></div><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow.min.js"></script><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow_init.js"></script></body></html><script>var flinks=["https://hexo.io/zh-cn/","https://nodejs.org/en/","https://butterfly.js.org/","https://cnhuazhu.top/","https://www.fomal.cc/","https://guole.fun/","https://akilar.top/","https://zykj.js.org/","https://blog.eurkon.com/","https://fe32.top/","https://blog.anheyu.com/","https://meuicat.com/","https://blog.zhheo.com/","https://blog.justlovesmile.top/","https://uuanqin.top/","https://blog.leonus.cn/","https://aeneag.xyz/","https://www.52pojie.cn/","https://www.kanxue.com/","https://www.anquanke.com/","https://www.freebuf.com/","https://blog.xmcve.com/","https://ctf-wiki.org/","https://bestwing.me/","https://houjingyi233.com/","https://paper.seebug.org/","https://security.tencent.com/index.php/blog/","https://xlab.tencent.com/cn/","https://www.ctfiot.com/blog/","https://www.iotsec-zone.com/article/original","https://www.yuque.com/cyberangel/rg9gdm/","https://www.yuque.com/u239977/","https://www.yuque.com/hxfqg9/","https://blog.aabyss.cn/","https://wiki.wgpsec.org/","https://www.cnblogs.com/trunk","https://lazzzaro.github.io/","https://zikh26.github.io/","https://bbs.kanxue.com/homepage-949925.htm","https://www.henry-blog.life/henry-blog","https://www.yuque.com/cyber1c3","https://blog.imzjw.cn/","https://zfe.space/","https://blog.hclonely.com/","https://whb1990.github.io/","https://nickxu.me/","https://benpaodewoniu.github.io/","https://www.antmoe.com/","https://immmmm.com/","https://blog.night1918.top"];function toRandomFlink(){window.open(flinks[Math.floor(Math.random()*flinks.length)])}</script>